<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.9.5"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>QuEST: QuEST_cpu.c File Reference</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="style.css" rel="stylesheet" type="text/css"/>
        <link href='https://fonts.googleapis.com/css?family=Roboto+Slab' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
        <link href="jquery.smartmenus.bootstrap.css" rel="stylesheet">
        <script type="text/javascript" src="jquery.smartmenus.js"></script>
        <!-- SmartMenus jQuery Bootstrap Addon -->
        <script type="text/javascript" src="jquery.smartmenus.bootstrap.js"></script>
        <!-- SmartMenus jQuery plugin -->
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand"><img alt="Logo" src="logo.png"/></a>
                    <a class="navbar-brand"><b>QuEST</b> v3.6.0<br>The Quantum Exact Simulation Toolkit</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel " style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_aa394cd1d9abb8ffe941d9aaafca8d03.html">github</a></li><li class="navelem"><a class="el" href="dir_c52569aa89a7adbb6029022c2fa60a11.html">workspace</a></li><li class="navelem"><a class="el" href="dir_f749783e1c58df01b4d72faae5c4f8c4.html">QuEST</a></li><li class="navelem"><a class="el" href="dir_3baa71a4a3d86d3a2e26de42cf79b001.html">src</a></li><li class="navelem"><a class="el" href="dir_884568e0aba79348b0abb958f633c6e4.html">CPU</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">QuEST_cpu.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>The core of the CPU backend functionality.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="QuEST_8h_source.html">QuEST.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__internal_8h_source.html">QuEST_internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__precision_8h_source.html">QuEST_precision.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__validation_8h_source.html">QuEST_validation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="mt19937ar_8h_source.html">mt19937ar.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="QuEST__cpu__internal_8h_source.html">QuEST_cpu_internal.h</a>&quot;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
</div>
<p><a href="QuEST__cpu_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0b84e6766bd682708e6211276ff0a5bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0b84e6766bd682708e6211276ff0a5bb">agnostic_createDiagonalOp</a> (int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a0b84e6766bd682708e6211276ff0a5bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af798bb01f922804016c4c5bc8d0a580f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af798bb01f922804016c4c5bc8d0a580f">agnostic_destroyDiagonalOp</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="separator:af798bb01f922804016c4c5bc8d0a580f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81a87bb0f0805c9dfcb691f6cb15a1b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a81a87bb0f0805c9dfcb691f6cb15a1b5">agnostic_initDiagonalOpFromPauliHamil</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op, <a class="el" href="structPauliHamil.html">PauliHamil</a> hamil)</td></tr>
<tr class="separator:a81a87bb0f0805c9dfcb691f6cb15a1b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58d6d599c7a729255b1f8eeded663f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab58d6d599c7a729255b1f8eeded663f3">agnostic_setDiagonalOpElems</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op, long long int startInd, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *real, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imag, long long int numElems)</td></tr>
<tr class="separator:ab58d6d599c7a729255b1f8eeded663f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e8f917ab42d38d8c37ba6816b24f2f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1e8f917ab42d38d8c37ba6816b24f2f5">agnostic_syncDiagonalOp</a> (<a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="separator:a1e8f917ab42d38d8c37ba6816b24f2f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0abdff5f6065f9d57065345e6d90fc94"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)</td></tr>
<tr class="separator:a0abdff5f6065f9d57065345e6d90fc94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga924ef2dbda6b733b4041270077c76ece"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__debug.html#ga924ef2dbda6b733b4041270077c76ece">copyStateFromGPU</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:ga924ef2dbda6b733b4041270077c76ece"><td class="mdescLeft">&#160;</td><td class="mdescRight">In GPU mode, this copies the state-vector (or density matrix) from GPU memory (qureg.deviceStateVec) to RAM (qureg.stateVec), where it can be accessed/modified by the user.  <a href="group__debug.html#ga924ef2dbda6b733b4041270077c76ece">More...</a><br /></td></tr>
<tr class="separator:ga924ef2dbda6b733b4041270077c76ece"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11448560006dd165128e404b54ebb2f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__debug.html#ga11448560006dd165128e404b54ebb2f7">copyStateToGPU</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:ga11448560006dd165128e404b54ebb2f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">In GPU mode, this copies the state-vector (or density matrix) from RAM (qureg.stateVec) to VRAM / GPU-memory (qureg.deviceStateVec), which is the version operated upon by other calls to the API.  <a href="group__debug.html#ga11448560006dd165128e404b54ebb2f7">More...</a><br /></td></tr>
<tr class="separator:ga11448560006dd165128e404b54ebb2f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa58cf7cb98a25ab33621120c5c330d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afa58cf7cb98a25ab33621120c5c330d0">densmatr_applyDiagonalOpLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="separator:afa58cf7cb98a25ab33621120c5c330d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4453a2e609e5359d2995bccf6663ca"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aeb4453a2e609e5359d2995bccf6663ca">densmatr_calcExpecDiagonalOpLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="separator:aeb4453a2e609e5359d2995bccf6663ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7772f97cb4d92a9825bf3b7c82c3230c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c">densmatr_calcFidelityLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQureg.html">Qureg</a> pureState)</td></tr>
<tr class="memdesc:a7772f97cb4d92a9825bf3b7c82c3230c"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes a few dens-columns-worth of (vec^*T) dens * vec  <a href="QuEST__cpu_8c.html#a7772f97cb4d92a9825bf3b7c82c3230c">More...</a><br /></td></tr>
<tr class="separator:a7772f97cb4d92a9825bf3b7c82c3230c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a939897137596bb73ad7a028d0beaaa10"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a939897137596bb73ad7a028d0beaaa10">densmatr_calcHilbertSchmidtDistanceSquaredLocal</a> (<a class="el" href="structQureg.html">Qureg</a> a, <a class="el" href="structQureg.html">Qureg</a> b)</td></tr>
<tr class="memdesc:a939897137596bb73ad7a028d0beaaa10"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes Tr((a-b) conjTrans(a-b)) = sum of abs values of (a-b)  <a href="QuEST__cpu_8c.html#a939897137596bb73ad7a028d0beaaa10">More...</a><br /></td></tr>
<tr class="separator:a939897137596bb73ad7a028d0beaaa10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08392b1b27d10e3b8a8648a5afeaa629"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a08392b1b27d10e3b8a8648a5afeaa629">densmatr_calcInnerProductLocal</a> (<a class="el" href="structQureg.html">Qureg</a> a, <a class="el" href="structQureg.html">Qureg</a> b)</td></tr>
<tr class="memdesc:a08392b1b27d10e3b8a8648a5afeaa629"><td class="mdescLeft">&#160;</td><td class="mdescRight">computes Tr(conjTrans(a) b) = sum of (a_ij^* b_ij)  <a href="QuEST__cpu_8c.html#a08392b1b27d10e3b8a8648a5afeaa629">More...</a><br /></td></tr>
<tr class="separator:a08392b1b27d10e3b8a8648a5afeaa629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73a6c5647862b882f4ed7d83ec3c3e1f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a73a6c5647862b882f4ed7d83ec3c3e1f">densmatr_calcProbOfAllOutcomesLocal</a> (<a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *outcomeProbs, <a class="el" href="structQureg.html">Qureg</a> qureg, int *qubits, int numQubits)</td></tr>
<tr class="separator:a73a6c5647862b882f4ed7d83ec3c3e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af910c7cf2b85bdc2c399cfe8dbfb8b9c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af910c7cf2b85bdc2c399cfe8dbfb8b9c">densmatr_calcPurityLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:af910c7cf2b85bdc2c399cfe8dbfb8b9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a639c31701d989a5db7aa1f6b13db60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8a639c31701d989a5db7aa1f6b13db60">densmatr_collapseToKnownProbOutcome</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, int outcome, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> totalStateProb)</td></tr>
<tr class="memdesc:a8a639c31701d989a5db7aa1f6b13db60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero.  <a href="QuEST__cpu_8c.html#a8a639c31701d989a5db7aa1f6b13db60">More...</a><br /></td></tr>
<tr class="separator:a8a639c31701d989a5db7aa1f6b13db60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bea931504c90d9bd97e74645667804e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8bea931504c90d9bd97e74645667804e">densmatr_findProbabilityOfZeroLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit)</td></tr>
<tr class="separator:a8bea931504c90d9bd97e74645667804e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20a155f53efc45c16803d7539c2c199d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a20a155f53efc45c16803d7539c2c199d">densmatr_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr class="separator:a20a155f53efc45c16803d7539c2c199d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b2ac0b00afa495f385520b2c5fa839"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad5b2ac0b00afa495f385520b2c5fa839">densmatr_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:ad5b2ac0b00afa495f385520b2c5fa839"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b36518c8fbbc3a5084bb4ad1fb05ea5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1b36518c8fbbc3a5084bb4ad1fb05ea5">densmatr_initPureStateLocal</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr class="separator:a1b36518c8fbbc3a5084bb4ad1fb05ea5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d9c19a3424f0ad89bfbfd920d65301d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8d9c19a3424f0ad89bfbfd920d65301d">densmatr_mixDampingDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> damping)</td></tr>
<tr class="separator:a8d9c19a3424f0ad89bfbfd920d65301d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab124a3a9956046bf9c0e1e3ae9171f42"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab124a3a9956046bf9c0e1e3ae9171f42">densmatr_mixDampingLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> damping)</td></tr>
<tr class="separator:ab124a3a9956046bf9c0e1e3ae9171f42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8adaba9dbdad6f7ab41ae4b8db0abefe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8adaba9dbdad6f7ab41ae4b8db0abefe">densmatr_mixDensityMatrix</a> (<a class="el" href="structQureg.html">Qureg</a> combineQureg, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> otherProb, <a class="el" href="structQureg.html">Qureg</a> otherQureg)</td></tr>
<tr class="separator:a8adaba9dbdad6f7ab41ae4b8db0abefe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31f0ef43a921c3ac73545d1d3670fa1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa31f0ef43a921c3ac73545d1d3670fa1">densmatr_mixDephasing</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:aa31f0ef43a921c3ac73545d1d3670fa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88670d0e7cebe33f61c1dd98daa338b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a88670d0e7cebe33f61c1dd98daa338b3">densmatr_mixDepolarisingDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> depolLevel)</td></tr>
<tr class="separator:a88670d0e7cebe33f61c1dd98daa338b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab750fb47da2fca9849c678c869e40e69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab750fb47da2fca9849c678c869e40e69">densmatr_mixDepolarisingLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> depolLevel)</td></tr>
<tr class="separator:ab750fb47da2fca9849c678c869e40e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a623e577b7230f3c8dc202be6185b4289"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a623e577b7230f3c8dc202be6185b4289">densmatr_mixTwoQubitDephasing</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase)</td></tr>
<tr class="separator:a623e577b7230f3c8dc202be6185b4289"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f76ec8f08e19bb8e1254aafb10e160e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2f76ec8f08e19bb8e1254aafb10e160e">densmatr_mixTwoQubitDepolarisingDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, int qubit2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma)</td></tr>
<tr class="separator:a2f76ec8f08e19bb8e1254aafb10e160e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3510f01d4d15dcc545564eb84c668cad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a3510f01d4d15dcc545564eb84c668cad">densmatr_mixTwoQubitDepolarisingLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma)</td></tr>
<tr class="separator:a3510f01d4d15dcc545564eb84c668cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae90f82418e0aa67218d733dbbc681998"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae90f82418e0aa67218d733dbbc681998">densmatr_mixTwoQubitDepolarisingLocalPart1</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qubit1, int qubit2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta)</td></tr>
<tr class="separator:ae90f82418e0aa67218d733dbbc681998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acabdfbd3184d3ab3bded61e24142b800"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#acabdfbd3184d3ab3bded61e24142b800">densmatr_mixTwoQubitDepolarisingQ1LocalQ2DistributedPart3</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, int qubit2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> delta, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> gamma)</td></tr>
<tr class="separator:acabdfbd3184d3ab3bded61e24142b800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a717a0448066831cb5b392bcf2e1d0529"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a717a0448066831cb5b392bcf2e1d0529">densmatr_oneQubitDegradeOffDiagonal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain)</td></tr>
<tr class="separator:a717a0448066831cb5b392bcf2e1d0529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada7c52e0f109047f86a26bce86ab679f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ada7c52e0f109047f86a26bce86ab679f">densmatr_setQuregToPauliHamil</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structPauliHamil.html">PauliHamil</a> hamil)</td></tr>
<tr class="separator:ada7c52e0f109047f86a26bce86ab679f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37e522505286f17fe6ef74b9f607a5c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a> (long long int mask)</td></tr>
<tr class="separator:a37e522505286f17fe6ef74b9f607a5c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a031a99b7e97779f3dc782feffe86e779"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> norm, long long int startInd, long long int numAmps)</td></tr>
<tr class="separator:a031a99b7e97779f3dc782feffe86e779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa4231f79fe9498e4fd87cc70cde5a9d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afa4231f79fe9498e4fd87cc70cde5a9d">qsortComp</a> (const void *a, const void *b)</td></tr>
<tr class="separator:afa4231f79fe9498e4fd87cc70cde5a9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27294e3065ebe42a65b3b9e0f85551dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a27294e3065ebe42a65b3b9e0f85551dd">statevec_applyDiagonalOp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="separator:a27294e3065ebe42a65b3b9e0f85551dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab33437d10c1ce1c4b034c7c411db553f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab33437d10c1ce1c4b034c7c411db553f">statevec_applyMultiVarPhaseFuncOverrides</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *qubits, int *numQubitsPerReg, int numRegs, enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a> encoding, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *coeffs, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *exponents, int *numTermsPerReg, long long int *overrideInds, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *overridePhases, int numOverrides, int conj)</td></tr>
<tr class="separator:ab33437d10c1ce1c4b034c7c411db553f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5b7e25e42427dfa7f19fd950264bb16"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad5b7e25e42427dfa7f19fd950264bb16">statevec_applyParamNamedPhaseFuncOverrides</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *qubits, int *numQubitsPerReg, int numRegs, enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a> encoding, enum <a class="el" href="group__type.html#gaa7d869b117ba5024d6b84938e8cdfc65">phaseFunc</a> phaseFuncName, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *params, int numParams, long long int *overrideInds, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *overridePhases, int numOverrides, int conj)</td></tr>
<tr class="separator:ad5b7e25e42427dfa7f19fd950264bb16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d7928473aca695a614e9c24d903e578"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a9d7928473aca695a614e9c24d903e578">statevec_applyPhaseFuncOverrides</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *qubits, int numQubits, enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a> encoding, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *coeffs, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *exponents, int numTerms, long long int *overrideInds, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *overridePhases, int numOverrides, int conj)</td></tr>
<tr class="separator:a9d7928473aca695a614e9c24d903e578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bb94b4fe408f0abec1728ea613af137"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0bb94b4fe408f0abec1728ea613af137">statevec_applySubDiagonalOp</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *targets, <a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a> op, int conj)</td></tr>
<tr class="separator:a0bb94b4fe408f0abec1728ea613af137"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ccb485bcffb328bbd5b2af6977cead"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a16ccb485bcffb328bbd5b2af6977cead">statevec_calcExpecDiagonalOpLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structDiagonalOp.html">DiagonalOp</a> op)</td></tr>
<tr class="separator:a16ccb485bcffb328bbd5b2af6977cead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fbb3b693f25dde1e9e3dc87dc1984f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structComplex.html">Complex</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a6fbb3b693f25dde1e9e3dc87dc1984f7">statevec_calcInnerProductLocal</a> (<a class="el" href="structQureg.html">Qureg</a> bra, <a class="el" href="structQureg.html">Qureg</a> ket)</td></tr>
<tr class="separator:a6fbb3b693f25dde1e9e3dc87dc1984f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb1e220c272754d0773aeccdb613b6b3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#afb1e220c272754d0773aeccdb613b6b3">statevec_calcProbOfAllOutcomesLocal</a> (<a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *outcomeProbs, <a class="el" href="structQureg.html">Qureg</a> qureg, int *qubits, int numQubits)</td></tr>
<tr class="separator:afb1e220c272754d0773aeccdb613b6b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b77089145184d990848cd66993aa8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa4b77089145184d990848cd66993aa8b">statevec_cloneQureg</a> (<a class="el" href="structQureg.html">Qureg</a> targetQureg, <a class="el" href="structQureg.html">Qureg</a> copyQureg)</td></tr>
<tr class="separator:aa4b77089145184d990848cd66993aa8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad09bb76ad67581b03ab176832cca37cf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad09bb76ad67581b03ab176832cca37cf">statevec_collapseToKnownProbOutcomeDistributedRenorm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> totalProbability)</td></tr>
<tr class="memdesc:ad09bb76ad67581b03ab176832cca37cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1.  <a href="QuEST__cpu_8c.html#ad09bb76ad67581b03ab176832cca37cf">More...</a><br /></td></tr>
<tr class="separator:ad09bb76ad67581b03ab176832cca37cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab02bce0ebbb8f624e8ced8b09b99cdef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef">statevec_collapseToKnownProbOutcomeLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit, int outcome, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> totalProbability)</td></tr>
<tr class="memdesc:ab02bce0ebbb8f624e8ced8b09b99cdef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1.  <a href="QuEST__cpu_8c.html#ab02bce0ebbb8f624e8ced8b09b99cdef">More...</a><br /></td></tr>
<tr class="separator:ab02bce0ebbb8f624e8ced8b09b99cdef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea68e9132ed9db9c242353a33dba2f0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a7ea68e9132ed9db9c242353a33dba2f0">statevec_collapseToOutcomeDistributedSetZero</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a7ea68e9132ed9db9c242353a33dba2f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a7a35628b1c1eb47336deb9afda5b68"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0a7a35628b1c1eb47336deb9afda5b68">statevec_compactUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a0a7a35628b1c1eb47336deb9afda5b68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately.  <a href="QuEST__cpu_8c.html#a0a7a35628b1c1eb47336deb9afda5b68">More...</a><br /></td></tr>
<tr class="separator:a0a7a35628b1c1eb47336deb9afda5b68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ddfdb22e4704b680d67d08d9e80835b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a5ddfdb22e4704b680d67d08d9e80835b">statevec_compactUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:a5ddfdb22e4704b680d67d08d9e80835b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cecbad32a03416138b321cdc1a2c33"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae6cecbad32a03416138b321cdc1a2c33">statevec_compareStates</a> (<a class="el" href="structQureg.html">Qureg</a> mq1, <a class="el" href="structQureg.html">Qureg</a> mq2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> precision)</td></tr>
<tr class="separator:ae6cecbad32a03416138b321cdc1a2c33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a071baf8b6951d2a7d6529394b6f39364"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a071baf8b6951d2a7d6529394b6f39364">statevec_controlledCompactUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a071baf8b6951d2a7d6529394b6f39364"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="QuEST__cpu_8c.html#a071baf8b6951d2a7d6529394b6f39364">More...</a><br /></td></tr>
<tr class="separator:a071baf8b6951d2a7d6529394b6f39364"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215e2d6f88dbecc0b408b3573b5e144f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a215e2d6f88dbecc0b408b3573b5e144f">statevec_controlledCompactUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, int targetQubit, <a class="el" href="structComplex.html">Complex</a> alpha, <a class="el" href="structComplex.html">Complex</a> beta)</td></tr>
<tr class="separator:a215e2d6f88dbecc0b408b3573b5e144f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a393da4c4bc582a757ca8406d8501aca0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a393da4c4bc582a757ca8406d8501aca0">statevec_controlledNotDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a393da4c4bc582a757ca8406d8501aca0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="QuEST__cpu_8c.html#a393da4c4bc582a757ca8406d8501aca0">More...</a><br /></td></tr>
<tr class="separator:a393da4c4bc582a757ca8406d8501aca0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace1482ef82b83e7f926634a67b322fc4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ace1482ef82b83e7f926634a67b322fc4">statevec_controlledNotLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, int targetQubit)</td></tr>
<tr class="separator:ace1482ef82b83e7f926634a67b322fc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790add229738945812ae2048c03d58ec"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a790add229738945812ae2048c03d58ec">statevec_controlledPauliYDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, ComplexArray stateVecIn, ComplexArray stateVecOut, int conjFac)</td></tr>
<tr class="separator:a790add229738945812ae2048c03d58ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06fb16aa4af7c54d36052a14d3ad58a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a06fb16aa4af7c54d36052a14d3ad58a7">statevec_controlledPauliYLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, int targetQubit, int conjFac)</td></tr>
<tr class="separator:a06fb16aa4af7c54d36052a14d3ad58a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf78491e35d165edfd57387f9fffecbd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aaf78491e35d165edfd57387f9fffecbd">statevec_controlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int idQubit1, int idQubit2)</td></tr>
<tr class="separator:aaf78491e35d165edfd57387f9fffecbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63df1ec14ff7cc81c3f392ac10fcc744"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a63df1ec14ff7cc81c3f392ac10fcc744">statevec_controlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int idQubit1, int idQubit2, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a63df1ec14ff7cc81c3f392ac10fcc744"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57368529b2a7e76fec423cbfe9980b22"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a57368529b2a7e76fec423cbfe9980b22">statevec_controlledUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a57368529b2a7e76fec423cbfe9980b22"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately.  <a href="QuEST__cpu_8c.html#a57368529b2a7e76fec423cbfe9980b22">More...</a><br /></td></tr>
<tr class="separator:a57368529b2a7e76fec423cbfe9980b22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a903beb4f5d8753a964ce2dc5f9096a24"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a903beb4f5d8753a964ce2dc5f9096a24">statevec_controlledUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int controlQubit, int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:a903beb4f5d8753a964ce2dc5f9096a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af92ff38e45213eb32a3c8b9815358032"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af92ff38e45213eb32a3c8b9815358032">statevec_copySubstateFromGPU</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, long long int numAmps)</td></tr>
<tr class="separator:af92ff38e45213eb32a3c8b9815358032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b8fe192658d0524ec8f9f9ba0a6e68d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a6b8fe192658d0524ec8f9f9ba0a6e68d">statevec_copySubstateToGPU</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, long long int numAmps)</td></tr>
<tr class="separator:a6b8fe192658d0524ec8f9f9ba0a6e68d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a365bbb1b80cb00405c8bf1a4fa1ea8e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a365bbb1b80cb00405c8bf1a4fa1ea8e5">statevec_createQureg</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int numQubits, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a365bbb1b80cb00405c8bf1a4fa1ea8e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a52ad9f9ad9b2fd6a76f6d433b3b217"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2a52ad9f9ad9b2fd6a76f6d433b3b217">statevec_destroyQureg</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a2a52ad9f9ad9b2fd6a76f6d433b3b217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a430d98e35f1eae7f0815ac539057cf67"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a430d98e35f1eae7f0815ac539057cf67">statevec_findProbabilityOfZeroDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:a430d98e35f1eae7f0815ac539057cf67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk.  <a href="QuEST__cpu_8c.html#a430d98e35f1eae7f0815ac539057cf67">More...</a><br /></td></tr>
<tr class="separator:a430d98e35f1eae7f0815ac539057cf67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8535bc15c2ff249ddddb3fde6eff1490"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8535bc15c2ff249ddddb3fde6eff1490">statevec_findProbabilityOfZeroLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int measureQubit)</td></tr>
<tr class="memdesc:a8535bc15c2ff249ddddb3fde6eff1490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk.  <a href="QuEST__cpu_8c.html#a8535bc15c2ff249ddddb3fde6eff1490">More...</a><br /></td></tr>
<tr class="separator:a8535bc15c2ff249ddddb3fde6eff1490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea6570b95fdfa102511ccd1fcb30685"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#abea6570b95fdfa102511ccd1fcb30685">statevec_hadamardDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut, int updateUpper)</td></tr>
<tr class="memdesc:abea6570b95fdfa102511ccd1fcb30685"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{1,1},{1,-1}}/sqrt2.  <a href="QuEST__cpu_8c.html#abea6570b95fdfa102511ccd1fcb30685">More...</a><br /></td></tr>
<tr class="separator:abea6570b95fdfa102511ccd1fcb30685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86dbcc3db99294add9964741e19fbdab"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a86dbcc3db99294add9964741e19fbdab">statevec_hadamardLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit)</td></tr>
<tr class="separator:a86dbcc3db99294add9964741e19fbdab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a758bad4237ff0bf3b4ff5be626a982ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a758bad4237ff0bf3b4ff5be626a982ae">statevec_initBlankState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a758bad4237ff0bf3b4ff5be626a982ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288dc4b46bdacd69cbf4a6fd070d26a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a288dc4b46bdacd69cbf4a6fd070d26a7">statevec_initClassicalState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int stateInd)</td></tr>
<tr class="separator:a288dc4b46bdacd69cbf4a6fd070d26a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9fd3017ea40cf63fd04b39e03494972"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad9fd3017ea40cf63fd04b39e03494972">statevec_initDebugState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="memdesc:ad9fd3017ea40cf63fd04b39e03494972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value.  <a href="QuEST__cpu_8c.html#ad9fd3017ea40cf63fd04b39e03494972">More...</a><br /></td></tr>
<tr class="separator:ad9fd3017ea40cf63fd04b39e03494972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a482fc361fd5f08075404c72e536316a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a482fc361fd5f08075404c72e536316a0">statevec_initPlusState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a482fc361fd5f08075404c72e536316a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05756b45f10135bb2eeb07380f806c20"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a05756b45f10135bb2eeb07380f806c20">statevec_initStateFromSingleFile</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, char filename[200], <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env)</td></tr>
<tr class="separator:a05756b45f10135bb2eeb07380f806c20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a923906770cac0da9e3459bae58de9e64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a923906770cac0da9e3459bae58de9e64">statevec_initStateOfSingleQubit</a> (<a class="el" href="structQureg.html">Qureg</a> *qureg, int qubitId, int outcome)</td></tr>
<tr class="memdesc:a923906770cac0da9e3459bae58de9e64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one.  <a href="QuEST__cpu_8c.html#a923906770cac0da9e3459bae58de9e64">More...</a><br /></td></tr>
<tr class="separator:a923906770cac0da9e3459bae58de9e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca0c6ba07ab2b4b437321bf17efc966"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a2ca0c6ba07ab2b4b437321bf17efc966">statevec_initZeroState</a> (<a class="el" href="structQureg.html">Qureg</a> qureg)</td></tr>
<tr class="separator:a2ca0c6ba07ab2b4b437321bf17efc966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6f0c9ed9261afbab4712e056a88763d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ae6f0c9ed9261afbab4712e056a88763d">statevec_multiControlledMultiQubitNotDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int ctrlMask, int targMask, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr class="separator:ae6f0c9ed9261afbab4712e056a88763d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7d30ce54573c75b35386cd0e284adc5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac7d30ce54573c75b35386cd0e284adc5">statevec_multiControlledMultiQubitNotLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int ctrlMask, int targMask)</td></tr>
<tr class="separator:ac7d30ce54573c75b35386cd0e284adc5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0aedcccfa50c7aaa8b7fc4c14d7cdfb8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0aedcccfa50c7aaa8b7fc4c14d7cdfb8">statevec_multiControlledMultiQubitUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int ctrlMask, int *targs, int numTargs, <a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a> u)</td></tr>
<tr class="separator:a0aedcccfa50c7aaa8b7fc4c14d7cdfb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ed30f823a59890be17441d97ce90c5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a3ed30f823a59890be17441d97ce90c5c">statevec_multiControlledMultiRotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int ctrlMask, long long int targMask, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a3ed30f823a59890be17441d97ce90c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4ee5979d475e8c729294b8ef7e0270d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac4ee5979d475e8c729294b8ef7e0270d">statevec_multiControlledPhaseFlip</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits)</td></tr>
<tr class="separator:ac4ee5979d475e8c729294b8ef7e0270d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa662796ea6e0f471143c53becae8c12c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa662796ea6e0f471143c53becae8c12c">statevec_multiControlledPhaseShift</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int *controlQubits, int numControlQubits, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:aa662796ea6e0f471143c53becae8c12c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8236a00389137b5eff986a40577eaf3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#af8236a00389137b5eff986a40577eaf3">statevec_multiControlledTwoQubitUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int ctrlMask, int q1, int q2, <a class="el" href="structComplexMatrix4.html">ComplexMatrix4</a> u)</td></tr>
<tr class="separator:af8236a00389137b5eff986a40577eaf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab58fe4be895283c2c4eb86ec9af5682e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab58fe4be895283c2c4eb86ec9af5682e">statevec_multiControlledUnitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, long long int ctrlQubitsMask, long long int ctrlFlipMask, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:ab58fe4be895283c2c4eb86ec9af5682e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately.  <a href="QuEST__cpu_8c.html#ab58fe4be895283c2c4eb86ec9af5682e">More...</a><br /></td></tr>
<tr class="separator:ab58fe4be895283c2c4eb86ec9af5682e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19f28e68330da68ea3caa2bdef32da9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab19f28e68330da68ea3caa2bdef32da9">statevec_multiControlledUnitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, long long int ctrlQubitsMask, long long int ctrlFlipMask, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:ab19f28e68330da68ea3caa2bdef32da9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d88b4ed94ab024e5e7b2f1f4f505b44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a8d88b4ed94ab024e5e7b2f1f4f505b44">statevec_multiRotateZ</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int mask, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> angle)</td></tr>
<tr class="separator:a8d88b4ed94ab024e5e7b2f1f4f505b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a464efbd1d7ca5a7b25c83ada001955c2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a464efbd1d7ca5a7b25c83ada001955c2">statevec_pauliXDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, ComplexArray stateVecIn, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a464efbd1d7ca5a7b25c83ada001955c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by {{0,1},{1,0}.  <a href="QuEST__cpu_8c.html#a464efbd1d7ca5a7b25c83ada001955c2">More...</a><br /></td></tr>
<tr class="separator:a464efbd1d7ca5a7b25c83ada001955c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa987d1e0ba97da2ca540194356dd62de"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa987d1e0ba97da2ca540194356dd62de">statevec_pauliXLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit)</td></tr>
<tr class="separator:aa987d1e0ba97da2ca540194356dd62de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f562af6cb665a8a7a3f80e9449734d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0f562af6cb665a8a7a3f80e9449734d5">statevec_pauliYDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, ComplexArray stateVecIn, ComplexArray stateVecOut, int updateUpper, int conjFac)</td></tr>
<tr class="memdesc:a0f562af6cb665a8a7a3f80e9449734d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate a single qubit by +-{{0,-i},{i,0}.  <a href="QuEST__cpu_8c.html#a0f562af6cb665a8a7a3f80e9449734d5">More...</a><br /></td></tr>
<tr class="separator:a0f562af6cb665a8a7a3f80e9449734d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45b0916c3e121837f214b64f7424e479"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a45b0916c3e121837f214b64f7424e479">statevec_pauliYLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, int conjFac)</td></tr>
<tr class="separator:a45b0916c3e121837f214b64f7424e479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a535cc3c9962d511078691e4d64b4e272"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a535cc3c9962d511078691e4d64b4e272">statevec_phaseShiftByTerm</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="structComplex.html">Complex</a> term)</td></tr>
<tr class="separator:a535cc3c9962d511078691e4d64b4e272"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e57230c7995447039e62a84c0a36524"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a1e57230c7995447039e62a84c0a36524">statevec_reportStateToScreen</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structQuESTEnv.html">QuESTEnv</a> env, int reportRank)</td></tr>
<tr class="separator:a1e57230c7995447039e62a84c0a36524"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa121d55f2ca09c06a96ddcd433c60b0f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aa121d55f2ca09c06a96ddcd433c60b0f">statevec_setAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reals, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imags, long long int numAmps)</td></tr>
<tr class="separator:aa121d55f2ca09c06a96ddcd433c60b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64a23933361fafc1b6b1787759c2663"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ad64a23933361fafc1b6b1787759c2663">statevec_setWeightedQureg</a> (<a class="el" href="structComplex.html">Complex</a> fac1, <a class="el" href="structQureg.html">Qureg</a> qureg1, <a class="el" href="structComplex.html">Complex</a> fac2, <a class="el" href="structQureg.html">Qureg</a> qureg2, <a class="el" href="structComplex.html">Complex</a> facOut, <a class="el" href="structQureg.html">Qureg</a> out)</td></tr>
<tr class="separator:ad64a23933361fafc1b6b1787759c2663"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe74a5a9db8340e37b80fbc77338894d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#abe74a5a9db8340e37b80fbc77338894d">statevec_swapQubitAmpsDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int pairRank, int qb1, int qb2)</td></tr>
<tr class="memdesc:abe74a5a9db8340e37b80fbc77338894d"><td class="mdescLeft">&#160;</td><td class="mdescRight">qureg.pairStateVec contains the entire set of amplitudes of the paired node which includes the set of all amplitudes which need to be swapped between |..0..1..&gt; and |..1..0..&gt;  <a href="QuEST__cpu_8c.html#abe74a5a9db8340e37b80fbc77338894d">More...</a><br /></td></tr>
<tr class="separator:abe74a5a9db8340e37b80fbc77338894d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5b51a28caa8792a3f0c637409a694b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ab5b51a28caa8792a3f0c637409a694b0">statevec_swapQubitAmpsLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int qb1, int qb2)</td></tr>
<tr class="memdesc:ab5b51a28caa8792a3f0c637409a694b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">It is ensured that all amplitudes needing to be swapped are on this node.  <a href="QuEST__cpu_8c.html#ab5b51a28caa8792a3f0c637409a694b0">More...</a><br /></td></tr>
<tr class="separator:ab5b51a28caa8792a3f0c637409a694b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce2c2fd54df25495e99dc5b95bed4b2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#a0ce2c2fd54df25495e99dc5b95bed4b2">statevec_unitaryDistributed</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, <a class="el" href="structComplex.html">Complex</a> rot1, <a class="el" href="structComplex.html">Complex</a> rot2, ComplexArray stateVecUp, ComplexArray stateVecLo, ComplexArray stateVecOut)</td></tr>
<tr class="memdesc:a0ce2c2fd54df25495e99dc5b95bed4b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately.  <a href="QuEST__cpu_8c.html#a0ce2c2fd54df25495e99dc5b95bed4b2">More...</a><br /></td></tr>
<tr class="separator:a0ce2c2fd54df25495e99dc5b95bed4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafc398f8f479fcc066a2dea700235635"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#aafc398f8f479fcc066a2dea700235635">statevec_unitaryLocal</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, int targetQubit, <a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a> u)</td></tr>
<tr class="separator:aafc398f8f479fcc066a2dea700235635"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5168399122f7f53977dcc9ceda4f458"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a> (<a class="el" href="structQureg.html">Qureg</a> qureg, long long int startInd, long long int numAmps)</td></tr>
<tr class="separator:ac5168399122f7f53977dcc9ceda4f458"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >The core of the CPU backend functionality. </p>
<p >The CPU/MPI implementations of the pure state functions in ../QuEST_ops_pure.h are in <a class="el" href="QuEST__cpu__local_8c.html" title="An implementation of the pure backend in ../QuEST_ops_pure.h for a local (non-MPI,...">QuEST_cpu_local.c</a> and <a class="el" href="QuEST__cpu__distributed_8c.html" title="An implementation of the backend in ../QuEST_ops.h for an MPI environment.">QuEST_cpu_distributed.c</a> which mostly wrap the core functions defined here. Some additional hardware-agnostic functions are defined here</p>
<dl class="section author"><dt>Author</dt><dd>Ania Brown </dd>
<dd>
Tyson Jones </dd>
<dd>
Balint Koczor </dd></dl>

<p class="definition">Definition in file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0b84e6766bd682708e6211276ff0a5bb" name="a0b84e6766bd682708e6211276ff0a5bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b84e6766bd682708e6211276ff0a5bb">&#9670;&#160;</a></span>agnostic_createDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDiagonalOp.html">DiagonalOp</a> agnostic_createDiagonalOp </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01388">1388</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1388</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1389</span> </div>
<div class="line"><span class="lineno"> 1390</span>    <span class="comment">// the 2^numQubits values will be evenly split between the env.numRanks nodes</span></div>
<div class="line"><span class="lineno"> 1391</span>    <a class="code hl_struct" href="structDiagonalOp.html">DiagonalOp</a> op;</div>
<div class="line"><span class="lineno"> 1392</span>    op.<a class="code hl_variable" href="structDiagonalOp.html#a5131eeb67aafb4c19ac98270c3266742">numQubits</a> = numQubits;</div>
<div class="line"><span class="lineno"> 1393</span>    op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a> = (1LL &lt;&lt; numQubits) / env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div>
<div class="line"><span class="lineno"> 1394</span>    op.<a class="code hl_variable" href="structDiagonalOp.html#aa91713a22c95a383bba55e56c4a4e37a">chunkId</a> = env.<a class="code hl_variable" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;</div>
<div class="line"><span class="lineno"> 1395</span>    op.<a class="code hl_variable" href="structDiagonalOp.html#ada3bffa8e414f883e415dd74e46cd879">numChunks</a> = env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div>
<div class="line"><span class="lineno"> 1396</span> </div>
<div class="line"><span class="lineno"> 1397</span>    <span class="comment">// allocate CPU memory (initialised to zero)</span></div>
<div class="line"><span class="lineno"> 1398</span>    op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a> = (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) calloc(op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>));</div>
<div class="line"><span class="lineno"> 1399</span>    op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a> = (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) calloc(op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>, <span class="keyword">sizeof</span>(<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>));</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>    <span class="comment">// check cpu memory allocation was successful</span></div>
<div class="line"><span class="lineno"> 1402</span>    <a class="code hl_function" href="QuEST__validation_8c.html#aac1bc5116167aea9003da60deccf65e7">validateDiagonalOpAllocation</a>(&amp;op, env, __func__);</div>
<div class="line"><span class="lineno"> 1403</span> </div>
<div class="line"><span class="lineno"> 1404</span>    <span class="keywordflow">return</span> op;</div>
<div class="line"><span class="lineno"> 1405</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_aac1bc5116167aea9003da60deccf65e7"><div class="ttname"><a href="QuEST__validation_8c.html#aac1bc5116167aea9003da60deccf65e7">validateDiagonalOpAllocation</a></div><div class="ttdeci">void validateDiagonalOpAllocation(DiagonalOp *op, QuESTEnv env, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l01090">QuEST_validation.c:1090</a></div></div>
<div class="ttc" id="agroup__type_html_ga7740e349b4f8bae6451547680f0ce2d6"><div class="ttname"><a href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a></div><div class="ttdeci">#define qreal</div><div class="ttdoc">A precision-agnostic floating point number, as determined by QuEST_PREC.</div></div>
<div class="ttc" id="astructDiagonalOp_html"><div class="ttname"><a href="structDiagonalOp.html">DiagonalOp</a></div><div class="ttdoc">Represents a diagonal complex operator on the full Hilbert state of a Qureg.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00299">QuEST.h:300</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a1d66088bed235d524cd452b107694d5c"><div class="ttname"><a href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">DiagonalOp::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdoc">The real values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00310">QuEST.h:310</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a2c6eab631ef48b4978db026c98180eee"><div class="ttname"><a href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">DiagonalOp::numElemsPerChunk</a></div><div class="ttdeci">long long int numElemsPerChunk</div><div class="ttdoc">The number of the 2^numQubits amplitudes stored on each distributed node.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00304">QuEST.h:304</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a5131eeb67aafb4c19ac98270c3266742"><div class="ttname"><a href="structDiagonalOp.html#a5131eeb67aafb4c19ac98270c3266742">DiagonalOp::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">The number of qubits this operator can act on (informing its size)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00302">QuEST.h:302</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_a85c3f52533efe831bbe40b9a48602388"><div class="ttname"><a href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">DiagonalOp::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdoc">The imaginary values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00312">QuEST.h:312</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_aa91713a22c95a383bba55e56c4a4e37a"><div class="ttname"><a href="structDiagonalOp.html#aa91713a22c95a383bba55e56c4a4e37a">DiagonalOp::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the operator held by this process in the full operator.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00308">QuEST.h:308</a></div></div>
<div class="ttc" id="astructDiagonalOp_html_ada3bffa8e414f883e415dd74e46cd879"><div class="ttname"><a href="structDiagonalOp.html#ada3bffa8e414f883e415dd74e46cd879">DiagonalOp::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">The number of nodes between which the elements of this operator are split.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00306">QuEST.h:306</a></div></div>
<div class="ttc" id="astructQuESTEnv_html_aa648bb336cf8598467cb62db00b9cee8"><div class="ttname"><a href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">QuESTEnv::rank</a></div><div class="ttdeci">int rank</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00385">QuEST.h:385</a></div></div>
<div class="ttc" id="astructQuESTEnv_html_af22aacd7c9905accae28484785c193b4"><div class="ttname"><a href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">QuESTEnv::numRanks</a></div><div class="ttdeci">int numRanks</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00386">QuEST.h:386</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af798bb01f922804016c4c5bc8d0a580f" name="af798bb01f922804016c4c5bc8d0a580f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af798bb01f922804016c4c5bc8d0a580f">&#9670;&#160;</a></span>agnostic_destroyDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agnostic_destroyDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01407">1407</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1407</span>                                               {</div>
<div class="line"><span class="lineno"> 1408</span>    free(op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>);</div>
<div class="line"><span class="lineno"> 1409</span>    free(op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>);</div>
<div class="line"><span class="lineno"> 1410</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81a87bb0f0805c9dfcb691f6cb15a1b5" name="a81a87bb0f0805c9dfcb691f6cb15a1b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81a87bb0f0805c9dfcb691f6cb15a1b5">&#9670;&#160;</a></span>agnostic_initDiagonalOpFromPauliHamil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agnostic_initDiagonalOpFromPauliHamil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td>
          <td class="paramname"><em>hamil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01416">1416</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1416</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1417</span>    </div>
<div class="line"><span class="lineno"> 1418</span>    <span class="comment">/* each node modifies its op sub-partition, evaluating the full hamil </span></div>
<div class="line"><span class="lineno"> 1419</span><span class="comment">     * for every element in the sub-partition </span></div>
<div class="line"><span class="lineno"> 1420</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1421</span>    </div>
<div class="line"><span class="lineno"> 1422</span>    <span class="comment">// unpack op</span></div>
<div class="line"><span class="lineno"> 1423</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = op.<a class="code hl_variable" href="structDiagonalOp.html#aa91713a22c95a383bba55e56c4a4e37a">chunkId</a> * op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1424</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numElems = op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1425</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opRe = op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>;</div>
<div class="line"><span class="lineno"> 1426</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opIm = op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>;</div>
<div class="line"><span class="lineno"> 1427</span>    </div>
<div class="line"><span class="lineno"> 1428</span>    <span class="comment">// unpack hamil</span></div>
<div class="line"><span class="lineno"> 1429</span>    <span class="keywordtype">int</span> numTerms = hamil.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a>;</div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keywordtype">int</span> numQubits = hamil.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>;</div>
<div class="line"><span class="lineno"> 1431</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* coeffs = hamil.<a class="code hl_variable" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">termCoeffs</a>;</div>
<div class="line"><span class="lineno"> 1432</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a>* codes = hamil.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>;</div>
<div class="line"><span class="lineno"> 1433</span>    </div>
<div class="line"><span class="lineno"> 1434</span>    <span class="comment">// private OpenMP vars</span></div>
<div class="line"><span class="lineno"> 1435</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i, globalInd;</div>
<div class="line"><span class="lineno"> 1436</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> elem;</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordtype">int</span> t, q, isOddNumOnes, sign;</div>
<div class="line"><span class="lineno"> 1438</span>    </div>
<div class="line"><span class="lineno"> 1439</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1440</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1441</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1442</span><span class="preprocessor">    shared   (offset,numElems, opRe,opIm, numTerms,numQubits,coeffs,codes) \</span></div>
<div class="line"><span class="lineno"> 1443</span><span class="preprocessor">    private  (i,globalInd, elem, isOddNumOnes,t,q,sign) </span></div>
<div class="line"><span class="lineno"> 1444</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1445</span>    {</div>
<div class="line"><span class="lineno"> 1446</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1447</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1448</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1449</span>        <span class="keywordflow">for</span> (i=0; i&lt;numElems; i++) {</div>
<div class="line"><span class="lineno"> 1450</span>            </div>
<div class="line"><span class="lineno"> 1451</span>            globalInd = i + offset;</div>
<div class="line"><span class="lineno"> 1452</span>            elem = 0;</div>
<div class="line"><span class="lineno"> 1453</span>            </div>
<div class="line"><span class="lineno"> 1454</span>            <span class="comment">// add every Hamiltonian coefficient to this element, either + or -</span></div>
<div class="line"><span class="lineno"> 1455</span>            <span class="keywordflow">for</span> (t=0; t&lt;numTerms; t++) {</div>
<div class="line"><span class="lineno"> 1456</span>                </div>
<div class="line"><span class="lineno"> 1457</span>                <span class="comment">// determine parity of ones (in globalInd basis state) of the current term&#39;s targets</span></div>
<div class="line"><span class="lineno"> 1458</span>                isOddNumOnes = 0;</div>
<div class="line"><span class="lineno"> 1459</span>                <span class="keywordflow">for</span> (q=0; q&lt;numQubits; q++)</div>
<div class="line"><span class="lineno"> 1460</span>                    <span class="keywordflow">if</span> (codes[q + t*numQubits] == <a class="code hl_enumvalue" href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a>)</div>
<div class="line"><span class="lineno"> 1461</span>                        <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(q, globalInd))</div>
<div class="line"><span class="lineno"> 1462</span>                            isOddNumOnes = !isOddNumOnes;</div>
<div class="line"><span class="lineno"> 1463</span>                </div>
<div class="line"><span class="lineno"> 1464</span>                <span class="comment">// add +- term coeff (avoiding thread divergence)</span></div>
<div class="line"><span class="lineno"> 1465</span>                sign = 1 - 2*isOddNumOnes; <span class="comment">// (-1 if isOddNumOnes, else +1)</span></div>
<div class="line"><span class="lineno"> 1466</span>                elem += coeffs[t] * sign;</div>
<div class="line"><span class="lineno"> 1467</span>            }</div>
<div class="line"><span class="lineno"> 1468</span>            </div>
<div class="line"><span class="lineno"> 1469</span>            opRe[i] = elem;</div>
<div class="line"><span class="lineno"> 1470</span>            opIm[i] = 0;</div>
<div class="line"><span class="lineno"> 1471</span>        }</div>
<div class="line"><span class="lineno"> 1472</span>    }</div>
<div class="line"><span class="lineno"> 1473</span>    </div>
<div class="line"><span class="lineno"> 1474</span>    <span class="comment">// we don&#39;t synch to GPU, because in GPU mode, the GPU populates and synchs to RAM</span></div>
<div class="line"><span class="lineno"> 1475</span>    <span class="comment">// agnostic_syncDiagonalOp(op);</span></div>
<div class="line"><span class="lineno"> 1476</span>}</div>
<div class="ttc" id="aQuEST__cpu__internal_8h_html_a100463f6ec212c76a5fad99579000505"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a></div><div class="ttdeci">static int extractBit(const int locationOfBitFromRight, const long long int theEncodedNumber)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00026">QuEST_cpu_internal.h:26</a></div></div>
<div class="ttc" id="agroup__type_html_ga1c703cf89629e4e9c7023cd402d67028"><div class="ttname"><a href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a></div><div class="ttdeci">pauliOpType</div><div class="ttdoc">Codes for specifying Pauli operators.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
<div class="ttc" id="agroup__type_html_gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf"><div class="ttname"><a href="group__type.html#gga1c703cf89629e4e9c7023cd402d67028a085c85cff6ba79c52d8b1e61c42ddddf">PAULI_Z</a></div><div class="ttdeci">@ PAULI_Z</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00096">QuEST.h:96</a></div></div>
<div class="ttc" id="astructPauliHamil_html_a4b8d38c403553c07ceddcd40c46ce6c8"><div class="ttname"><a href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">PauliHamil::pauliCodes</a></div><div class="ttdeci">enum pauliOpType * pauliCodes</div><div class="ttdoc">The Pauli operators acting on each qubit, flattened over every operator.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00283">QuEST.h:283</a></div></div>
<div class="ttc" id="astructPauliHamil_html_a737e46b40ef8990cf004d22eb9dbe2e4"><div class="ttname"><a href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">PauliHamil::numSumTerms</a></div><div class="ttdeci">int numSumTerms</div><div class="ttdoc">The number of terms in the weighted sum, or the number of Pauli products.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00287">QuEST.h:287</a></div></div>
<div class="ttc" id="astructPauliHamil_html_ac1c6c9f6299cf83bbba88123216c3cac"><div class="ttname"><a href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">PauliHamil::termCoeffs</a></div><div class="ttdeci">qreal * termCoeffs</div><div class="ttdoc">The real coefficient of each Pauli product. This is an array of length PauliHamil....</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00285">QuEST.h:285</a></div></div>
<div class="ttc" id="astructPauliHamil_html_acb49fff0e3160ea1904c9ca34408b4e1"><div class="ttname"><a href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">PauliHamil::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">The number of qubits informing the Hilbert dimension of the Hamiltonian.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00289">QuEST.h:289</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab58d6d599c7a729255b1f8eeded663f3" name="ab58d6d599c7a729255b1f8eeded663f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab58d6d599c7a729255b1f8eeded663f3">&#9670;&#160;</a></span>agnostic_setDiagonalOpElems()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agnostic_setDiagonalOpElems </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>imag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numElems</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04259">4259</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4259</span>                                                                                                                          {</div>
<div class="line"><span class="lineno"> 4260</span>    </div>
<div class="line"><span class="lineno"> 4261</span>    <span class="comment">// local start/end indices of the given amplitudes, assuming they fit in this chunk</span></div>
<div class="line"><span class="lineno"> 4262</span>    <span class="comment">// these may be negative or above qureg.numAmpsPerChunk</span></div>
<div class="line"><span class="lineno"> 4263</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localStartInd = startInd - op.<a class="code hl_variable" href="structDiagonalOp.html#aa91713a22c95a383bba55e56c4a4e37a">chunkId</a>*op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4264</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localEndInd = localStartInd + numElems; <span class="comment">// exclusive</span></div>
<div class="line"><span class="lineno"> 4265</span>    </div>
<div class="line"><span class="lineno"> 4266</span>    <span class="comment">// add this to a local index to get corresponding elem in reals &amp; imags</span></div>
<div class="line"><span class="lineno"> 4267</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = op.<a class="code hl_variable" href="structDiagonalOp.html#aa91713a22c95a383bba55e56c4a4e37a">chunkId</a>*op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a> - startInd;</div>
<div class="line"><span class="lineno"> 4268</span>    </div>
<div class="line"><span class="lineno"> 4269</span>    <span class="comment">// restrict these indices to fit into this chunk</span></div>
<div class="line"><span class="lineno"> 4270</span>    <span class="keywordflow">if</span> (localStartInd &lt; 0)</div>
<div class="line"><span class="lineno"> 4271</span>        localStartInd = 0;</div>
<div class="line"><span class="lineno"> 4272</span>    <span class="keywordflow">if</span> (localEndInd &gt; op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>)</div>
<div class="line"><span class="lineno"> 4273</span>        localEndInd = op.<a class="code hl_variable" href="structDiagonalOp.html#a2c6eab631ef48b4978db026c98180eee">numElemsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4274</span>    <span class="comment">// they may now be out of order = no iterations</span></div>
<div class="line"><span class="lineno"> 4275</span>    </div>
<div class="line"><span class="lineno"> 4276</span>    <span class="comment">// unpacking OpenMP vars</span></div>
<div class="line"><span class="lineno"> 4277</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 4278</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe = op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>;</div>
<div class="line"><span class="lineno"> 4279</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm = op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>;</div>
<div class="line"><span class="lineno"> 4280</span>    </div>
<div class="line"><span class="lineno"> 4281</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4282</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4283</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 4284</span><span class="preprocessor">    shared   (localStartInd,localEndInd, vecRe,vecIm, real,imag, offset) \</span></div>
<div class="line"><span class="lineno"> 4285</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 4286</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4287</span>    {</div>
<div class="line"><span class="lineno"> 4288</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4289</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 4290</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4291</span>        <span class="comment">// iterate these local inds - this might involve no iterations</span></div>
<div class="line"><span class="lineno"> 4292</span>        <span class="keywordflow">for</span> (index=localStartInd; index &lt; localEndInd; index++) {</div>
<div class="line"><span class="lineno"> 4293</span>            vecRe[index] = real[index + offset];</div>
<div class="line"><span class="lineno"> 4294</span>            vecIm[index] = imag[index + offset];</div>
<div class="line"><span class="lineno"> 4295</span>        }</div>
<div class="line"><span class="lineno"> 4296</span>    }</div>
<div class="line"><span class="lineno"> 4297</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e8f917ab42d38d8c37ba6816b24f2f5" name="a1e8f917ab42d38d8c37ba6816b24f2f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e8f917ab42d38d8c37ba6816b24f2f5">&#9670;&#160;</a></span>agnostic_syncDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void agnostic_syncDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01412">1412</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1412</span>                                            {</div>
<div class="line"><span class="lineno"> 1413</span>    <span class="comment">// nothing to do on CPU</span></div>
<div class="line"><span class="lineno"> 1414</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0abdff5f6065f9d57065345e6d90fc94" name="a0abdff5f6065f9d57065345e6d90fc94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0abdff5f6065f9d57065345e6d90fc94">&#9670;&#160;</a></span>alternateNormZeroingSomeAmpBlocks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void alternateNormZeroingSomeAmpBlocks </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>normFirst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startAmpInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>blockSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00766">766</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  769</span>  {     </div>
<div class="line"><span class="lineno">  770</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDubBlocks = numAmps / (2*blockSize);</div>
<div class="line"><span class="lineno">  771</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> blockStartInd;</div>
<div class="line"><span class="lineno">  772</span>    </div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordflow">if</span> (normFirst) {</div>
<div class="line"><span class="lineno">  774</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dubBlockInd;</div>
<div class="line"><span class="lineno">  775</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  776</span><span class="preprocessor"># pragma omp parallel for schedule (static) private (blockStartInd)</span></div>
<div class="line"><span class="lineno">  777</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno">  778</span>        <span class="keywordflow">for</span> (dubBlockInd=0; dubBlockInd &lt; numDubBlocks; dubBlockInd++) {</div>
<div class="line"><span class="lineno">  779</span>            blockStartInd = startAmpInd + dubBlockInd*2*blockSize;</div>
<div class="line"><span class="lineno">  780</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, norm, blockStartInd,             blockSize); <span class="comment">// |0&gt;&lt;0|</span></div>
<div class="line"><span class="lineno">  781</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(     qureg,       blockStartInd + blockSize, blockSize);</div>
<div class="line"><span class="lineno">  782</span>        }</div>
<div class="line"><span class="lineno">  783</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  784</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dubBlockInd;</div>
<div class="line"><span class="lineno">  785</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  786</span><span class="preprocessor"># pragma omp parallel for schedule (static) private (blockStartInd)</span></div>
<div class="line"><span class="lineno">  787</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno">  788</span>        <span class="keywordflow">for</span> (dubBlockInd=0; dubBlockInd &lt; numDubBlocks; dubBlockInd++) {</div>
<div class="line"><span class="lineno">  789</span>            blockStartInd = startAmpInd + dubBlockInd*2*blockSize;</div>
<div class="line"><span class="lineno">  790</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(     qureg,       blockStartInd,             blockSize);</div>
<div class="line"><span class="lineno">  791</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, norm, blockStartInd + blockSize, blockSize); <span class="comment">// |1&gt;&lt;1|</span></div>
<div class="line"><span class="lineno">  792</span>        }</div>
<div class="line"><span class="lineno">  793</span>    }</div>
<div class="line"><span class="lineno">  794</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_a031a99b7e97779f3dc782feffe86e779"><div class="ttname"><a href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a></div><div class="ttdeci">void normaliseSomeAmps(Qureg qureg, qreal norm, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00756">QuEST_cpu.c:756</a></div></div>
<div class="ttc" id="aQuEST__cpu_8c_html_ac5168399122f7f53977dcc9ceda4f458"><div class="ttname"><a href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a></div><div class="ttdeci">void zeroSomeAmps(Qureg qureg, long long int startInd, long long int numAmps)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00746">QuEST_cpu.c:746</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu_8c_source.html#l00756">normaliseSomeAmps()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00746">zeroSomeAmps()</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00797">densmatr_collapseToKnownProbOutcome()</a>.</p>

</div>
</div>
<a id="afa58cf7cb98a25ab33621120c5c330d0" name="afa58cf7cb98a25ab33621120c5c330d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa58cf7cb98a25ab33621120c5c330d0">&#9670;&#160;</a></span>densmatr_applyDiagonalOpLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_applyDiagonalOpLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04113">4113</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4113</span>                                                               {</div>
<div class="line"><span class="lineno"> 4114</span>    </div>
<div class="line"><span class="lineno"> 4115</span>    <span class="comment">/* ALL values of op are pre-loaded into qureg.pairStateVector (on every node).</span></div>
<div class="line"><span class="lineno"> 4116</span><span class="comment">     * Furthermore, since it&#39;s gauranteed each node contains an integer number of </span></div>
<div class="line"><span class="lineno"> 4117</span><span class="comment">     * columns of qureg (because op upperlimits the number of nodes; 1 per element),</span></div>
<div class="line"><span class="lineno"> 4118</span><span class="comment">     * then we know iteration below begins at the &#39;top&#39; of a column, and there is </span></div>
<div class="line"><span class="lineno"> 4119</span><span class="comment">     * no offset for op (pairStateVector)</span></div>
<div class="line"><span class="lineno"> 4120</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 4121</span> </div>
<div class="line"><span class="lineno"> 4122</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4123</span>    <span class="keywordtype">int</span> opDim = (1 &lt;&lt; op.<a class="code hl_variable" href="structDiagonalOp.html#a5131eeb67aafb4c19ac98270c3266742">numQubits</a>);</div>
<div class="line"><span class="lineno"> 4124</span> </div>
<div class="line"><span class="lineno"> 4125</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4126</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4127</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opRe = qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4128</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opIm = qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4129</span>    </div>
<div class="line"><span class="lineno"> 4130</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> a,b,c,d;</div>
<div class="line"><span class="lineno"> 4131</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 4132</span> </div>
<div class="line"><span class="lineno"> 4133</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4134</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4135</span><span class="preprocessor">    shared    (stateRe,stateIm, opRe,opIm, numAmps,opDim) \</span></div>
<div class="line"><span class="lineno"> 4136</span><span class="preprocessor">    private   (index, a,b,c,d)</span></div>
<div class="line"><span class="lineno"> 4137</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 4138</span>    {</div>
<div class="line"><span class="lineno"> 4139</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4140</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 4141</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4142</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4143</span>            a = stateRe[index];</div>
<div class="line"><span class="lineno"> 4144</span>            b = stateIm[index];</div>
<div class="line"><span class="lineno"> 4145</span>            c = opRe[index % opDim];</div>
<div class="line"><span class="lineno"> 4146</span>            d = opIm[index % opDim];</div>
<div class="line"><span class="lineno"> 4147</span> </div>
<div class="line"><span class="lineno"> 4148</span>            <span class="comment">// (a + b i)(c + d i) = (a c - b d) + i (a d + b c)</span></div>
<div class="line"><span class="lineno"> 4149</span>            stateRe[index] = a*c - b*d;</div>
<div class="line"><span class="lineno"> 4150</span>            stateIm[index] = a*d + b*c;</div>
<div class="line"><span class="lineno"> 4151</span>        }</div>
<div class="line"><span class="lineno"> 4152</span>    }</div>
<div class="line"><span class="lineno"> 4153</span>}</div>
<div class="ttc" id="astructQureg_html_a441e4cacef6bd17adb9813c7442d42fe"><div class="ttname"><a href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">Qureg::stateVec</a></div><div class="ttdeci">ComplexArray stateVec</div><div class="ttdoc">Computational state amplitudes - a subset thereof in the MPI version.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00362">QuEST.h:362</a></div></div>
<div class="ttc" id="astructQureg_html_ab0ea0358482b62f43fdd781469607d97"><div class="ttname"><a href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">Qureg::numAmpsPerChunk</a></div><div class="ttdeci">long long int numAmpsPerChunk</div><div class="ttdoc">Number of probability amplitudes held in stateVec by this process In the non-MPI version,...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00353">QuEST.h:353</a></div></div>
<div class="ttc" id="astructQureg_html_aba97773694870ef35e378c036f486bb7"><div class="ttname"><a href="structQureg.html#aba97773694870ef35e378c036f486bb7">Qureg::pairStateVec</a></div><div class="ttdeci">ComplexArray pairStateVec</div><div class="ttdoc">Temporary storage for a chunk of the state vector received from another process in the MPI version.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00364">QuEST.h:364</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00302">DiagonalOp::numQubits</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01596">densmatr_applyDiagonalOp()</a>.</p>

</div>
</div>
<a id="aeb4453a2e609e5359d2995bccf6663ca" name="aeb4453a2e609e5359d2995bccf6663ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4453a2e609e5359d2995bccf6663ca">&#9670;&#160;</a></span>densmatr_calcExpecDiagonalOpLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> densmatr_calcExpecDiagonalOpLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04198">4198</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4198</span>                                                                      {</div>
<div class="line"><span class="lineno"> 4199</span>    </div>
<div class="line"><span class="lineno"> 4200</span>    <span class="comment">/* since for every 1 element in \p op, there exists a column in \p qureg, </span></div>
<div class="line"><span class="lineno"> 4201</span><span class="comment">     * we know that the elements in \p op live on the same node as the </span></div>
<div class="line"><span class="lineno"> 4202</span><span class="comment">     * corresponding diagonal elements of \p qureg. This means, the problem is </span></div>
<div class="line"><span class="lineno"> 4203</span><span class="comment">     * embarrassingly parallelisable, and the code below works for both </span></div>
<div class="line"><span class="lineno"> 4204</span><span class="comment">     * serial and distributed modes.</span></div>
<div class="line"><span class="lineno"> 4205</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 4206</span>    </div>
<div class="line"><span class="lineno"> 4207</span>    <span class="comment">// computes first local index containing a diagonal element</span></div>
<div class="line"><span class="lineno"> 4208</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + (1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno"> 4209</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>&gt;0)? 1+(qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>)/diagSpacing : 0;</div>
<div class="line"><span class="lineno"> 4210</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;</div>
<div class="line"><span class="lineno"> 4211</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4212</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4213</span>    </div>
<div class="line"><span class="lineno"> 4214</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4215</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4216</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opReal = op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>;</div>
<div class="line"><span class="lineno"> 4217</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opImag = op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>;</div>
<div class="line"><span class="lineno"> 4218</span>    </div>
<div class="line"><span class="lineno"> 4219</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> expecRe = 0;</div>
<div class="line"><span class="lineno"> 4220</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> expecIm = 0;</div>
<div class="line"><span class="lineno"> 4221</span>    </div>
<div class="line"><span class="lineno"> 4222</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateInd;</div>
<div class="line"><span class="lineno"> 4223</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> opInd;</div>
<div class="line"><span class="lineno"> 4224</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> matRe, matIm, opRe, opIm;</div>
<div class="line"><span class="lineno"> 4225</span>    </div>
<div class="line"><span class="lineno"> 4226</span>    <span class="comment">// visits every diagonal element with global index (2^n + 1)i for i in [0, 2^n-1]</span></div>
<div class="line"><span class="lineno"> 4227</span>    </div>
<div class="line"><span class="lineno"> 4228</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4229</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4230</span><span class="preprocessor">    shared    (stateReal,stateImag, opReal,opImag, localIndNextDiag,diagSpacing,numAmps) \</span></div>
<div class="line"><span class="lineno"> 4231</span><span class="preprocessor">    private   (stateInd,opInd, matRe,matIm, opRe,opIm) \</span></div>
<div class="line"><span class="lineno"> 4232</span><span class="preprocessor">    reduction ( +:expecRe, expecIm )</span></div>
<div class="line"><span class="lineno"> 4233</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 4234</span>    {</div>
<div class="line"><span class="lineno"> 4235</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4236</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 4237</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4238</span>        <span class="keywordflow">for</span> (stateInd=localIndNextDiag; stateInd &lt; numAmps; stateInd += diagSpacing) {</div>
<div class="line"><span class="lineno"> 4239</span>            </div>
<div class="line"><span class="lineno"> 4240</span>            matRe = stateReal[stateInd];</div>
<div class="line"><span class="lineno"> 4241</span>            matIm = stateImag[stateInd];</div>
<div class="line"><span class="lineno"> 4242</span>            opInd = (stateInd - localIndNextDiag) / diagSpacing;</div>
<div class="line"><span class="lineno"> 4243</span>            opRe = opReal[opInd];</div>
<div class="line"><span class="lineno"> 4244</span>            opIm = opImag[opInd];</div>
<div class="line"><span class="lineno"> 4245</span>            </div>
<div class="line"><span class="lineno"> 4246</span>            <span class="comment">// (matRe + matIm i)(opRe + opIm i) = </span></div>
<div class="line"><span class="lineno"> 4247</span>            <span class="comment">//      (matRe opRe - matIm opIm) + i (matRe opIm + matIm opRe)</span></div>
<div class="line"><span class="lineno"> 4248</span>            expecRe += matRe * opRe - matIm * opIm;</div>
<div class="line"><span class="lineno"> 4249</span>            expecIm += matRe * opIm + matIm * opRe;</div>
<div class="line"><span class="lineno"> 4250</span>        }</div>
<div class="line"><span class="lineno"> 4251</span>    }</div>
<div class="line"><span class="lineno"> 4252</span>    </div>
<div class="line"><span class="lineno"> 4253</span>    <a class="code hl_struct" href="structComplex.html">Complex</a> expecVal;</div>
<div class="line"><span class="lineno"> 4254</span>    expecVal.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = expecRe;</div>
<div class="line"><span class="lineno"> 4255</span>    expecVal.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = expecIm;</div>
<div class="line"><span class="lineno"> 4256</span>    <span class="keywordflow">return</span> expecVal;</div>
<div class="line"><span class="lineno"> 4257</span>}</div>
<div class="ttc" id="astructComplex_html"><div class="ttname"><a href="structComplex.html">Complex</a></div><div class="ttdoc">Represents one complex number.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00103">QuEST.h:104</a></div></div>
<div class="ttc" id="astructComplex_html_a84f5439aad0ef495efdd3b4c1c02d27e"><div class="ttname"><a href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">Complex::imag</a></div><div class="ttdeci">qreal imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00106">QuEST.h:106</a></div></div>
<div class="ttc" id="astructComplex_html_ab5b2e2eca02131fc74b289a83636cbe3"><div class="ttname"><a href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">Complex::real</a></div><div class="ttdeci">qreal real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00105">QuEST.h:105</a></div></div>
<div class="ttc" id="astructQureg_html_ac2929e681d3d95591c18cf168dbbe4f0"><div class="ttname"><a href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">Qureg::chunkId</a></div><div class="ttdeci">int chunkId</div><div class="ttdoc">The position of the chunk of the state vector held by this process in the full state vector.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00357">QuEST.h:357</a></div></div>
<div class="ttc" id="astructQureg_html_ad08dff5316b8937f4b2a1417591543dc"><div class="ttname"><a href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">Qureg::numQubitsRepresented</a></div><div class="ttdeci">int numQubitsRepresented</div><div class="ttdoc">The number of qubits represented in either the state-vector or density matrix.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00348">QuEST.h:348</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00312">DiagonalOp::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00310">DiagonalOp::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01620">densmatr_calcExpecDiagonalOp()</a>.</p>

</div>
</div>
<a id="a7772f97cb4d92a9825bf3b7c82c3230c" name="a7772f97cb4d92a9825bf3b7c82c3230c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7772f97cb4d92a9825bf3b7c82c3230c">&#9670;&#160;</a></span>densmatr_calcFidelityLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcFidelityLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>pureState</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes a few dens-columns-worth of (vec^*T) dens * vec </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01007">1007</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1007</span>                                                               {</div>
<div class="line"><span class="lineno"> 1008</span>        </div>
<div class="line"><span class="lineno"> 1009</span>    <span class="comment">/* Here, elements of pureState are not accessed (instead grabbed from qureg.pair).</span></div>
<div class="line"><span class="lineno"> 1010</span><span class="comment">     * We only consult the attributes.</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="comment">     * qureg is a density matrix, and pureState is a statevector.</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="comment">     * Every node contains as many columns of qureg as amps by pureState.</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="comment">     * (each node contains an integer, exponent-of-2 number of whole columns of qureg)</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="comment">     * Ergo, this node contains columns:</span></div>
<div class="line"><span class="lineno"> 1016</span><span class="comment">     * qureg.chunkID * pureState.numAmpsPerChunk  to</span></div>
<div class="line"><span class="lineno"> 1017</span><span class="comment">     * (qureg.chunkID + 1) * pureState.numAmpsPerChunk</span></div>
<div class="line"><span class="lineno"> 1018</span><span class="comment">     *</span></div>
<div class="line"><span class="lineno"> 1019</span><span class="comment">     * The first pureState.numAmpsTotal elements of qureg.pairStateVec are the</span></div>
<div class="line"><span class="lineno"> 1020</span><span class="comment">     * entire pureState state-vector</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1022</span>    </div>
<div class="line"><span class="lineno"> 1023</span>    <span class="comment">// unpack everything for OPENMP</span></div>
<div class="line"><span class="lineno"> 1024</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe  = qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1025</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm  = qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1026</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1027</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1028</span>    </div>
<div class="line"><span class="lineno"> 1029</span>    <span class="keywordtype">int</span> row, col;</div>
<div class="line"><span class="lineno"> 1030</span>    <span class="keywordtype">int</span> dim = (int) pureState.<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>; </div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordtype">int</span> colsPerNode = (<span class="keywordtype">int</span>) pureState.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1032</span>    <span class="comment">// using only int, because density matrix has squared as many amps so its </span></div>
<div class="line"><span class="lineno"> 1033</span>    <span class="comment">// iteration would be impossible if the pureStates numAmpsTotal didn&#39;t fit into int</span></div>
<div class="line"><span class="lineno"> 1034</span>    </div>
<div class="line"><span class="lineno"> 1035</span>    <span class="comment">// starting GLOBAL column index of the qureg columns on this node</span></div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keywordtype">int</span> startCol = (int) (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * pureState.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div>
<div class="line"><span class="lineno"> 1037</span>    </div>
<div class="line"><span class="lineno"> 1038</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> densElemRe, densElemIm;</div>
<div class="line"><span class="lineno"> 1039</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> prefacRe, prefacIm;</div>
<div class="line"><span class="lineno"> 1040</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rowSumRe, rowSumIm;</div>
<div class="line"><span class="lineno"> 1041</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> vecElemRe, vecElemIm;</div>
<div class="line"><span class="lineno"> 1042</span>    </div>
<div class="line"><span class="lineno"> 1043</span>    <span class="comment">// quantity computed by this node</span></div>
<div class="line"><span class="lineno"> 1044</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> globalSumRe = 0;   <span class="comment">// imag-component is assumed zero</span></div>
<div class="line"><span class="lineno"> 1045</span>    </div>
<div class="line"><span class="lineno"> 1046</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1047</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1048</span><span class="preprocessor">    shared    (vecRe,vecIm,densRe,densIm, dim,colsPerNode,startCol) \</span></div>
<div class="line"><span class="lineno"> 1049</span><span class="preprocessor">    private   (row,col, prefacRe,prefacIm, rowSumRe,rowSumIm, densElemRe,densElemIm, vecElemRe,vecElemIm) \</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="preprocessor">    reduction ( +:globalSumRe )</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 1052</span>    {</div>
<div class="line"><span class="lineno"> 1053</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1056</span>        <span class="comment">// indices of my GLOBAL row</span></div>
<div class="line"><span class="lineno"> 1057</span>        <span class="keywordflow">for</span> (row=0; row &lt; dim; row++) {</div>
<div class="line"><span class="lineno"> 1058</span>            </div>
<div class="line"><span class="lineno"> 1059</span>            <span class="comment">// single element of conj(pureState)</span></div>
<div class="line"><span class="lineno"> 1060</span>            prefacRe =   vecRe[row];</div>
<div class="line"><span class="lineno"> 1061</span>            prefacIm = - vecIm[row];</div>
<div class="line"><span class="lineno"> 1062</span>                    </div>
<div class="line"><span class="lineno"> 1063</span>            rowSumRe = 0;</div>
<div class="line"><span class="lineno"> 1064</span>            rowSumIm = 0;</div>
<div class="line"><span class="lineno"> 1065</span>            </div>
<div class="line"><span class="lineno"> 1066</span>            <span class="comment">// indices of my LOCAL column</span></div>
<div class="line"><span class="lineno"> 1067</span>            <span class="keywordflow">for</span> (col=0; col &lt; colsPerNode; col++) {</div>
<div class="line"><span class="lineno"> 1068</span>            </div>
<div class="line"><span class="lineno"> 1069</span>                <span class="comment">// my local density element</span></div>
<div class="line"><span class="lineno"> 1070</span>                densElemRe = densRe[row + dim*col];</div>
<div class="line"><span class="lineno"> 1071</span>                densElemIm = densIm[row + dim*col];</div>
<div class="line"><span class="lineno"> 1072</span>            </div>
<div class="line"><span class="lineno"> 1073</span>                <span class="comment">// state-vector element</span></div>
<div class="line"><span class="lineno"> 1074</span>                vecElemRe = vecRe[startCol + col];</div>
<div class="line"><span class="lineno"> 1075</span>                vecElemIm = vecIm[startCol + col];</div>
<div class="line"><span class="lineno"> 1076</span>            </div>
<div class="line"><span class="lineno"> 1077</span>                rowSumRe += densElemRe*vecElemRe - densElemIm*vecElemIm;</div>
<div class="line"><span class="lineno"> 1078</span>                rowSumIm += densElemRe*vecElemIm + densElemIm*vecElemRe;</div>
<div class="line"><span class="lineno"> 1079</span>            }</div>
<div class="line"><span class="lineno"> 1080</span>        </div>
<div class="line"><span class="lineno"> 1081</span>            globalSumRe += rowSumRe*prefacRe - rowSumIm*prefacIm;   </div>
<div class="line"><span class="lineno"> 1082</span>        }</div>
<div class="line"><span class="lineno"> 1083</span>    }</div>
<div class="line"><span class="lineno"> 1084</span>    </div>
<div class="line"><span class="lineno"> 1085</span>    <span class="keywordflow">return</span> globalSumRe;</div>
<div class="line"><span class="lineno"> 1086</span>}</div>
<div class="ttc" id="astructQureg_html_adef4935cac95763c29164cf99b144ed4"><div class="ttname"><a href="structQureg.html#adef4935cac95763c29164cf99b144ed4">Qureg::numAmpsTotal</a></div><div class="ttdeci">long long int numAmpsTotal</div><div class="ttdoc">Total number of amplitudes, which are possibly distributed among machines.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00355">QuEST.h:355</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00355">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00431">densmatr_calcFidelity()</a>.</p>

</div>
</div>
<a id="a939897137596bb73ad7a028d0beaaa10" name="a939897137596bb73ad7a028d0beaaa10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939897137596bb73ad7a028d0beaaa10">&#9670;&#160;</a></span>densmatr_calcHilbertSchmidtDistanceSquaredLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcHilbertSchmidtDistanceSquaredLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes Tr((a-b) conjTrans(a-b)) = sum of abs values of (a-b) </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00940">940</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  940</span>                                                                        {</div>
<div class="line"><span class="lineno">  941</span>    </div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno">  943</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = a.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  944</span>        </div>
<div class="line"><span class="lineno">  945</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *aRe = a.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  946</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *aIm = a.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  947</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *bRe = b.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  948</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *bIm = b.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  949</span>    </div>
<div class="line"><span class="lineno">  950</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> trace = 0;</div>
<div class="line"><span class="lineno">  951</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> difRe, difIm;</div>
<div class="line"><span class="lineno">  952</span>    </div>
<div class="line"><span class="lineno">  953</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  954</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  955</span><span class="preprocessor">    shared    (aRe,aIm, bRe,bIm, numAmps) \</span></div>
<div class="line"><span class="lineno">  956</span><span class="preprocessor">    private   (index,difRe,difIm) \</span></div>
<div class="line"><span class="lineno">  957</span><span class="preprocessor">    reduction ( +:trace )</span></div>
<div class="line"><span class="lineno">  958</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno">  959</span>    {</div>
<div class="line"><span class="lineno">  960</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  961</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno">  962</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  963</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno">  964</span>                        </div>
<div class="line"><span class="lineno">  965</span>            difRe = aRe[index] - bRe[index];</div>
<div class="line"><span class="lineno">  966</span>            difIm = aIm[index] - bIm[index];</div>
<div class="line"><span class="lineno">  967</span>            trace += difRe*difRe + difIm*difIm;</div>
<div class="line"><span class="lineno">  968</span>        }</div>
<div class="line"><span class="lineno">  969</span>    }</div>
<div class="line"><span class="lineno">  970</span>    </div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordflow">return</span> trace;</div>
<div class="line"><span class="lineno">  972</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00446">densmatr_calcHilbertSchmidtDistance()</a>.</p>

</div>
</div>
<a id="a08392b1b27d10e3b8a8648a5afeaa629" name="a08392b1b27d10e3b8a8648a5afeaa629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08392b1b27d10e3b8a8648a5afeaa629">&#9670;&#160;</a></span>densmatr_calcInnerProductLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcInnerProductLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>computes Tr(conjTrans(a) b) = sum of (a_ij^* b_ij) </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00975">975</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  975</span>                                                       {</div>
<div class="line"><span class="lineno">  976</span>    </div>
<div class="line"><span class="lineno">  977</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno">  978</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = a.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  979</span>        </div>
<div class="line"><span class="lineno">  980</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *aRe = a.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  981</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *aIm = a.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  982</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *bRe = b.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  983</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *bIm = b.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  984</span>    </div>
<div class="line"><span class="lineno">  985</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> trace = 0;</div>
<div class="line"><span class="lineno">  986</span>    </div>
<div class="line"><span class="lineno">  987</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  988</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  989</span><span class="preprocessor">    shared    (aRe,aIm, bRe,bIm, numAmps) \</span></div>
<div class="line"><span class="lineno">  990</span><span class="preprocessor">    private   (index) \</span></div>
<div class="line"><span class="lineno">  991</span><span class="preprocessor">    reduction ( +:trace )</span></div>
<div class="line"><span class="lineno">  992</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno">  993</span>    {</div>
<div class="line"><span class="lineno">  994</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  995</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno">  996</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  997</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno">  998</span>            trace += aRe[index]*bRe[index] + aIm[index]*bIm[index];</div>
<div class="line"><span class="lineno">  999</span>        }</div>
<div class="line"><span class="lineno"> 1000</span>    }</div>
<div class="line"><span class="lineno"> 1001</span>    </div>
<div class="line"><span class="lineno"> 1002</span>    <span class="keywordflow">return</span> trace;</div>
<div class="line"><span class="lineno"> 1003</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00457">densmatr_calcInnerProduct()</a>.</p>

</div>
</div>
<a id="a73a6c5647862b882f4ed7d83ec3c3e1f" name="a73a6c5647862b882f4ed7d83ec3c3e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73a6c5647862b882f4ed7d83ec3c3e1f">&#9670;&#160;</a></span>densmatr_calcProbOfAllOutcomesLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_calcProbOfAllOutcomesLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>outcomeProbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03647">3647</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3647</span>                                                                                                       {</div>
<div class="line"><span class="lineno"> 3648</span>    </div>
<div class="line"><span class="lineno"> 3649</span>    <span class="comment">// clear outcomeProbs (in parallel, in case it&#39;s large)</span></div>
<div class="line"><span class="lineno"> 3650</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOutcomeProbs = (1 &lt;&lt; numQubits);</div>
<div class="line"><span class="lineno"> 3651</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno"> 3652</span>    </div>
<div class="line"><span class="lineno"> 3653</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3654</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3655</span><span class="preprocessor">    default (none) \</span></div>
<div class="line"><span class="lineno"> 3656</span><span class="preprocessor">    shared    (numOutcomeProbs,outcomeProbs) \</span></div>
<div class="line"><span class="lineno"> 3657</span><span class="preprocessor">    private   (j)</span></div>
<div class="line"><span class="lineno"> 3658</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 3659</span>    {</div>
<div class="line"><span class="lineno"> 3660</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3661</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3662</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3663</span>        <span class="keywordflow">for</span> (j=0; j&lt;numOutcomeProbs; j++)</div>
<div class="line"><span class="lineno"> 3664</span>            outcomeProbs[j] = 0;</div>
<div class="line"><span class="lineno"> 3665</span>    }  </div>
<div class="line"><span class="lineno"> 3666</span>    </div>
<div class="line"><span class="lineno"> 3667</span>    <span class="comment">// compute first local index containing a diagonal element</span></div>
<div class="line"><span class="lineno"> 3668</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localNumAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3669</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = (1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno"> 3670</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + densityDim;</div>
<div class="line"><span class="lineno"> 3671</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> maxNumDiagsPerChunk = 1 + localNumAmps / diagSpacing;</div>
<div class="line"><span class="lineno"> 3672</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>&gt;0)? 1+(qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*localNumAmps)/diagSpacing : 0;</div>
<div class="line"><span class="lineno"> 3673</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;</div>
<div class="line"><span class="lineno"> 3674</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % localNumAmps;</div>
<div class="line"><span class="lineno"> 3675</span>    </div>
<div class="line"><span class="lineno"> 3676</span>    <span class="comment">// computes how many diagonals are contained in this chunk</span></div>
<div class="line"><span class="lineno"> 3677</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDiagsInThisChunk = maxNumDiagsPerChunk;</div>
<div class="line"><span class="lineno"> 3678</span>    <span class="keywordflow">if</span> (localIndNextDiag + (numDiagsInThisChunk-1)*diagSpacing &gt;= localNumAmps)</div>
<div class="line"><span class="lineno"> 3679</span>        numDiagsInThisChunk -= 1;</div>
<div class="line"><span class="lineno"> 3680</span>        </div>
<div class="line"><span class="lineno"> 3681</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> visitedDiags;     <span class="comment">// number of visited diagonals in this chunk so far</span></div>
<div class="line"><span class="lineno"> 3682</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> basisStateInd;    <span class="comment">// current diagonal index being considered</span></div>
<div class="line"><span class="lineno"> 3683</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;            <span class="comment">// index in the local chunk</span></div>
<div class="line"><span class="lineno"> 3684</span>    </div>
<div class="line"><span class="lineno"> 3685</span>    <span class="keywordtype">int</span> q;</div>
<div class="line"><span class="lineno"> 3686</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outcomeInd;</div>
<div class="line"><span class="lineno"> 3687</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3688</span>    </div>
<div class="line"><span class="lineno"> 3689</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3690</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3691</span><span class="preprocessor">    shared    (localIndNextDiag, numPrevDiags, diagSpacing, stateRe, numDiagsInThisChunk, qubits,numQubits, outcomeProbs) \</span></div>
<div class="line"><span class="lineno"> 3692</span><span class="preprocessor">    private   (visitedDiags, basisStateInd, index, q,outcomeInd)</span></div>
<div class="line"><span class="lineno"> 3693</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 3694</span>    {</div>
<div class="line"><span class="lineno"> 3695</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3696</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3697</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3698</span>        <span class="comment">// sums the diagonal elems of the density matrix where measureQubit=0</span></div>
<div class="line"><span class="lineno"> 3699</span>        <span class="keywordflow">for</span> (visitedDiags = 0; visitedDiags &lt; numDiagsInThisChunk; visitedDiags++) {</div>
<div class="line"><span class="lineno"> 3700</span>            </div>
<div class="line"><span class="lineno"> 3701</span>            basisStateInd = numPrevDiags + visitedDiags;</div>
<div class="line"><span class="lineno"> 3702</span>            index = localIndNextDiag + diagSpacing * visitedDiags;</div>
<div class="line"><span class="lineno"> 3703</span>            </div>
<div class="line"><span class="lineno"> 3704</span>            <span class="comment">// determine outcome implied by basisStateInd</span></div>
<div class="line"><span class="lineno"> 3705</span>            outcomeInd = 0;</div>
<div class="line"><span class="lineno"> 3706</span>            <span class="keywordflow">for</span> (q=0; q&lt;numQubits; q++)</div>
<div class="line"><span class="lineno"> 3707</span>                outcomeInd += <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[q], basisStateInd) * (1LL &lt;&lt; q);</div>
<div class="line"><span class="lineno"> 3708</span>    </div>
<div class="line"><span class="lineno"> 3709</span>            <span class="comment">// atomicly update corresponding outcome array element</span></div>
<div class="line"><span class="lineno"> 3710</span><span class="preprocessor">            # ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3711</span><span class="preprocessor">            # pragma omp atomic</span></div>
<div class="line"><span class="lineno"> 3712</span><span class="preprocessor">            # endif</span></div>
<div class="line"><span class="lineno"> 3713</span>            outcomeProbs[outcomeInd] += stateRe[index];</div>
<div class="line"><span class="lineno"> 3714</span>        }</div>
<div class="line"><span class="lineno"> 3715</span>    }</div>
<div class="line"><span class="lineno"> 3716</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01351">densmatr_calcProbOfAllOutcomes()</a>.</p>

</div>
</div>
<a id="af910c7cf2b85bdc2c399cfe8dbfb8b9c" name="af910c7cf2b85bdc2c399cfe8dbfb8b9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af910c7cf2b85bdc2c399cfe8dbfb8b9c">&#9670;&#160;</a></span>densmatr_calcPurityLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_calcPurityLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00878">878</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  878</span>                                            {</div>
<div class="line"><span class="lineno">  879</span>    </div>
<div class="line"><span class="lineno">  880</span>    <span class="comment">/* sum of qureg^2, which is sum_i |qureg[i]|^2 */</span></div>
<div class="line"><span class="lineno">  881</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno">  882</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  883</span>        </div>
<div class="line"><span class="lineno">  884</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> trace = 0;</div>
<div class="line"><span class="lineno">  885</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  886</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  887</span>    </div>
<div class="line"><span class="lineno">  888</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  889</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  890</span><span class="preprocessor">    shared    (vecRe, vecIm, numAmps) \</span></div>
<div class="line"><span class="lineno">  891</span><span class="preprocessor">    private   (index) \</span></div>
<div class="line"><span class="lineno">  892</span><span class="preprocessor">    reduction ( +:trace )</span></div>
<div class="line"><span class="lineno">  893</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno">  894</span>    {</div>
<div class="line"><span class="lineno">  895</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  896</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  898</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno">  899</span>                        </div>
<div class="line"><span class="lineno">  900</span>            trace += vecRe[index]*vecRe[index] + vecIm[index]*vecIm[index];</div>
<div class="line"><span class="lineno">  901</span>        }</div>
<div class="line"><span class="lineno">  902</span>    }</div>
<div class="line"><span class="lineno">  903</span>    </div>
<div class="line"><span class="lineno">  904</span>    <span class="keywordflow">return</span> trace;</div>
<div class="line"><span class="lineno">  905</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01360">densmatr_calcPurity()</a>.</p>

</div>
</div>
<a id="a8a639c31701d989a5db7aa1f6b13db60" name="a8a639c31701d989a5db7aa1f6b13db60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a639c31701d989a5db7aa1f6b13db60">&#9670;&#160;</a></span>densmatr_collapseToKnownProbOutcome()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_collapseToKnownProbOutcome </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>totalStateProb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renorms (/prob) every | * outcome * &gt;&lt; * outcome * | state, setting all others to zero. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00797">797</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  797</span>                                                                                                           {</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span>        <span class="comment">// only (global) indices (as bit sequence): &#39;* outcome *(n+q) outcome *q are spared</span></div>
<div class="line"><span class="lineno">  800</span>    <span class="comment">// where n = measureQubit, q = qureg.numQubitsRepresented.</span></div>
<div class="line"><span class="lineno">  801</span>    <span class="comment">// We can thus step in blocks of 2^q+n, killing every second, and inside the others,</span></div>
<div class="line"><span class="lineno">  802</span>    <span class="comment">//  stepping in sub-blocks of 2^q, killing every second.</span></div>
<div class="line"><span class="lineno">  803</span>    <span class="comment">// When outcome=1, we offset the start of these blocks by their size.</span></div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerBlockSize = (1LL &lt;&lt; measureQubit);</div>
<div class="line"><span class="lineno">  805</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerBlockSize = (1LL &lt;&lt; (measureQubit + qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div>
<div class="line"><span class="lineno">  806</span>    </div>
<div class="line"><span class="lineno">  807</span>    <span class="comment">// Because there are 2^a number of nodes(/chunks), each node will contain 2^b number of blocks,</span></div>
<div class="line"><span class="lineno">  808</span>    <span class="comment">// or each block will span 2^c number of nodes. Similarly for the innerblocks.</span></div>
<div class="line"><span class="lineno">  809</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> locNumAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  810</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * locNumAmps;</div>
<div class="line"><span class="lineno">  811</span>    <span class="keywordtype">int</span> innerBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(measureQubit, globalStartInd);</div>
<div class="line"><span class="lineno">  812</span>    <span class="keywordtype">int</span> outerBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(measureQubit + qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>, globalStartInd);</div>
<div class="line"><span class="lineno">  813</span>    </div>
<div class="line"><span class="lineno">  814</span>    <span class="comment">// If this chunk&#39;s amps are entirely inside an outer block</span></div>
<div class="line"><span class="lineno">  815</span>    <span class="keywordflow">if</span> (locNumAmps &lt;= outerBlockSize) {</div>
<div class="line"><span class="lineno">  816</span>        </div>
<div class="line"><span class="lineno">  817</span>        <span class="comment">// if this is an undesired outer block, kill all elems</span></div>
<div class="line"><span class="lineno">  818</span>        <span class="keywordflow">if</span> (outerBit != outcome) {</div>
<div class="line"><span class="lineno">  819</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div>
<div class="line"><span class="lineno">  820</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  821</span>        }</div>
<div class="line"><span class="lineno">  822</span>        </div>
<div class="line"><span class="lineno">  823</span>        <span class="comment">// othwerwise, if this is a desired outer block, and also entirely an inner block</span></div>
<div class="line"><span class="lineno">  824</span>        <span class="keywordflow">if</span> (locNumAmps &lt;= innerBlockSize) {</div>
<div class="line"><span class="lineno">  825</span>            </div>
<div class="line"><span class="lineno">  826</span>            <span class="comment">// and that inner block is undesired, kill all elems</span></div>
<div class="line"><span class="lineno">  827</span>            <span class="keywordflow">if</span> (innerBit != outcome) </div>
<div class="line"><span class="lineno">  828</span>                <a class="code hl_function" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, 0, qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div>
<div class="line"><span class="lineno">  829</span>            <span class="comment">// otherwise normalise all elems</span></div>
<div class="line"><span class="lineno">  830</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  831</span>                <a class="code hl_function" href="QuEST__cpu_8c.html#a031a99b7e97779f3dc782feffe86e779">normaliseSomeAmps</a>(qureg, totalStateProb, 0, qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>);</div>
<div class="line"><span class="lineno">  832</span>                </div>
<div class="line"><span class="lineno">  833</span>            <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  834</span>        }</div>
<div class="line"><span class="lineno">  835</span>                </div>
<div class="line"><span class="lineno">  836</span>        <span class="comment">// otherwise this is a desired outer block which contains 2^a inner blocks; kill/renorm every second inner block</span></div>
<div class="line"><span class="lineno">  837</span>        <a class="code hl_function" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div>
<div class="line"><span class="lineno">  838</span>            qureg, totalStateProb, innerBit==outcome, 0, qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>, innerBlockSize);</div>
<div class="line"><span class="lineno">  839</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  840</span>    }</div>
<div class="line"><span class="lineno">  841</span>    </div>
<div class="line"><span class="lineno">  842</span>    <span class="comment">// Otherwise, this chunk&#39;s amps contain multiple outer blocks (and hence multiple inner blocks)</span></div>
<div class="line"><span class="lineno">  843</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOuterDoubleBlocks = locNumAmps / (2*outerBlockSize);</div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> firstBlockInd;</div>
<div class="line"><span class="lineno">  845</span>    </div>
<div class="line"><span class="lineno">  846</span>    <span class="comment">// alternate norming* and zeroing the outer blocks (with order based on the desired outcome)</span></div>
<div class="line"><span class="lineno">  847</span>    <span class="comment">// These loops aren&#39;t parallelised, since they could have 1 or 2 iterations and will prevent</span></div>
<div class="line"><span class="lineno">  848</span>    <span class="comment">// inner parallelisation</span></div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordflow">if</span> (outerBit == outcome) {</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {</div>
<div class="line"><span class="lineno">  852</span>            firstBlockInd = outerDubBlockInd*2*outerBlockSize;</div>
<div class="line"><span class="lineno">  853</span>            </div>
<div class="line"><span class="lineno">  854</span>            <span class="comment">// *norm only the desired inner blocks in the desired outer block</span></div>
<div class="line"><span class="lineno">  855</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div>
<div class="line"><span class="lineno">  856</span>                qureg, totalStateProb, innerBit==outcome, </div>
<div class="line"><span class="lineno">  857</span>                firstBlockInd, outerBlockSize, innerBlockSize);</div>
<div class="line"><span class="lineno">  858</span>            </div>
<div class="line"><span class="lineno">  859</span>            <span class="comment">// zero the undesired outer block</span></div>
<div class="line"><span class="lineno">  860</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd + outerBlockSize, outerBlockSize);</div>
<div class="line"><span class="lineno">  861</span>        }</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>        <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerDubBlockInd = 0; outerDubBlockInd &lt; numOuterDoubleBlocks; outerDubBlockInd++) {</div>
<div class="line"><span class="lineno">  866</span>            firstBlockInd = outerDubBlockInd*2*outerBlockSize;</div>
<div class="line"><span class="lineno">  867</span>            </div>
<div class="line"><span class="lineno">  868</span>            <span class="comment">// same thing but undesired outer blocks come first</span></div>
<div class="line"><span class="lineno">  869</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#ac5168399122f7f53977dcc9ceda4f458">zeroSomeAmps</a>(qureg, firstBlockInd, outerBlockSize);</div>
<div class="line"><span class="lineno">  870</span>            <a class="code hl_function" href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a>(</div>
<div class="line"><span class="lineno">  871</span>                qureg, totalStateProb, innerBit==outcome, </div>
<div class="line"><span class="lineno">  872</span>                firstBlockInd + outerBlockSize, outerBlockSize, innerBlockSize);</div>
<div class="line"><span class="lineno">  873</span>        }</div>
<div class="line"><span class="lineno">  874</span>    }</div>
<div class="line"><span class="lineno">  875</span>    </div>
<div class="line"><span class="lineno">  876</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_a0abdff5f6065f9d57065345e6d90fc94"><div class="ttname"><a href="QuEST__cpu_8c.html#a0abdff5f6065f9d57065345e6d90fc94">alternateNormZeroingSomeAmpBlocks</a></div><div class="ttdeci">void alternateNormZeroingSomeAmpBlocks(Qureg qureg, qreal norm, int normFirst, long long int startAmpInd, long long int numAmps, long long int blockSize)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00766">QuEST_cpu.c:766</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bea931504c90d9bd97e74645667804e" name="a8bea931504c90d9bd97e74645667804e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bea931504c90d9bd97e74645667804e">&#9670;&#160;</a></span>densmatr_findProbabilityOfZeroLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> densmatr_findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03433">3433</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3433</span>                                                                         {</div>
<div class="line"><span class="lineno"> 3434</span>    </div>
<div class="line"><span class="lineno"> 3435</span>    <span class="comment">// computes first local index containing a diagonal element</span></div>
<div class="line"><span class="lineno"> 3436</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localNumAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3437</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = (1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno"> 3438</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> diagSpacing = 1LL + densityDim;</div>
<div class="line"><span class="lineno"> 3439</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> maxNumDiagsPerChunk = 1 + localNumAmps / diagSpacing;</div>
<div class="line"><span class="lineno"> 3440</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numPrevDiags = (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>&gt;0)? 1+(qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*localNumAmps)/diagSpacing : 0;</div>
<div class="line"><span class="lineno"> 3441</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndNextDiag = diagSpacing * numPrevDiags;</div>
<div class="line"><span class="lineno"> 3442</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localIndNextDiag = globalIndNextDiag % localNumAmps;</div>
<div class="line"><span class="lineno"> 3443</span>    </div>
<div class="line"><span class="lineno"> 3444</span>    <span class="comment">// computes how many diagonals are contained in this chunk</span></div>
<div class="line"><span class="lineno"> 3445</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numDiagsInThisChunk = maxNumDiagsPerChunk;</div>
<div class="line"><span class="lineno"> 3446</span>    <span class="keywordflow">if</span> (localIndNextDiag + (numDiagsInThisChunk-1)*diagSpacing &gt;= localNumAmps)</div>
<div class="line"><span class="lineno"> 3447</span>        numDiagsInThisChunk -= 1;</div>
<div class="line"><span class="lineno"> 3448</span>    </div>
<div class="line"><span class="lineno"> 3449</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> visitedDiags;     <span class="comment">// number of visited diagonals in this chunk so far</span></div>
<div class="line"><span class="lineno"> 3450</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> basisStateInd;    <span class="comment">// current diagonal index being considered</span></div>
<div class="line"><span class="lineno"> 3451</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;            <span class="comment">// index in the local chunk</span></div>
<div class="line"><span class="lineno"> 3452</span>    </div>
<div class="line"><span class="lineno"> 3453</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> zeroProb = 0;</div>
<div class="line"><span class="lineno"> 3454</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3455</span>    </div>
<div class="line"><span class="lineno"> 3456</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3457</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3458</span><span class="preprocessor">    shared    (localIndNextDiag, numPrevDiags, diagSpacing, stateVecReal, numDiagsInThisChunk) \</span></div>
<div class="line"><span class="lineno"> 3459</span><span class="preprocessor">    private   (visitedDiags, basisStateInd, index) \</span></div>
<div class="line"><span class="lineno"> 3460</span><span class="preprocessor">    reduction ( +:zeroProb )</span></div>
<div class="line"><span class="lineno"> 3461</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 3462</span>    {</div>
<div class="line"><span class="lineno"> 3463</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3464</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3465</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3466</span>        <span class="comment">// sums the diagonal elems of the density matrix where measureQubit=0</span></div>
<div class="line"><span class="lineno"> 3467</span>        <span class="keywordflow">for</span> (visitedDiags = 0; visitedDiags &lt; numDiagsInThisChunk; visitedDiags++) {</div>
<div class="line"><span class="lineno"> 3468</span>            </div>
<div class="line"><span class="lineno"> 3469</span>            basisStateInd = numPrevDiags + visitedDiags;</div>
<div class="line"><span class="lineno"> 3470</span>            index = localIndNextDiag + diagSpacing * visitedDiags;</div>
<div class="line"><span class="lineno"> 3471</span>    </div>
<div class="line"><span class="lineno"> 3472</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(measureQubit, basisStateInd) == 0)</div>
<div class="line"><span class="lineno"> 3473</span>                zeroProb += stateVecReal[index]; <span class="comment">// assume imag[diagonls] ~ 0</span></div>
<div class="line"><span class="lineno"> 3474</span> </div>
<div class="line"><span class="lineno"> 3475</span>        }</div>
<div class="line"><span class="lineno"> 3476</span>    }</div>
<div class="line"><span class="lineno"> 3477</span>    </div>
<div class="line"><span class="lineno"> 3478</span>    <span class="keywordflow">return</span> zeroProb;</div>
<div class="line"><span class="lineno"> 3479</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01330">densmatr_calcProbOfOutcome()</a>.</p>

</div>
</div>
<a id="a20a155f53efc45c16803d7539c2c199d" name="a20a155f53efc45c16803d7539c2c199d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20a155f53efc45c16803d7539c2c199d">&#9670;&#160;</a></span>densmatr_initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01132">1132</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1133</span>{</div>
<div class="line"><span class="lineno"> 1134</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityNumElems = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1138</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1139</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>    <span class="comment">// initialise the state to all zeros</span></div>
<div class="line"><span class="lineno"> 1142</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1143</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1146</span><span class="preprocessor">    shared   (densityNumElems, densityReal, densityImag) \</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1148</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1149</span>    {</div>
<div class="line"><span class="lineno"> 1150</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1151</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1152</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1153</span>        <span class="keywordflow">for</span> (index=0; index&lt;densityNumElems; index++) {</div>
<div class="line"><span class="lineno"> 1154</span>            densityReal[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1155</span>            densityImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1156</span>        }</div>
<div class="line"><span class="lineno"> 1157</span>    }</div>
<div class="line"><span class="lineno"> 1158</span>    </div>
<div class="line"><span class="lineno"> 1159</span>    <span class="comment">// index of the single density matrix elem to set non-zero</span></div>
<div class="line"><span class="lineno"> 1160</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityDim = 1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div>
<div class="line"><span class="lineno"> 1161</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> densityInd = (densityDim + 1)*stateInd;</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>    <span class="comment">// give the specified classical state prob 1</span></div>
<div class="line"><span class="lineno"> 1164</span>    <span class="keywordflow">if</span> (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> == densityInd / densityNumElems){</div>
<div class="line"><span class="lineno"> 1165</span>        densityReal[densityInd % densityNumElems] = 1.0;</div>
<div class="line"><span class="lineno"> 1166</span>        densityImag[densityInd % densityNumElems] = 0.0;</div>
<div class="line"><span class="lineno"> 1167</span>    }</div>
<div class="line"><span class="lineno"> 1168</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5b2ac0b00afa495f385520b2c5fa839" name="ad5b2ac0b00afa495f385520b2c5fa839"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5b2ac0b00afa495f385520b2c5fa839">&#9670;&#160;</a></span>densmatr_initPlusState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01171">1171</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1172</span>{</div>
<div class="line"><span class="lineno"> 1173</span>    <span class="comment">// |+&gt;&lt;+| = sum_i 1/sqrt(2^N) |i&gt; 1/sqrt(2^N) &lt;j| = sum_ij 1/2^N |i&gt;&lt;j|</span></div>
<div class="line"><span class="lineno"> 1174</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> dim = (1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno"> 1175</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> probFactor = 1.0/((<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>) dim);</div>
<div class="line"><span class="lineno"> 1176</span> </div>
<div class="line"><span class="lineno"> 1177</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1178</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1179</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *densityImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1182</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1183</span>    <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span></div>
<div class="line"><span class="lineno"> 1184</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1185</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1186</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1187</span><span class="preprocessor">    shared   (chunkSize, densityReal, densityImag, probFactor) \</span></div>
<div class="line"><span class="lineno"> 1188</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1189</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1190</span>    {</div>
<div class="line"><span class="lineno"> 1191</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1194</span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div>
<div class="line"><span class="lineno"> 1195</span>            densityReal[index] = probFactor;</div>
<div class="line"><span class="lineno"> 1196</span>            densityImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1197</span>        }</div>
<div class="line"><span class="lineno"> 1198</span>    }</div>
<div class="line"><span class="lineno"> 1199</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1b36518c8fbbc3a5084bb4ad1fb05ea5" name="a1b36518c8fbbc3a5084bb4ad1fb05ea5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b36518c8fbbc3a5084bb4ad1fb05ea5">&#9670;&#160;</a></span>densmatr_initPureStateLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_initPureStateLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>copyQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01201">1201</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1201</span>                                                                     {</div>
<div class="line"><span class="lineno"> 1202</span>    </div>
<div class="line"><span class="lineno"> 1203</span>    <span class="comment">/* copyQureg amps aren&#39;t explicitly used - they&#39;re accessed through targetQureg.pair,</span></div>
<div class="line"><span class="lineno"> 1204</span><span class="comment">     * which contains the full pure statevector.</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="comment">     * targetQureg has as many columns on node as copyQureg has amps</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 1207</span>    </div>
<div class="line"><span class="lineno"> 1208</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> colOffset = targetQureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * copyQureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1209</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> colsPerNode = copyQureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1210</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> rowsPerNode = copyQureg.<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a>;</div>
<div class="line"><span class="lineno"> 1211</span>    </div>
<div class="line"><span class="lineno"> 1212</span>    <span class="comment">// unpack vars for OpenMP</span></div>
<div class="line"><span class="lineno"> 1213</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe = targetQureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1214</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm = targetQureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1215</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densRe = targetQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1216</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* densIm = targetQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1217</span>    </div>
<div class="line"><span class="lineno"> 1218</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> col, row, index;</div>
<div class="line"><span class="lineno"> 1219</span>    </div>
<div class="line"><span class="lineno"> 1220</span>    <span class="comment">// a_i conj(a_j) |i&gt;&lt;j|</span></div>
<div class="line"><span class="lineno"> 1221</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> ketRe, ketIm, braRe, braIm;</div>
<div class="line"><span class="lineno"> 1222</span>    </div>
<div class="line"><span class="lineno"> 1223</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1224</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1225</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1226</span><span class="preprocessor">    shared   (colOffset, colsPerNode,rowsPerNode, vecRe,vecIm,densRe,densIm) \</span></div>
<div class="line"><span class="lineno"> 1227</span><span class="preprocessor">    private  (col,row, ketRe,ketIm,braRe,braIm, index) </span></div>
<div class="line"><span class="lineno"> 1228</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1229</span>    {</div>
<div class="line"><span class="lineno"> 1230</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1233</span>        <span class="comment">// local column</span></div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keywordflow">for</span> (col=0; col &lt; colsPerNode; col++) {</div>
<div class="line"><span class="lineno"> 1235</span>        </div>
<div class="line"><span class="lineno"> 1236</span>            <span class="comment">// global row</span></div>
<div class="line"><span class="lineno"> 1237</span>            <span class="keywordflow">for</span> (row=0; row &lt; rowsPerNode; row++) {</div>
<div class="line"><span class="lineno"> 1238</span>            </div>
<div class="line"><span class="lineno"> 1239</span>                <span class="comment">// get pure state amps</span></div>
<div class="line"><span class="lineno"> 1240</span>                ketRe = vecRe[row];</div>
<div class="line"><span class="lineno"> 1241</span>                ketIm = vecIm[row];</div>
<div class="line"><span class="lineno"> 1242</span>                braRe =   vecRe[col + colOffset];</div>
<div class="line"><span class="lineno"> 1243</span>                braIm = - vecIm[col + colOffset]; <span class="comment">// minus for conjugation</span></div>
<div class="line"><span class="lineno"> 1244</span>            </div>
<div class="line"><span class="lineno"> 1245</span>                <span class="comment">// update density matrix</span></div>
<div class="line"><span class="lineno"> 1246</span>                index = row + col*rowsPerNode; <span class="comment">// local ind</span></div>
<div class="line"><span class="lineno"> 1247</span>                densRe[index] = ketRe*braRe - ketIm*braIm;</div>
<div class="line"><span class="lineno"> 1248</span>                densIm[index] = ketRe*braIm + ketIm*braRe;</div>
<div class="line"><span class="lineno"> 1249</span>            }</div>
<div class="line"><span class="lineno"> 1250</span>        }</div>
<div class="line"><span class="lineno"> 1251</span>    }</div>
<div class="line"><span class="lineno"> 1252</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00355">Qureg::numAmpsTotal</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00468">densmatr_initPureState()</a>.</p>

</div>
</div>
<a id="a8d9c19a3424f0ad89bfbfd920d65301d" name="a8d9c19a3424f0ad89bfbfd920d65301d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d9c19a3424f0ad89bfbfd920d65301d">&#9670;&#160;</a></span>densmatr_mixDampingDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDampingDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>damping</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00312">312</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  312</span>                                                                                 {</div>
<div class="line"><span class="lineno">  313</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-damping;</div>
<div class="line"><span class="lineno">  314</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase=sqrt(1-damping);</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>    <span class="comment">// multiply the off-diagonal (|0&gt;&lt;1| and |1&gt;&lt;0|) terms by sqrt(1-damping)</span></div>
<div class="line"><span class="lineno">  317</span>    <a class="code hl_function" href="QuEST__cpu_8c.html#a717a0448066831cb5b392bcf2e1d0529">densmatr_oneQubitDegradeOffDiagonal</a>(qureg, targetQubit, dephase);</div>
<div class="line"><span class="lineno">  318</span>    </div>
<div class="line"><span class="lineno">  319</span>    <span class="comment">// below, we modify the diagonals terms which require |1&gt;&lt;1| to |0&gt;&lt;0| communication</span></div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlock, sizeInnerHalfBlock;</div>
<div class="line"><span class="lineno">  322</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterHalfColumn;</div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno">  324</span>         thisOuterColumn, <span class="comment">// current column in density matrix</span></div>
<div class="line"><span class="lineno">  325</span>         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div>
<div class="line"><span class="lineno">  326</span>         thisIndexInOuterColumn,</div>
<div class="line"><span class="lineno">  327</span>         thisIndexInInnerBlock; </div>
<div class="line"><span class="lineno">  328</span>    <span class="keywordtype">int</span> outerBit; </div>
<div class="line"><span class="lineno">  329</span>    <span class="keywordtype">int</span> stateBit;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno">  332</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno">  335</span>    sizeInnerHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno">  336</span>    sizeInnerBlock = 2LL * sizeInnerHalfBlock; </div>
<div class="line"><span class="lineno">  337</span>    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div>
<div class="line"><span class="lineno">  338</span>    sizeOuterHalfColumn = sizeOuterColumn &gt;&gt; 1;</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  341</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  342</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  343</span><span class="preprocessor">    shared   (sizeInnerBlock,sizeInnerHalfBlock,sizeOuterColumn,sizeOuterHalfColumn, \</span></div>
<div class="line"><span class="lineno">  344</span><span class="preprocessor">                qureg,damping, retain, dephase, numTasks,targetQubit) \</span></div>
<div class="line"><span class="lineno">  345</span><span class="preprocessor">    private  (thisTask,thisInnerBlock,thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span></div>
<div class="line"><span class="lineno">  346</span><span class="preprocessor">                thisIndexInInnerBlock,outerBit, stateBit)</span></div>
<div class="line"><span class="lineno">  347</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  348</span>    {</div>
<div class="line"><span class="lineno">  349</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  350</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  351</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  352</span>        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div>
<div class="line"><span class="lineno">  353</span>        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div>
<div class="line"><span class="lineno">  354</span>        <span class="comment">// within one column.</span></div>
<div class="line"><span class="lineno">  355</span>        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div>
<div class="line"><span class="lineno">  356</span>        <span class="comment">// outer block or less</span></div>
<div class="line"><span class="lineno">  357</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno">  358</span>            <span class="comment">// we want to process all columns in the density matrix,</span></div>
<div class="line"><span class="lineno">  359</span>            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div>
<div class="line"><span class="lineno">  360</span>            thisOuterColumn = thisTask / sizeOuterHalfColumn;</div>
<div class="line"><span class="lineno">  361</span>            thisIndexInOuterColumn = thisTask&amp;(sizeOuterHalfColumn-1); <span class="comment">// thisTask % sizeOuterHalfColumn</span></div>
<div class="line"><span class="lineno">  362</span>            thisInnerBlock = thisIndexInOuterColumn/sizeInnerHalfBlock;</div>
<div class="line"><span class="lineno">  363</span>            <span class="comment">// get index in state vector corresponding to upper inner block</span></div>
<div class="line"><span class="lineno">  364</span>            thisIndexInInnerBlock = thisTask&amp;(sizeInnerHalfBlock-1); <span class="comment">// thisTask % sizeInnerHalfBlock</span></div>
<div class="line"><span class="lineno">  365</span>            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlock*sizeInnerBlock </div>
<div class="line"><span class="lineno">  366</span>                + thisIndexInInnerBlock;</div>
<div class="line"><span class="lineno">  367</span>            <span class="comment">// check if we are in the upper or lower half of an outer block</span></div>
<div class="line"><span class="lineno">  368</span>            outerBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  369</span>            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div>
<div class="line"><span class="lineno">  370</span>            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div>
<div class="line"><span class="lineno">  371</span>            thisIndex += outerBit*(sizeInnerHalfBlock);</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div>
<div class="line"><span class="lineno">  374</span>            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div>
<div class="line"><span class="lineno">  375</span>            <span class="comment">// density matrix representation. </span></div>
<div class="line"><span class="lineno">  376</span>            <span class="comment">// thisTask is the index of the pair element in pairStateVec</span></div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>            <span class="comment">// Extract state bit, is 0 if thisIndex corresponds to a state with 0 in the target qubit</span></div>
<div class="line"><span class="lineno">  379</span>            <span class="comment">// and is 1 if thisIndex corresponds to a state with 1 in the target qubit</span></div>
<div class="line"><span class="lineno">  380</span>            stateBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>));</div>
<div class="line"><span class="lineno">  381</span>           </div>
<div class="line"><span class="lineno">  382</span>            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div>
<div class="line"><span class="lineno">  383</span>            <span class="comment">//      + pair[thisTask])/2</span></div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">if</span>(stateBit == 0){</div>
<div class="line"><span class="lineno">  385</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div>
<div class="line"><span class="lineno">  386</span>                    damping*( qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisTask]);</div>
<div class="line"><span class="lineno">  387</span>                </div>
<div class="line"><span class="lineno">  388</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div>
<div class="line"><span class="lineno">  389</span>                    damping*( qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisTask]);</div>
<div class="line"><span class="lineno">  390</span>            } <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  391</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex];</div>
<div class="line"><span class="lineno">  392</span>            </div>
<div class="line"><span class="lineno">  393</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex];</div>
<div class="line"><span class="lineno">  394</span>            }</div>
<div class="line"><span class="lineno">  395</span>        } </div>
<div class="line"><span class="lineno">  396</span>    }    </div>
<div class="line"><span class="lineno">  397</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_a717a0448066831cb5b392bcf2e1d0529"><div class="ttname"><a href="QuEST__cpu_8c.html#a717a0448066831cb5b392bcf2e1d0529">densmatr_oneQubitDegradeOffDiagonal</a></div><div class="ttdeci">void densmatr_oneQubitDegradeOffDiagonal(Qureg qureg, int targetQubit, qreal retain)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00060">QuEST_cpu.c:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00060">densmatr_oneQubitDegradeOffDiagonal()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00741">densmatr_mixDamping()</a>.</p>

</div>
</div>
<a id="ab124a3a9956046bf9c0e1e3ae9171f42" name="ab124a3a9956046bf9c0e1e3ae9171f42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab124a3a9956046bf9c0e1e3ae9171f42">&#9670;&#160;</a></span>densmatr_mixDampingLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDampingLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>damping</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00186">186</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  186</span>                                                                           {</div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-damping;</div>
<div class="line"><span class="lineno">  188</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> dephase=sqrt(retain);</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  191</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div>
<div class="line"><span class="lineno">  193</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno">  196</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="comment">//qreal realAv, imagAv;</span></div>
<div class="line"><span class="lineno">  200</span>        </div>
<div class="line"><span class="lineno">  201</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  202</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  203</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  204</span><span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain,damping,dephase,numTasks) \</span></div>
<div class="line"><span class="lineno">  205</span><span class="preprocessor">    private  (thisTask,partner,thisPattern)</span></div>
<div class="line"><span class="lineno">  206</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  207</span>    {</div>
<div class="line"><span class="lineno">  208</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  209</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  210</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  211</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div>
<div class="line"><span class="lineno">  212</span>            thisPattern = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div>
<div class="line"><span class="lineno">  213</span>            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div>
<div class="line"><span class="lineno">  214</span>                <span class="comment">// do dephase</span></div>
<div class="line"><span class="lineno">  215</span>                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div>
<div class="line"><span class="lineno">  216</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = dephase*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div>
<div class="line"><span class="lineno">  217</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = dephase*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div>
<div class="line"><span class="lineno">  218</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  219</span>                <span class="keywordflow">if</span> ((thisTask&amp;totMask)==0){ <span class="comment">//this element relates to targetQubit in state 0</span></div>
<div class="line"><span class="lineno">  220</span>                    <span class="comment">// do depolarise</span></div>
<div class="line"><span class="lineno">  221</span>                    partner = thisTask | totMask;</div>
<div class="line"><span class="lineno">  222</span>                    <span class="comment">//realAv =  (qureg.stateVec.real[thisTask] + qureg.stateVec.real[partner]) /2 ;</span></div>
<div class="line"><span class="lineno">  223</span>                    <span class="comment">//imagAv =  (qureg.stateVec.imag[thisTask] + qureg.stateVec.imag[partner]) /2 ;</span></div>
<div class="line"><span class="lineno">  224</span>                    </div>
<div class="line"><span class="lineno">  225</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] + damping*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div>
<div class="line"><span class="lineno">  226</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] + damping*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div>
<div class="line"><span class="lineno">  227</span>                    </div>
<div class="line"><span class="lineno">  228</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div>
<div class="line"><span class="lineno">  229</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div>
<div class="line"><span class="lineno">  230</span>                }</div>
<div class="line"><span class="lineno">  231</span>            }</div>
<div class="line"><span class="lineno">  232</span>        }  </div>
<div class="line"><span class="lineno">  233</span>    }</div>
<div class="line"><span class="lineno">  234</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00741">densmatr_mixDamping()</a>.</p>

</div>
</div>
<a id="a8adaba9dbdad6f7ab41ae4b8db0abefe" name="a8adaba9dbdad6f7ab41ae4b8db0abefe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8adaba9dbdad6f7ab41ae4b8db0abefe">&#9670;&#160;</a></span>densmatr_mixDensityMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDensityMatrix </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>combineQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>otherProb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>otherQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00907">907</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  907</span>                                                                                      {</div>
<div class="line"><span class="lineno">  908</span>    </div>
<div class="line"><span class="lineno">  909</span>    <span class="comment">/* corresponding amplitudes live on the same node (same dimensions) */</span></div>
<div class="line"><span class="lineno">  910</span>    </div>
<div class="line"><span class="lineno">  911</span>    <span class="comment">// unpack vars for OpenMP</span></div>
<div class="line"><span class="lineno">  912</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* combineVecRe = combineQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  913</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* combineVecIm = combineQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  914</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* otherVecRe = otherQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno">  915</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* otherVecIm = otherQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno">  916</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = combineQureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  917</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno">  918</span>    </div>
<div class="line"><span class="lineno">  919</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  920</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  921</span><span class="preprocessor">    default (none) \</span></div>
<div class="line"><span class="lineno">  922</span><span class="preprocessor">    shared  (combineVecRe,combineVecIm,otherVecRe,otherVecIm, otherProb, numAmps) \</span></div>
<div class="line"><span class="lineno">  923</span><span class="preprocessor">    private (index)</span></div>
<div class="line"><span class="lineno">  924</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno">  925</span>    {</div>
<div class="line"><span class="lineno">  926</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  927</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno">  928</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  929</span>        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {</div>
<div class="line"><span class="lineno">  930</span>            combineVecRe[index] *= 1-otherProb;</div>
<div class="line"><span class="lineno">  931</span>            combineVecIm[index] *= 1-otherProb;</div>
<div class="line"><span class="lineno">  932</span>            </div>
<div class="line"><span class="lineno">  933</span>            combineVecRe[index] += otherProb * otherVecRe[index];</div>
<div class="line"><span class="lineno">  934</span>            combineVecIm[index] += otherProb * otherVecIm[index];</div>
<div class="line"><span class="lineno">  935</span>        }</div>
<div class="line"><span class="lineno">  936</span>    }</div>
<div class="line"><span class="lineno">  937</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa31f0ef43a921c3ac73545d1d3670fa1" name="aa31f0ef43a921c3ac73545d1d3670fa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31f0ef43a921c3ac73545d1d3670fa1">&#9670;&#160;</a></span>densmatr_mixDephasing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDephasing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00091">91</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   91</span>                                                                        {</div>
<div class="line"><span class="lineno">   92</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-dephase;</div>
<div class="line"><span class="lineno">   93</span>    <a class="code hl_function" href="QuEST__cpu_8c.html#a717a0448066831cb5b392bcf2e1d0529">densmatr_oneQubitDegradeOffDiagonal</a>(qureg, targetQubit, retain);</div>
<div class="line"><span class="lineno">   94</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00236">densmatr_mixDepolarisingDistributed()</a>.</p>

</div>
</div>
<a id="a88670d0e7cebe33f61c1dd98daa338b3" name="a88670d0e7cebe33f61c1dd98daa338b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88670d0e7cebe33f61c1dd98daa338b3">&#9670;&#160;</a></span>densmatr_mixDepolarisingDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDepolarisingDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>depolLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00236">236</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  236</span>                                                                                         {</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    <span class="comment">// first do dephase part. </span></div>
<div class="line"><span class="lineno">  239</span>    <span class="comment">// TODO -- this might be more efficient to do at the same time as the depolarise if we move to</span></div>
<div class="line"><span class="lineno">  240</span>    <span class="comment">// iterating over all elements in the state vector for the purpose of vectorisation</span></div>
<div class="line"><span class="lineno">  241</span>    <span class="comment">// TODO -- if we keep this split, move this function to densmatr_mixDepolarising()</span></div>
<div class="line"><span class="lineno">  242</span>    <a class="code hl_function" href="QuEST__cpu_8c.html#aa31f0ef43a921c3ac73545d1d3670fa1">densmatr_mixDephasing</a>(qureg, targetQubit, depolLevel);</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlock, sizeInnerHalfBlock;</div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterHalfColumn;</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno">  247</span>         thisOuterColumn, <span class="comment">// current column in density matrix</span></div>
<div class="line"><span class="lineno">  248</span>         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div>
<div class="line"><span class="lineno">  249</span>         thisIndexInOuterColumn,</div>
<div class="line"><span class="lineno">  250</span>         thisIndexInInnerBlock; </div>
<div class="line"><span class="lineno">  251</span>    <span class="keywordtype">int</span> outerBit; </div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno">  257</span>    sizeInnerHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno">  258</span>    sizeInnerBlock = 2LL * sizeInnerHalfBlock; </div>
<div class="line"><span class="lineno">  259</span>    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div>
<div class="line"><span class="lineno">  260</span>    sizeOuterHalfColumn = sizeOuterColumn &gt;&gt; 1;</div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  263</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  264</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  265</span><span class="preprocessor">    shared   (sizeInnerBlock,sizeInnerHalfBlock,sizeOuterColumn,sizeOuterHalfColumn, \</span></div>
<div class="line"><span class="lineno">  266</span><span class="preprocessor">                qureg,depolLevel,numTasks,targetQubit) \</span></div>
<div class="line"><span class="lineno">  267</span><span class="preprocessor">    private  (thisTask,thisInnerBlock,thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span></div>
<div class="line"><span class="lineno">  268</span><span class="preprocessor">                thisIndexInInnerBlock,outerBit)</span></div>
<div class="line"><span class="lineno">  269</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  270</span>    {</div>
<div class="line"><span class="lineno">  271</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  272</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  273</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  274</span>        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div>
<div class="line"><span class="lineno">  275</span>        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div>
<div class="line"><span class="lineno">  276</span>        <span class="comment">// within one column.</span></div>
<div class="line"><span class="lineno">  277</span>        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div>
<div class="line"><span class="lineno">  278</span>        <span class="comment">// outer block or less</span></div>
<div class="line"><span class="lineno">  279</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno">  280</span>            <span class="comment">// we want to process all columns in the density matrix,</span></div>
<div class="line"><span class="lineno">  281</span>            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div>
<div class="line"><span class="lineno">  282</span>            thisOuterColumn = thisTask / sizeOuterHalfColumn;</div>
<div class="line"><span class="lineno">  283</span>            thisIndexInOuterColumn = thisTask&amp;(sizeOuterHalfColumn-1); <span class="comment">// thisTask % sizeOuterHalfColumn</span></div>
<div class="line"><span class="lineno">  284</span>            thisInnerBlock = thisIndexInOuterColumn/sizeInnerHalfBlock;</div>
<div class="line"><span class="lineno">  285</span>            <span class="comment">// get index in state vector corresponding to upper inner block</span></div>
<div class="line"><span class="lineno">  286</span>            thisIndexInInnerBlock = thisTask&amp;(sizeInnerHalfBlock-1); <span class="comment">// thisTask % sizeInnerHalfBlock</span></div>
<div class="line"><span class="lineno">  287</span>            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlock*sizeInnerBlock </div>
<div class="line"><span class="lineno">  288</span>                + thisIndexInInnerBlock;</div>
<div class="line"><span class="lineno">  289</span>            <span class="comment">// check if we are in the upper or lower half of an outer block</span></div>
<div class="line"><span class="lineno">  290</span>            outerBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  291</span>            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div>
<div class="line"><span class="lineno">  292</span>            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div>
<div class="line"><span class="lineno">  293</span>            thisIndex += outerBit*(sizeInnerHalfBlock);</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div>
<div class="line"><span class="lineno">  296</span>            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div>
<div class="line"><span class="lineno">  297</span>            <span class="comment">// density matrix representation. </span></div>
<div class="line"><span class="lineno">  298</span>            <span class="comment">// thisTask is the index of the pair element in pairStateVec</span></div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>           </div>
<div class="line"><span class="lineno">  301</span>            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div>
<div class="line"><span class="lineno">  302</span>            <span class="comment">//      + pair[thisTask])/2</span></div>
<div class="line"><span class="lineno">  303</span>            qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = (1-depolLevel)*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div>
<div class="line"><span class="lineno">  304</span>                    depolLevel*(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] + qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisTask])/2;</div>
<div class="line"><span class="lineno">  305</span>            </div>
<div class="line"><span class="lineno">  306</span>            qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = (1-depolLevel)*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div>
<div class="line"><span class="lineno">  307</span>                    depolLevel*(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] + qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisTask])/2;</div>
<div class="line"><span class="lineno">  308</span>        } </div>
<div class="line"><span class="lineno">  309</span>    }    </div>
<div class="line"><span class="lineno">  310</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_aa31f0ef43a921c3ac73545d1d3670fa1"><div class="ttname"><a href="QuEST__cpu_8c.html#aa31f0ef43a921c3ac73545d1d3670fa1">densmatr_mixDephasing</a></div><div class="ttdeci">void densmatr_mixDephasing(Qureg qureg, int targetQubit, qreal dephase)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l00091">QuEST_cpu.c:91</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu_8c_source.html#l00091">densmatr_mixDephasing()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00714">densmatr_mixDepolarising()</a>.</p>

</div>
</div>
<a id="ab750fb47da2fca9849c678c869e40e69" name="ab750fb47da2fca9849c678c869e40e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab750fb47da2fca9849c678c869e40e69">&#9670;&#160;</a></span>densmatr_mixDepolarisingLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixDepolarisingLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>depolLevel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00137">137</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  137</span>                                                                                   {</div>
<div class="line"><span class="lineno">  138</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-depolLevel;</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div>
<div class="line"><span class="lineno">  147</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> realAv, imagAv;</div>
<div class="line"><span class="lineno">  150</span>        </div>
<div class="line"><span class="lineno">  151</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  152</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  153</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  154</span><span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain,depolLevel,numTasks) \</span></div>
<div class="line"><span class="lineno">  155</span><span class="preprocessor">    private  (thisTask,partner,thisPattern,realAv,imagAv)</span></div>
<div class="line"><span class="lineno">  156</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  157</span>    {</div>
<div class="line"><span class="lineno">  158</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  159</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  160</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div>
<div class="line"><span class="lineno">  162</span>            thisPattern = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div>
<div class="line"><span class="lineno">  163</span>            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div>
<div class="line"><span class="lineno">  164</span>                <span class="comment">// do dephase</span></div>
<div class="line"><span class="lineno">  165</span>                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div>
<div class="line"><span class="lineno">  166</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div>
<div class="line"><span class="lineno">  167</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div>
<div class="line"><span class="lineno">  168</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  169</span>                <span class="keywordflow">if</span> ((thisTask&amp;totMask)==0){ <span class="comment">//this element relates to targetQubit in state 0</span></div>
<div class="line"><span class="lineno">  170</span>                    <span class="comment">// do depolarise</span></div>
<div class="line"><span class="lineno">  171</span>                    partner = thisTask | totMask;</div>
<div class="line"><span class="lineno">  172</span>                    realAv =  (qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] + qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner]) /2 ;</div>
<div class="line"><span class="lineno">  173</span>                    imagAv =  (qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] + qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner]) /2 ;</div>
<div class="line"><span class="lineno">  174</span>                    </div>
<div class="line"><span class="lineno">  175</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] + depolLevel*realAv;</div>
<div class="line"><span class="lineno">  176</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] + depolLevel*imagAv;</div>
<div class="line"><span class="lineno">  177</span>                    </div>
<div class="line"><span class="lineno">  178</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + depolLevel*realAv;</div>
<div class="line"><span class="lineno">  179</span>                    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + depolLevel*imagAv;</div>
<div class="line"><span class="lineno">  180</span>                }</div>
<div class="line"><span class="lineno">  181</span>            }</div>
<div class="line"><span class="lineno">  182</span>        }  </div>
<div class="line"><span class="lineno">  183</span>    }</div>
<div class="line"><span class="lineno">  184</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00714">densmatr_mixDepolarising()</a>.</p>

</div>
</div>
<a id="a623e577b7230f3c8dc202be6185b4289" name="a623e577b7230f3c8dc202be6185b4289"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a623e577b7230f3c8dc202be6185b4289">&#9670;&#160;</a></span>densmatr_mixTwoQubitDephasing()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDephasing </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>dephase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00096">96</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   96</span>                                                                                       {</div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> retain=1-dephase;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1 = 1LL &lt;&lt; (qubit1 + (qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + (qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1|outerMaskQubit1;</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2|outerMaskQubit2;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  111</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  112</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  113</span><span class="preprocessor">    shared   (innerMaskQubit1,outerMaskQubit1,totMaskQubit1,innerMaskQubit2,outerMaskQubit2, \</span></div>
<div class="line"><span class="lineno">  114</span><span class="preprocessor">                totMaskQubit2,qureg,retain,numTasks) \</span></div>
<div class="line"><span class="lineno">  115</span><span class="preprocessor">    private  (thisTask,thisPatternQubit1,thisPatternQubit2)</span></div>
<div class="line"><span class="lineno">  116</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  117</span>    {</div>
<div class="line"><span class="lineno">  118</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  119</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  120</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  121</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div>
<div class="line"><span class="lineno">  122</span>            thisPatternQubit1 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div>
<div class="line"><span class="lineno">  123</span>            thisPatternQubit2 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div>
<div class="line"><span class="lineno">  124</span>            </div>
<div class="line"><span class="lineno">  125</span>            <span class="comment">// any mismatch |...0...&gt;&lt;...1...| etc</span></div>
<div class="line"><span class="lineno">  126</span>            <span class="keywordflow">if</span> ( (thisPatternQubit1==innerMaskQubit1) || (thisPatternQubit1==outerMaskQubit1) || </div>
<div class="line"><span class="lineno">  127</span>                    (thisPatternQubit2==innerMaskQubit2) || (thisPatternQubit2==outerMaskQubit2) ){ </div>
<div class="line"><span class="lineno">  128</span>                <span class="comment">// do dephase</span></div>
<div class="line"><span class="lineno">  129</span>                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div>
<div class="line"><span class="lineno">  130</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div>
<div class="line"><span class="lineno">  131</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div>
<div class="line"><span class="lineno">  132</span>            } </div>
<div class="line"><span class="lineno">  133</span>        }  </div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f76ec8f08e19bb8e1254aafb10e160e" name="a2f76ec8f08e19bb8e1254aafb10e160e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f76ec8f08e19bb8e1254aafb10e160e">&#9670;&#160;</a></span>densmatr_mixTwoQubitDepolarisingDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00553">553</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  554</span>                                              {</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ1, sizeInnerHalfBlockQ1;</div>
<div class="line"><span class="lineno">  557</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ2, sizeInnerHalfBlockQ2, sizeInnerQuarterBlockQ2;</div>
<div class="line"><span class="lineno">  558</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterQuarterColumn;</div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlockQ2,</div>
<div class="line"><span class="lineno">  560</span>         thisOuterColumn, <span class="comment">// current column in density matrix</span></div>
<div class="line"><span class="lineno">  561</span>         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div>
<div class="line"><span class="lineno">  562</span>         thisIndexInOuterColumn,</div>
<div class="line"><span class="lineno">  563</span>         thisIndexInInnerBlockQ1, </div>
<div class="line"><span class="lineno">  564</span>         thisIndexInInnerBlockQ2, </div>
<div class="line"><span class="lineno">  565</span>         thisInnerBlockQ1InInnerBlockQ2;</div>
<div class="line"><span class="lineno">  566</span>    <span class="keywordtype">int</span> outerBitQ1, outerBitQ2; </div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno">  569</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;2;</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno">  572</span>    sizeInnerHalfBlockQ1 = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno">  573</span>    sizeInnerHalfBlockQ2 = 1LL &lt;&lt; qubit2;  </div>
<div class="line"><span class="lineno">  574</span>    sizeInnerQuarterBlockQ2 = sizeInnerHalfBlockQ2 &gt;&gt; 1;  </div>
<div class="line"><span class="lineno">  575</span>    sizeInnerBlockQ2 = sizeInnerHalfBlockQ2 &lt;&lt; 1;  </div>
<div class="line"><span class="lineno">  576</span>    sizeInnerBlockQ1 = 2LL * sizeInnerHalfBlockQ1; </div>
<div class="line"><span class="lineno">  577</span>    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div>
<div class="line"><span class="lineno">  578</span>    sizeOuterQuarterColumn = sizeOuterColumn &gt;&gt; 2;</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  581</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  582</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  583</span><span class="preprocessor">    shared   (sizeInnerBlockQ1,sizeInnerHalfBlockQ1,sizeInnerBlockQ2,sizeInnerHalfBlockQ2,sizeInnerQuarterBlockQ2,\</span></div>
<div class="line"><span class="lineno">  584</span><span class="preprocessor">                sizeOuterColumn,sizeOuterQuarterColumn,qureg,delta,gamma,numTasks,targetQubit,qubit2) \</span></div>
<div class="line"><span class="lineno">  585</span><span class="preprocessor">    private  (thisTask,thisInnerBlockQ2,thisInnerBlockQ1InInnerBlockQ2, \</span></div>
<div class="line"><span class="lineno">  586</span><span class="preprocessor">                thisOuterColumn,thisIndex,thisIndexInOuterColumn, \</span></div>
<div class="line"><span class="lineno">  587</span><span class="preprocessor">                thisIndexInInnerBlockQ1,thisIndexInInnerBlockQ2,outerBitQ1,outerBitQ2)</span></div>
<div class="line"><span class="lineno">  588</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  589</span>    {</div>
<div class="line"><span class="lineno">  590</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  591</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  592</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  593</span>        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div>
<div class="line"><span class="lineno">  594</span>        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div>
<div class="line"><span class="lineno">  595</span>        <span class="comment">// within one column.</span></div>
<div class="line"><span class="lineno">  596</span>        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div>
<div class="line"><span class="lineno">  597</span>        <span class="comment">// outer block or less</span></div>
<div class="line"><span class="lineno">  598</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno">  599</span>            <span class="comment">// we want to process all columns in the density matrix,</span></div>
<div class="line"><span class="lineno">  600</span>            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div>
<div class="line"><span class="lineno">  601</span>            thisOuterColumn = thisTask / sizeOuterQuarterColumn;</div>
<div class="line"><span class="lineno">  602</span>            <span class="comment">// thisTask % sizeOuterQuarterColumn</span></div>
<div class="line"><span class="lineno">  603</span>            thisIndexInOuterColumn = thisTask&amp;(sizeOuterQuarterColumn-1); </div>
<div class="line"><span class="lineno">  604</span>            thisInnerBlockQ2 = thisIndexInOuterColumn / sizeInnerQuarterBlockQ2;</div>
<div class="line"><span class="lineno">  605</span>            <span class="comment">// thisTask % sizeInnerQuarterBlockQ2;</span></div>
<div class="line"><span class="lineno">  606</span>            thisIndexInInnerBlockQ2 = thisTask&amp;(sizeInnerQuarterBlockQ2-1);</div>
<div class="line"><span class="lineno">  607</span>            thisInnerBlockQ1InInnerBlockQ2 = thisIndexInInnerBlockQ2 / sizeInnerHalfBlockQ1;</div>
<div class="line"><span class="lineno">  608</span>            <span class="comment">// thisTask % sizeInnerHalfBlockQ1;</span></div>
<div class="line"><span class="lineno">  609</span>            thisIndexInInnerBlockQ1 = thisTask&amp;(sizeInnerHalfBlockQ1-1);</div>
<div class="line"><span class="lineno">  610</span> </div>
<div class="line"><span class="lineno">  611</span>            <span class="comment">// get index in state vector corresponding to upper inner block</span></div>
<div class="line"><span class="lineno">  612</span>            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlockQ2*sizeInnerBlockQ2 </div>
<div class="line"><span class="lineno">  613</span>                + thisInnerBlockQ1InInnerBlockQ2*sizeInnerBlockQ1 + thisIndexInInnerBlockQ1;</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>            <span class="comment">// check if we are in the upper or lower half of an outer block for Q1</span></div>
<div class="line"><span class="lineno">  616</span>            outerBitQ1 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  617</span>            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div>
<div class="line"><span class="lineno">  618</span>            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div>
<div class="line"><span class="lineno">  619</span>            thisIndex += outerBitQ1*(sizeInnerHalfBlockQ1);</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>            <span class="comment">// check if we are in the upper or lower half of an outer block for Q2</span></div>
<div class="line"><span class="lineno">  622</span>            outerBitQ2 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubit2, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  623</span>            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div>
<div class="line"><span class="lineno">  624</span>            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div>
<div class="line"><span class="lineno">  625</span>            thisIndex += outerBitQ2*(sizeInnerQuarterBlockQ2&lt;&lt;1);</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div>
<div class="line"><span class="lineno">  628</span>            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div>
<div class="line"><span class="lineno">  629</span>            <span class="comment">// density matrix representation. </span></div>
<div class="line"><span class="lineno">  630</span>            <span class="comment">// thisTask is the index of the pair element in pairStateVec</span></div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span>           </div>
<div class="line"><span class="lineno">  633</span>            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div>
<div class="line"><span class="lineno">  634</span>            <span class="comment">//      + pair[thisTask])/2</span></div>
<div class="line"><span class="lineno">  635</span>            <span class="comment">// NOTE: must set gamma=1 if using this function for steps 1 or 2</span></div>
<div class="line"><span class="lineno">  636</span>            qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = gamma*(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div>
<div class="line"><span class="lineno">  637</span>                    delta*qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisTask]);</div>
<div class="line"><span class="lineno">  638</span>            qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = gamma*(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div>
<div class="line"><span class="lineno">  639</span>                    delta*qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisTask]);</div>
<div class="line"><span class="lineno">  640</span>        } </div>
<div class="line"><span class="lineno">  641</span>    }    </div>
<div class="line"><span class="lineno">  642</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00768">densmatr_mixTwoQubitDepolarising()</a>.</p>

</div>
</div>
<a id="a3510f01d4d15dcc545564eb84c668cad" name="a3510f01d4d15dcc545564eb84c668cad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3510f01d4d15dcc545564eb84c668cad">&#9670;&#160;</a></span>densmatr_mixTwoQubitDepolarisingLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00399">399</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  399</span>                                                                                                          {</div>
<div class="line"><span class="lineno">  400</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  401</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div>
<div class="line"><span class="lineno">  402</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1= 1LL &lt;&lt; (qubit1 + qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  403</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1 | outerMaskQubit1;</div>
<div class="line"><span class="lineno">  404</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div>
<div class="line"><span class="lineno">  405</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2 | outerMaskQubit2;</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> real00, imag00;</div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  415</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  416</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  417</span><span class="preprocessor">    shared   (totMaskQubit1,totMaskQubit2,qureg,delta,gamma,numTasks) \</span></div>
<div class="line"><span class="lineno">  418</span><span class="preprocessor">    private  (thisTask,partner,thisPatternQubit1,thisPatternQubit2,real00,imag00)</span></div>
<div class="line"><span class="lineno">  419</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  420</span>    {</div>
<div class="line"><span class="lineno">  421</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  422</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  423</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  424</span>        <span class="comment">//--------------------------------------- STEP ONE ---------------------</span></div>
<div class="line"><span class="lineno">  425</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ </div>
<div class="line"><span class="lineno">  426</span>            thisPatternQubit1 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div>
<div class="line"><span class="lineno">  427</span>            thisPatternQubit2 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div>
<div class="line"><span class="lineno">  428</span>            <span class="keywordflow">if</span> ((thisPatternQubit1==0) &amp;&amp; ((thisPatternQubit2==0) </div>
<div class="line"><span class="lineno">  429</span>                        || (thisPatternQubit2==totMaskQubit2))){ </div>
<div class="line"><span class="lineno">  430</span>                <span class="comment">//this element of form |...X...0...&gt;&lt;...X...0...|  for X either 0 or 1.</span></div>
<div class="line"><span class="lineno">  431</span>                partner = thisTask | totMaskQubit1;</div>
<div class="line"><span class="lineno">  432</span>                real00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div>
<div class="line"><span class="lineno">  433</span>                imag00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div>
<div class="line"><span class="lineno">  434</span>                    </div>
<div class="line"><span class="lineno">  435</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div>
<div class="line"><span class="lineno">  436</span>                    + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div>
<div class="line"><span class="lineno">  437</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div>
<div class="line"><span class="lineno">  438</span>                    + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div>
<div class="line"><span class="lineno">  439</span>                    </div>
<div class="line"><span class="lineno">  440</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + delta*real00;</div>
<div class="line"><span class="lineno">  441</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + delta*imag00;</div>
<div class="line"><span class="lineno">  442</span>                                </div>
<div class="line"><span class="lineno">  443</span>            }</div>
<div class="line"><span class="lineno">  444</span>        }</div>
<div class="line"><span class="lineno">  445</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  446</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  447</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  448</span>        <span class="comment">//--------------------------------------- STEP TWO ---------------------</span></div>
<div class="line"><span class="lineno">  449</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ </div>
<div class="line"><span class="lineno">  450</span>            thisPatternQubit1 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div>
<div class="line"><span class="lineno">  451</span>            thisPatternQubit2 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div>
<div class="line"><span class="lineno">  452</span>            <span class="keywordflow">if</span> ((thisPatternQubit2==0) &amp;&amp; ((thisPatternQubit1==0) </div>
<div class="line"><span class="lineno">  453</span>                        || (thisPatternQubit1==totMaskQubit1))){ </div>
<div class="line"><span class="lineno">  454</span>                <span class="comment">//this element of form |...0...X...&gt;&lt;...0...X...|  for X either 0 or 1.</span></div>
<div class="line"><span class="lineno">  455</span>                partner = thisTask | totMaskQubit2;</div>
<div class="line"><span class="lineno">  456</span>                real00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div>
<div class="line"><span class="lineno">  457</span>                imag00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div>
<div class="line"><span class="lineno">  458</span>                    </div>
<div class="line"><span class="lineno">  459</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div>
<div class="line"><span class="lineno">  460</span>                    + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div>
<div class="line"><span class="lineno">  461</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div>
<div class="line"><span class="lineno">  462</span>                    + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div>
<div class="line"><span class="lineno">  463</span>                    </div>
<div class="line"><span class="lineno">  464</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + delta*real00;</div>
<div class="line"><span class="lineno">  465</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + delta*imag00;</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>            }</div>
<div class="line"><span class="lineno">  468</span>        }</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  471</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  472</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  473</span>        <span class="comment">//--------------------------------------- STEP THREE ---------------------</span></div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){ </div>
<div class="line"><span class="lineno">  475</span>            thisPatternQubit1 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div>
<div class="line"><span class="lineno">  476</span>            thisPatternQubit2 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div>
<div class="line"><span class="lineno">  477</span>            <span class="keywordflow">if</span> ((thisPatternQubit2==0) &amp;&amp; ((thisPatternQubit1==0) </div>
<div class="line"><span class="lineno">  478</span>                        || (thisPatternQubit1==totMaskQubit1))){ </div>
<div class="line"><span class="lineno">  479</span>                <span class="comment">//this element of form |...0...X...&gt;&lt;...0...X...|  for X either 0 or 1.</span></div>
<div class="line"><span class="lineno">  480</span>                partner = thisTask | totMaskQubit2;</div>
<div class="line"><span class="lineno">  481</span>                partner = partner ^ totMaskQubit1;</div>
<div class="line"><span class="lineno">  482</span>                real00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div>
<div class="line"><span class="lineno">  483</span>                imag00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div>
<div class="line"><span class="lineno">  484</span> </div>
<div class="line"><span class="lineno">  485</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = gamma * (qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div>
<div class="line"><span class="lineno">  486</span>                        + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner]);</div>
<div class="line"><span class="lineno">  487</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = gamma * (qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div>
<div class="line"><span class="lineno">  488</span>                        + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner]);</div>
<div class="line"><span class="lineno">  489</span>                    </div>
<div class="line"><span class="lineno">  490</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = gamma * (qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] </div>
<div class="line"><span class="lineno">  491</span>                        + delta*real00);</div>
<div class="line"><span class="lineno">  492</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = gamma * (qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] </div>
<div class="line"><span class="lineno">  493</span>                        + delta*imag00);</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>            }</div>
<div class="line"><span class="lineno">  496</span>        }</div>
<div class="line"><span class="lineno">  497</span>    }</div>
<div class="line"><span class="lineno">  498</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00768">densmatr_mixTwoQubitDepolarising()</a>.</p>

</div>
</div>
<a id="ae90f82418e0aa67218d733dbbc681998" name="ae90f82418e0aa67218d733dbbc681998"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae90f82418e0aa67218d733dbbc681998">&#9670;&#160;</a></span>densmatr_mixTwoQubitDepolarisingLocalPart1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingLocalPart1 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00500">500</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  500</span>                                                                                                  {</div>
<div class="line"><span class="lineno">  501</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">  502</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit1 = 1LL &lt;&lt; qubit1;</div>
<div class="line"><span class="lineno">  503</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit1= 1LL &lt;&lt; (qubit1 + qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit1 = innerMaskQubit1 | outerMaskQubit1;</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMaskQubit2 = 1LL &lt;&lt; qubit2;</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMaskQubit2 = 1LL &lt;&lt; (qubit2 + qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  507</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMaskQubit2 = innerMaskQubit2 | outerMaskQubit2;</div>
<div class="line"><span class="lineno">  508</span>    <span class="comment">// correct for being in a particular chunk</span></div>
<div class="line"><span class="lineno">  509</span>    <span class="comment">//totMaskQubit2 = totMaskQubit2&amp;(qureg.numAmpsPerChunk-1); // totMaskQubit2 % numAmpsPerChunk</span></div>
<div class="line"><span class="lineno">  510</span>    </div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno">  513</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> partner;</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPatternQubit1, thisPatternQubit2;</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> real00, imag00;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  519</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  520</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  521</span><span class="preprocessor">    shared   (totMaskQubit1,totMaskQubit2,qureg,delta,numTasks) \</span></div>
<div class="line"><span class="lineno">  522</span><span class="preprocessor">    private  (thisTask,partner,thisPatternQubit1,thisPatternQubit2,real00,imag00)</span></div>
<div class="line"><span class="lineno">  523</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  524</span>    {</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  527</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  528</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  529</span>        <span class="comment">//--------------------------------------- STEP ONE ---------------------</span></div>
<div class="line"><span class="lineno">  530</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask ++){ </div>
<div class="line"><span class="lineno">  531</span>            thisPatternQubit1 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit1;</div>
<div class="line"><span class="lineno">  532</span>            thisPatternQubit2 = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMaskQubit2;</div>
<div class="line"><span class="lineno">  533</span>            <span class="keywordflow">if</span> ((thisPatternQubit1==0) &amp;&amp; ((thisPatternQubit2==0) </div>
<div class="line"><span class="lineno">  534</span>                        || (thisPatternQubit2==totMaskQubit2))){ </div>
<div class="line"><span class="lineno">  535</span>                <span class="comment">//this element of form |...X...0...&gt;&lt;...X...0...|  for X either 0 or 1.</span></div>
<div class="line"><span class="lineno">  536</span>                partner = thisTask | totMaskQubit1;</div>
<div class="line"><span class="lineno">  537</span>                real00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask];</div>
<div class="line"><span class="lineno">  538</span>                imag00 =  qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask];</div>
<div class="line"><span class="lineno">  539</span>                    </div>
<div class="line"><span class="lineno">  540</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] </div>
<div class="line"><span class="lineno">  541</span>                    + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner];</div>
<div class="line"><span class="lineno">  542</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] </div>
<div class="line"><span class="lineno">  543</span>                    + delta*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner];</div>
<div class="line"><span class="lineno">  544</span>                    </div>
<div class="line"><span class="lineno">  545</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[partner] + delta*real00;</div>
<div class="line"><span class="lineno">  546</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[partner] + delta*imag00;</div>
<div class="line"><span class="lineno">  547</span>                                </div>
<div class="line"><span class="lineno">  548</span>            }</div>
<div class="line"><span class="lineno">  549</span>        }</div>
<div class="line"><span class="lineno">  550</span>    }</div>
<div class="line"><span class="lineno">  551</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00768">densmatr_mixTwoQubitDepolarising()</a>.</p>

</div>
</div>
<a id="acabdfbd3184d3ab3bded61e24142b800" name="acabdfbd3184d3ab3bded61e24142b800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acabdfbd3184d3ab3bded61e24142b800">&#9670;&#160;</a></span>densmatr_mixTwoQubitDepolarisingQ1LocalQ2DistributedPart3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_mixTwoQubitDepolarisingQ1LocalQ2DistributedPart3 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>gamma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00644">644</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>                                              {</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ1, sizeInnerHalfBlockQ1;</div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeInnerBlockQ2, sizeInnerHalfBlockQ2, sizeInnerQuarterBlockQ2;</div>
<div class="line"><span class="lineno">  649</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeOuterColumn, sizeOuterQuarterColumn;</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInnerBlockQ2,</div>
<div class="line"><span class="lineno">  651</span>         thisOuterColumn, <span class="comment">// current column in density matrix</span></div>
<div class="line"><span class="lineno">  652</span>         thisIndex,    <span class="comment">// current index in (density matrix representation) state vector</span></div>
<div class="line"><span class="lineno">  653</span>         thisIndexInPairVector,</div>
<div class="line"><span class="lineno">  654</span>         thisIndexInOuterColumn,</div>
<div class="line"><span class="lineno">  655</span>         thisIndexInInnerBlockQ1, </div>
<div class="line"><span class="lineno">  656</span>         thisIndexInInnerBlockQ2, </div>
<div class="line"><span class="lineno">  657</span>         thisInnerBlockQ1InInnerBlockQ2;</div>
<div class="line"><span class="lineno">  658</span>    <span class="keywordtype">int</span> outerBitQ1, outerBitQ2; </div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno">  661</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;2;</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno">  664</span>    sizeInnerHalfBlockQ1 = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno">  665</span>    sizeInnerHalfBlockQ2 = 1LL &lt;&lt; qubit2;  </div>
<div class="line"><span class="lineno">  666</span>    sizeInnerQuarterBlockQ2 = sizeInnerHalfBlockQ2 &gt;&gt; 1;  </div>
<div class="line"><span class="lineno">  667</span>    sizeInnerBlockQ2 = sizeInnerHalfBlockQ2 &lt;&lt; 1;  </div>
<div class="line"><span class="lineno">  668</span>    sizeInnerBlockQ1 = 2LL * sizeInnerHalfBlockQ1; </div>
<div class="line"><span class="lineno">  669</span>    sizeOuterColumn = 1LL &lt;&lt; qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>;</div>
<div class="line"><span class="lineno">  670</span>    sizeOuterQuarterColumn = sizeOuterColumn &gt;&gt; 2;</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span><span class="comment">//# if 0</span></div>
<div class="line"><span class="lineno">  673</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  674</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">  675</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">  676</span><span class="preprocessor">    shared   (sizeInnerBlockQ1,sizeInnerHalfBlockQ1,sizeInnerBlockQ2,sizeInnerHalfBlockQ2,sizeInnerQuarterBlockQ2,\</span></div>
<div class="line"><span class="lineno">  677</span><span class="preprocessor">                sizeOuterColumn,sizeOuterQuarterColumn,qureg,delta,gamma, numTasks,targetQubit,qubit2) \</span></div>
<div class="line"><span class="lineno">  678</span><span class="preprocessor">    private  (thisTask,thisInnerBlockQ2,thisInnerBlockQ1InInnerBlockQ2, \</span></div>
<div class="line"><span class="lineno">  679</span><span class="preprocessor">                thisOuterColumn,thisIndex,thisIndexInPairVector,thisIndexInOuterColumn, \</span></div>
<div class="line"><span class="lineno">  680</span><span class="preprocessor">                thisIndexInInnerBlockQ1,thisIndexInInnerBlockQ2,outerBitQ1,outerBitQ2)</span></div>
<div class="line"><span class="lineno">  681</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  682</span>    {</div>
<div class="line"><span class="lineno">  683</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  684</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">  685</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  686</span><span class="comment">//# endif</span></div>
<div class="line"><span class="lineno">  687</span>        <span class="comment">// thisTask iterates over half the elements in this process&#39; chunk of the density matrix</span></div>
<div class="line"><span class="lineno">  688</span>        <span class="comment">// treat this as iterating over all columns, then iterating over half the values</span></div>
<div class="line"><span class="lineno">  689</span>        <span class="comment">// within one column.</span></div>
<div class="line"><span class="lineno">  690</span>        <span class="comment">// If this function has been called, this process&#39; chunk contains half an </span></div>
<div class="line"><span class="lineno">  691</span>        <span class="comment">// outer block or less</span></div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno">  693</span>            <span class="comment">// we want to process all columns in the density matrix,</span></div>
<div class="line"><span class="lineno">  694</span>            <span class="comment">// updating the values for half of each column (one half of each inner block)</span></div>
<div class="line"><span class="lineno">  695</span>            thisOuterColumn = thisTask / sizeOuterQuarterColumn;</div>
<div class="line"><span class="lineno">  696</span>            <span class="comment">// thisTask % sizeOuterQuarterColumn</span></div>
<div class="line"><span class="lineno">  697</span>            thisIndexInOuterColumn = thisTask&amp;(sizeOuterQuarterColumn-1); </div>
<div class="line"><span class="lineno">  698</span>            thisInnerBlockQ2 = thisIndexInOuterColumn / sizeInnerQuarterBlockQ2;</div>
<div class="line"><span class="lineno">  699</span>            <span class="comment">// thisTask % sizeInnerQuarterBlockQ2;</span></div>
<div class="line"><span class="lineno">  700</span>            thisIndexInInnerBlockQ2 = thisTask&amp;(sizeInnerQuarterBlockQ2-1);</div>
<div class="line"><span class="lineno">  701</span>            thisInnerBlockQ1InInnerBlockQ2 = thisIndexInInnerBlockQ2 / sizeInnerHalfBlockQ1;</div>
<div class="line"><span class="lineno">  702</span>            <span class="comment">// thisTask % sizeInnerHalfBlockQ1;</span></div>
<div class="line"><span class="lineno">  703</span>            thisIndexInInnerBlockQ1 = thisTask&amp;(sizeInnerHalfBlockQ1-1);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>            <span class="comment">// get index in state vector corresponding to upper inner block</span></div>
<div class="line"><span class="lineno">  706</span>            thisIndex = thisOuterColumn*sizeOuterColumn + thisInnerBlockQ2*sizeInnerBlockQ2 </div>
<div class="line"><span class="lineno">  707</span>                + thisInnerBlockQ1InInnerBlockQ2*sizeInnerBlockQ1 + thisIndexInInnerBlockQ1;</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>            <span class="comment">// check if we are in the upper or lower half of an outer block for Q1</span></div>
<div class="line"><span class="lineno">  710</span>            outerBitQ1 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(targetQubit, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  711</span>            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div>
<div class="line"><span class="lineno">  712</span>            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div>
<div class="line"><span class="lineno">  713</span>            thisIndex += outerBitQ1*(sizeInnerHalfBlockQ1);</div>
<div class="line"><span class="lineno">  714</span>            </div>
<div class="line"><span class="lineno">  715</span>            <span class="comment">// For part 3 we need to match elements such that (my Q1 != pair Q1) AND (my Q2 != pair Q2)</span></div>
<div class="line"><span class="lineno">  716</span>            <span class="comment">// Find correct index in pairStateVector</span></div>
<div class="line"><span class="lineno">  717</span>            thisIndexInPairVector = thisTask + (1-outerBitQ1)*sizeInnerHalfBlockQ1*sizeOuterQuarterColumn -</div>
<div class="line"><span class="lineno">  718</span>                outerBitQ1*sizeInnerHalfBlockQ1*sizeOuterQuarterColumn;</div>
<div class="line"><span class="lineno">  719</span>            </div>
<div class="line"><span class="lineno">  720</span>            <span class="comment">// check if we are in the upper or lower half of an outer block for Q2</span></div>
<div class="line"><span class="lineno">  721</span>            outerBitQ2 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubit2, (thisIndex+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&gt;&gt;qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>);</div>
<div class="line"><span class="lineno">  722</span>            <span class="comment">// if we are in the lower half of an outer block, shift to be in the lower half</span></div>
<div class="line"><span class="lineno">  723</span>            <span class="comment">// of the inner block as well (we want to dephase |0&gt;&lt;0| and |1&gt;&lt;1| only)</span></div>
<div class="line"><span class="lineno">  724</span>            thisIndex += outerBitQ2*(sizeInnerQuarterBlockQ2&lt;&lt;1);</div>
<div class="line"><span class="lineno">  725</span>            </div>
<div class="line"><span class="lineno">  726</span>            </div>
<div class="line"><span class="lineno">  727</span>            <span class="comment">// NOTE: at this point thisIndex should be the index of the element we want to </span></div>
<div class="line"><span class="lineno">  728</span>            <span class="comment">// dephase in the chunk of the state vector on this process, in the </span></div>
<div class="line"><span class="lineno">  729</span>            <span class="comment">// density matrix representation. </span></div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>           </div>
<div class="line"><span class="lineno">  732</span>            <span class="comment">// state[thisIndex] = (1-depolLevel)*state[thisIndex] + depolLevel*(state[thisIndex]</span></div>
<div class="line"><span class="lineno">  733</span>            <span class="comment">//      + pair[thisIndexInPairVector])/2</span></div>
<div class="line"><span class="lineno">  734</span>            qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] = gamma*(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisIndex] +</div>
<div class="line"><span class="lineno">  735</span>                    delta*qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real[thisIndexInPairVector]);</div>
<div class="line"><span class="lineno">  736</span>            </div>
<div class="line"><span class="lineno">  737</span>            qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] = gamma*(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisIndex] +</div>
<div class="line"><span class="lineno">  738</span>                    delta*qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag[thisIndexInPairVector]);</div>
<div class="line"><span class="lineno">  739</span>        } </div>
<div class="line"><span class="lineno">  740</span>    }    </div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00768">densmatr_mixTwoQubitDepolarising()</a>.</p>

</div>
</div>
<a id="a717a0448066831cb5b392bcf2e1d0529" name="a717a0448066831cb5b392bcf2e1d0529"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a717a0448066831cb5b392bcf2e1d0529">&#9670;&#160;</a></span>densmatr_oneQubitDegradeOffDiagonal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_oneQubitDegradeOffDiagonal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>retain</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00060">60</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   60</span>                                                                                    {</div>
<div class="line"><span class="lineno">   61</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> innerMask = 1LL &lt;&lt; targetQubit;</div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outerMask = 1LL &lt;&lt; (targetQubit + (qureg.<a class="code hl_variable" href="structQureg.html#ad08dff5316b8937f4b2a1417591543dc">numQubitsRepresented</a>));</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno">   66</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisPattern;</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> totMask = innerMask|outerMask;</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">   70</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno">   71</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno">   72</span><span class="preprocessor">    shared   (innerMask,outerMask,totMask,qureg,retain,numTasks, targetQubit) \</span></div>
<div class="line"><span class="lineno">   73</span><span class="preprocessor">    private  (thisTask,thisPattern)</span></div>
<div class="line"><span class="lineno">   74</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">   75</span>    {</div>
<div class="line"><span class="lineno">   76</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">   77</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno">   78</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">   79</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++){</div>
<div class="line"><span class="lineno">   80</span>            thisPattern = (thisTask+qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>*qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>)&amp;totMask;</div>
<div class="line"><span class="lineno">   81</span>            <span class="keywordflow">if</span> ((thisPattern==innerMask) || (thisPattern==outerMask)){</div>
<div class="line"><span class="lineno">   82</span>                <span class="comment">// do dephase</span></div>
<div class="line"><span class="lineno">   83</span>                <span class="comment">// the lines below will degrade the off-diagonal terms |..0..&gt;&lt;..1..| and |..1..&gt;&lt;..0..|</span></div>
<div class="line"><span class="lineno">   84</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[thisTask]; </div>
<div class="line"><span class="lineno">   85</span>                qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask] = retain*qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[thisTask]; </div>
<div class="line"><span class="lineno">   86</span>            } </div>
<div class="line"><span class="lineno">   87</span>        }  </div>
<div class="line"><span class="lineno">   88</span>    }</div>
<div class="line"><span class="lineno">   89</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00348">Qureg::numQubitsRepresented</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00312">densmatr_mixDampingDistributed()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00091">densmatr_mixDephasing()</a>.</p>

</div>
</div>
<a id="ada7c52e0f109047f86a26bce86ab679f" name="ada7c52e0f109047f86a26bce86ab679f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada7c52e0f109047f86a26bce86ab679f">&#9670;&#160;</a></span>densmatr_setQuregToPauliHamil()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void densmatr_setQuregToPauliHamil </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPauliHamil.html">PauliHamil</a>&#160;</td>
          <td class="paramname"><em>hamil</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04646">4646</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4646</span>                                                                  {</div>
<div class="line"><span class="lineno"> 4647</span> </div>
<div class="line"><span class="lineno"> 4648</span>    <span class="comment">// flattened {I,X,Y,Z} matrix elements, where [k] = [p][i][j]</span></div>
<div class="line"><span class="lineno"> 4649</span>    <span class="keywordtype">int</span> pauliRealElems[] = {   1,0, 0,1,   0,1, 1,0,   0,0, 0,0,   1,0, 0,-1  };</div>
<div class="line"><span class="lineno"> 4650</span>    <span class="keywordtype">int</span> pauliImagElems[] = {   0,0, 0,0,   0,0, 0,0,   0,-1,1,0,   0,0, 0,0   };</div>
<div class="line"><span class="lineno"> 4651</span>    </div>
<div class="line"><span class="lineno"> 4652</span>    <span class="comment">// constants (unpacked to prevent OpenMP struct tantrum)</span></div>
<div class="line"><span class="lineno"> 4653</span>    <span class="keywordtype">int</span> numTerms = hamil.<a class="code hl_variable" href="structPauliHamil.html#a737e46b40ef8990cf004d22eb9dbe2e4">numSumTerms</a>;</div>
<div class="line"><span class="lineno"> 4654</span>    <span class="keywordtype">int</span> numQubits = hamil.<a class="code hl_variable" href="structPauliHamil.html#acb49fff0e3160ea1904c9ca34408b4e1">numQubits</a>;</div>
<div class="line"><span class="lineno"> 4655</span>    <span class="keyword">enum</span> <a class="code hl_enumeration" href="group__type.html#ga1c703cf89629e4e9c7023cd402d67028">pauliOpType</a>* paulis = hamil.<a class="code hl_variable" href="structPauliHamil.html#a4b8d38c403553c07ceddcd40c46ce6c8">pauliCodes</a>;</div>
<div class="line"><span class="lineno"> 4656</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* termCoeffs = hamil.<a class="code hl_variable" href="structPauliHamil.html#ac1c6c9f6299cf83bbba88123216c3cac">termCoeffs</a>;</div>
<div class="line"><span class="lineno"> 4657</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4658</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4659</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numLocAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4660</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> nOffset = numLocAmps * qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 4661</span>    </div>
<div class="line"><span class="lineno"> 4662</span>    <span class="comment">// private threading vars</span></div>
<div class="line"><span class="lineno"> 4663</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> n, nGlob, r, c, t, pInd;</div>
<div class="line"><span class="lineno"> 4664</span>    <span class="keywordtype">int</span> q, i, j, p, k;</div>
<div class="line"><span class="lineno"> 4665</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> elemRe, elemIm;</div>
<div class="line"><span class="lineno"> 4666</span>    <span class="keywordtype">int</span> kronRe, kronIm;</div>
<div class="line"><span class="lineno"> 4667</span>    <span class="keywordtype">int</span> pauliRe, pauliIm, tmp;</div>
<div class="line"><span class="lineno"> 4668</span>    </div>
<div class="line"><span class="lineno"> 4669</span>    <span class="comment">// use a private thread for every overwritten amplitude</span></div>
<div class="line"><span class="lineno"> 4670</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4671</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4672</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 4673</span><span class="preprocessor">    shared   (pauliRealElems,pauliImagElems, numTerms,numQubits,numLocAmps,nOffset,  paulis,termCoeffs, stateRe,stateIm) \</span></div>
<div class="line"><span class="lineno"> 4674</span><span class="preprocessor">    private  (q,i,j,p,k, r,c,n,nGlob,t,pInd, elemRe,elemIm, kronRe,kronIm, pauliRe,pauliIm, tmp)</span></div>
<div class="line"><span class="lineno"> 4675</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4676</span>    {</div>
<div class="line"><span class="lineno"> 4677</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4678</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 4679</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4680</span>        <span class="keywordflow">for</span> (n=0; n&lt;numLocAmps; n++) {</div>
<div class="line"><span class="lineno"> 4681</span>            </div>
<div class="line"><span class="lineno"> 4682</span>            <span class="comment">// |nGlob&gt; = |rank&gt;|n&gt;</span></div>
<div class="line"><span class="lineno"> 4683</span>            nGlob = nOffset + n;</div>
<div class="line"><span class="lineno"> 4684</span>            </div>
<div class="line"><span class="lineno"> 4685</span>            <span class="comment">// |nGlob&gt; = |c&gt;|r&gt;</span></div>
<div class="line"><span class="lineno"> 4686</span>            r = nGlob &amp; ((1LL &lt;&lt; numQubits) - 1);</div>
<div class="line"><span class="lineno"> 4687</span>            c = nGlob &gt;&gt; numQubits;</div>
<div class="line"><span class="lineno"> 4688</span> </div>
<div class="line"><span class="lineno"> 4689</span>            <span class="comment">// new amplitude of |n&gt;</span></div>
<div class="line"><span class="lineno"> 4690</span>            elemRe = 0;</div>
<div class="line"><span class="lineno"> 4691</span>            elemIm = 0;</div>
<div class="line"><span class="lineno"> 4692</span>            </div>
<div class="line"><span class="lineno"> 4693</span>            <span class="keywordflow">for</span> (t=0; t&lt;numTerms; t++) {</div>
<div class="line"><span class="lineno"> 4694</span>                </div>
<div class="line"><span class="lineno"> 4695</span>                <span class="comment">// pauliKronecker[r][c] = prod_q Pauli[q][q-th bit of r and c]</span></div>
<div class="line"><span class="lineno"> 4696</span>                kronRe = 1;</div>
<div class="line"><span class="lineno"> 4697</span>                kronIm = 0;</div>
<div class="line"><span class="lineno"> 4698</span>                pInd = numQubits * t;</div>
<div class="line"><span class="lineno"> 4699</span>                </div>
<div class="line"><span class="lineno"> 4700</span>                <span class="keywordflow">for</span> (q=0; q&lt;numQubits; q++) {</div>
<div class="line"><span class="lineno"> 4701</span>                    </div>
<div class="line"><span class="lineno"> 4702</span>                    <span class="comment">// get element of Pauli matrix</span></div>
<div class="line"><span class="lineno"> 4703</span>                    i = (r &gt;&gt; q) &amp; 1;</div>
<div class="line"><span class="lineno"> 4704</span>                    j = (c &gt;&gt; q) &amp; 1;</div>
<div class="line"><span class="lineno"> 4705</span>                    p = (int) paulis[pInd++];</div>
<div class="line"><span class="lineno"> 4706</span>                    k = (p&lt;&lt;2) + (i&lt;&lt;1) + j;</div>
<div class="line"><span class="lineno"> 4707</span>                    pauliRe = pauliRealElems[k]; </div>
<div class="line"><span class="lineno"> 4708</span>                    pauliIm = pauliImagElems[k];</div>
<div class="line"><span class="lineno"> 4709</span>                    </div>
<div class="line"><span class="lineno"> 4710</span>                    <span class="comment">// kron *= pauli</span></div>
<div class="line"><span class="lineno"> 4711</span>                    tmp = (pauliRe*kronRe) - (pauliIm*kronIm);</div>
<div class="line"><span class="lineno"> 4712</span>                    kronIm = (pauliRe*kronIm) + (pauliIm*kronRe);</div>
<div class="line"><span class="lineno"> 4713</span>                    kronRe = tmp;</div>
<div class="line"><span class="lineno"> 4714</span>                }</div>
<div class="line"><span class="lineno"> 4715</span>                </div>
<div class="line"><span class="lineno"> 4716</span>                <span class="comment">// elem = sum_t coeffs[t] pauliKronecker[r][c]</span></div>
<div class="line"><span class="lineno"> 4717</span>                elemRe += termCoeffs[t] * kronRe;</div>
<div class="line"><span class="lineno"> 4718</span>                elemIm += termCoeffs[t] * kronIm;</div>
<div class="line"><span class="lineno"> 4719</span>            }</div>
<div class="line"><span class="lineno"> 4720</span>            </div>
<div class="line"><span class="lineno"> 4721</span>            <span class="comment">// overwrite the density matrix entry</span></div>
<div class="line"><span class="lineno"> 4722</span>            stateRe[n] = elemRe;</div>
<div class="line"><span class="lineno"> 4723</span>            stateIm[n] = elemIm;</div>
<div class="line"><span class="lineno"> 4724</span>        }</div>
<div class="line"><span class="lineno"> 4725</span>    }</div>
<div class="line"><span class="lineno"> 4726</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a37e522505286f17fe6ef74b9f607a5c6" name="a37e522505286f17fe6ef74b9f607a5c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37e522505286f17fe6ef74b9f607a5c6">&#9670;&#160;</a></span>getBitMaskParity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getBitMaskParity </td>
          <td>(</td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>mask</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03338">3338</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3338</span>                                         {</div>
<div class="line"><span class="lineno"> 3339</span>    <span class="keywordtype">int</span> parity = 0;</div>
<div class="line"><span class="lineno"> 3340</span>    <span class="keywordflow">while</span> (mask) {</div>
<div class="line"><span class="lineno"> 3341</span>        parity = !parity;</div>
<div class="line"><span class="lineno"> 3342</span>        mask = mask &amp; (mask-1);</div>
<div class="line"><span class="lineno"> 3343</span>    }</div>
<div class="line"><span class="lineno"> 3344</span>    <span class="keywordflow">return</span> parity;</div>
<div class="line"><span class="lineno"> 3345</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l03389">statevec_multiControlledMultiRotateZ()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l03347">statevec_multiRotateZ()</a>.</p>

</div>
</div>
<a id="a031a99b7e97779f3dc782feffe86e779" name="a031a99b7e97779f3dc782feffe86e779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a031a99b7e97779f3dc782feffe86e779">&#9670;&#160;</a></span>normaliseSomeAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void normaliseSomeAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00756">756</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  756</span>                                                                                               {</div>
<div class="line"><span class="lineno">  757</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  758</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  759</span><span class="preprocessor"># pragma omp parallel for schedule (static)</span></div>
<div class="line"><span class="lineno">  760</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  761</span>    <span class="keywordflow">for</span> (i=startInd; i &lt; startInd+numAmps; i++) {</div>
<div class="line"><span class="lineno">  762</span>        qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] /= norm;</div>
<div class="line"><span class="lineno">  763</span>        qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] /= norm;</div>
<div class="line"><span class="lineno">  764</span>    }</div>
<div class="line"><span class="lineno">  765</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00766">alternateNormZeroingSomeAmpBlocks()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00797">densmatr_collapseToKnownProbOutcome()</a>.</p>

</div>
</div>
<a id="afa4231f79fe9498e4fd87cc70cde5a9d" name="afa4231f79fe9498e4fd87cc70cde5a9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa4231f79fe9498e4fd87cc70cde5a9d">&#9670;&#160;</a></span>qsortComp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qsortComp </td>
          <td>(</td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01939">1939</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1939</span>                                            {</div>
<div class="line"><span class="lineno"> 1940</span>    <span class="keywordflow">return</span> *(<span class="keywordtype">int</span>*)a - *(<span class="keywordtype">int</span>*)b; </div>
<div class="line"><span class="lineno"> 1941</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l01943">statevec_multiControlledMultiQubitUnitaryLocal()</a>.</p>

</div>
</div>
<a id="a27294e3065ebe42a65b3b9e0f85551dd" name="a27294e3065ebe42a65b3b9e0f85551dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27294e3065ebe42a65b3b9e0f85551dd">&#9670;&#160;</a></span>statevec_applyDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_applyDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04078">4078</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4078</span>                                                          {</div>
<div class="line"><span class="lineno"> 4079</span> </div>
<div class="line"><span class="lineno"> 4080</span>    <span class="comment">// each node/chunk modifies only its values in an embarrassingly parallelisable way</span></div>
<div class="line"><span class="lineno"> 4081</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4082</span> </div>
<div class="line"><span class="lineno"> 4083</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4084</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4085</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opRe = op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>;</div>
<div class="line"><span class="lineno"> 4086</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opIm = op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>;</div>
<div class="line"><span class="lineno"> 4087</span> </div>
<div class="line"><span class="lineno"> 4088</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> a,b,c,d;</div>
<div class="line"><span class="lineno"> 4089</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 4090</span> </div>
<div class="line"><span class="lineno"> 4091</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4092</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4093</span><span class="preprocessor">    shared    (stateRe,stateIm, opRe,opIm, numAmps) \</span></div>
<div class="line"><span class="lineno"> 4094</span><span class="preprocessor">    private   (index, a,b,c,d)</span></div>
<div class="line"><span class="lineno"> 4095</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 4096</span>    {</div>
<div class="line"><span class="lineno"> 4097</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4098</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 4099</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4100</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4101</span>            a = stateRe[index];</div>
<div class="line"><span class="lineno"> 4102</span>            b = stateIm[index];</div>
<div class="line"><span class="lineno"> 4103</span>            c = opRe[index];</div>
<div class="line"><span class="lineno"> 4104</span>            d = opIm[index];</div>
<div class="line"><span class="lineno"> 4105</span> </div>
<div class="line"><span class="lineno"> 4106</span>            <span class="comment">// (a + b i)(c + d i) = (a c - b d) + i (a d + b c)</span></div>
<div class="line"><span class="lineno"> 4107</span>            stateRe[index] = a*c - b*d;</div>
<div class="line"><span class="lineno"> 4108</span>            stateIm[index] = a*d + b*c;</div>
<div class="line"><span class="lineno"> 4109</span>        }</div>
<div class="line"><span class="lineno"> 4110</span>    }</div>
<div class="line"><span class="lineno"> 4111</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab33437d10c1ce1c4b034c7c411db553f" name="ab33437d10c1ce1c4b034c7c411db553f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab33437d10c1ce1c4b034c7c411db553f">&#9670;&#160;</a></span>statevec_applyMultiVarPhaseFuncOverrides()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_applyMultiVarPhaseFuncOverrides </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numQubitsPerReg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numRegs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a>&#160;</td>
          <td class="paramname"><em>encoding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>exponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numTermsPerReg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int *&#160;</td>
          <td class="paramname"><em>overrideInds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>overridePhases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numOverrides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04376">4376</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4381</span>{</div>
<div class="line"><span class="lineno"> 4382</span>    <span class="comment">// each node/chunk modifies only local values in an embarrassingly parallel way </span></div>
<div class="line"><span class="lineno"> 4383</span> </div>
<div class="line"><span class="lineno"> 4384</span>    <span class="comment">// note partitions of qubits, coeffs, exponents and overrideInds are stored flat</span></div>
<div class="line"><span class="lineno"> 4385</span> </div>
<div class="line"><span class="lineno"> 4386</span>    <span class="comment">// thread-shared vaes</span></div>
<div class="line"><span class="lineno"> 4387</span>    <span class="keywordtype">int</span> chunkId = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 4388</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4389</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4390</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4391</span> </div>
<div class="line"><span class="lineno"> 4392</span>    <span class="comment">// thread-private vars</span></div>
<div class="line"><span class="lineno"> 4393</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index, globalAmpInd;</div>
<div class="line"><span class="lineno"> 4394</span>    <span class="keywordtype">int</span> r, q, i, t, found, flatInd;</div>
<div class="line"><span class="lineno"> 4395</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> phase, c, s, re, im;</div>
<div class="line"><span class="lineno"> 4396</span> </div>
<div class="line"><span class="lineno"> 4397</span>    <span class="comment">// each thread has a private static array of length &gt;= numRegs (private var-length is illegal)</span></div>
<div class="line"><span class="lineno"> 4398</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> phaseInds[<a class="code hl_define" href="QuEST__precision_8h.html#a6698ce2a3971003a0a0289e5980d39c5">MAX_NUM_REGS_APPLY_ARBITRARY_PHASE</a>];</div>
<div class="line"><span class="lineno"> 4399</span> </div>
<div class="line"><span class="lineno"> 4400</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4401</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4402</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 4403</span><span class="preprocessor">    shared   (chunkId,numAmps, stateRe,stateIm, qubits,numQubitsPerReg,numRegs,encoding, coeffs,exponents,numTermsPerReg, overrideInds,overridePhases,numOverrides, conj) \</span></div>
<div class="line"><span class="lineno"> 4404</span><span class="preprocessor">    private  (index,globalAmpInd, r,q,i,t,flatInd, found, phaseInds,phase, c,s,re,im) </span></div>
<div class="line"><span class="lineno"> 4405</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4406</span>    {</div>
<div class="line"><span class="lineno"> 4407</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4408</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 4409</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4410</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4411</span> </div>
<div class="line"><span class="lineno"> 4412</span>            <span class="comment">// determine global amplitude index </span></div>
<div class="line"><span class="lineno"> 4413</span>            globalAmpInd = chunkId * numAmps + index;</div>
<div class="line"><span class="lineno"> 4414</span> </div>
<div class="line"><span class="lineno"> 4415</span>            <span class="comment">// determine phase indices</span></div>
<div class="line"><span class="lineno"> 4416</span>            flatInd = 0;</div>
<div class="line"><span class="lineno"> 4417</span>            <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++) {</div>
<div class="line"><span class="lineno"> 4418</span>                phaseInds[r] = 0LL;</div>
<div class="line"><span class="lineno"> 4419</span> </div>
<div class="line"><span class="lineno"> 4420</span>                <span class="keywordflow">if</span> (encoding == <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a>) {</div>
<div class="line"><span class="lineno"> 4421</span>                    <span class="keywordflow">for</span> (q=0; q&lt;numQubitsPerReg[r]; q++)</div>
<div class="line"><span class="lineno"> 4422</span>                        phaseInds[r] += (1LL &lt;&lt; q) * <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[flatInd++], globalAmpInd);   <span class="comment">// qubits[flatInd] ~ qubits[r][q]</span></div>
<div class="line"><span class="lineno"> 4423</span>                }</div>
<div class="line"><span class="lineno"> 4424</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (encoding == <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a>) {</div>
<div class="line"><span class="lineno"> 4425</span>                    <span class="keywordflow">for</span> (q=0; q&lt;numQubitsPerReg[r]-1; q++)  </div>
<div class="line"><span class="lineno"> 4426</span>                        phaseInds[r] += (1LL &lt;&lt; q) * <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[flatInd++], globalAmpInd);</div>
<div class="line"><span class="lineno"> 4427</span>                    <span class="comment">// use final qubit to indicate sign</span></div>
<div class="line"><span class="lineno"> 4428</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[flatInd++], globalAmpInd) == 1)</div>
<div class="line"><span class="lineno"> 4429</span>                        phaseInds[r] -= (1LL &lt;&lt; (numQubitsPerReg[r]-1));</div>
<div class="line"><span class="lineno"> 4430</span>                }</div>
<div class="line"><span class="lineno"> 4431</span>            }</div>
<div class="line"><span class="lineno"> 4432</span> </div>
<div class="line"><span class="lineno"> 4433</span>            <span class="comment">// determine if this phase index has an overriden value (i &lt; numOverrides)</span></div>
<div class="line"><span class="lineno"> 4434</span>            <span class="keywordflow">for</span> (i=0; i&lt;numOverrides; i++) {</div>
<div class="line"><span class="lineno"> 4435</span>                found = 1;</div>
<div class="line"><span class="lineno"> 4436</span>                <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++) {</div>
<div class="line"><span class="lineno"> 4437</span>                    <span class="keywordflow">if</span> (phaseInds[r] != overrideInds[i*numRegs+r]) {</div>
<div class="line"><span class="lineno"> 4438</span>                        found = 0;</div>
<div class="line"><span class="lineno"> 4439</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4440</span>                    }</div>
<div class="line"><span class="lineno"> 4441</span>                }</div>
<div class="line"><span class="lineno"> 4442</span>                <span class="keywordflow">if</span> (found)</div>
<div class="line"><span class="lineno"> 4443</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4444</span>            }</div>
<div class="line"><span class="lineno"> 4445</span> </div>
<div class="line"><span class="lineno"> 4446</span>            <span class="comment">// compute the phase (unless overriden)</span></div>
<div class="line"><span class="lineno"> 4447</span>            phase = 0;</div>
<div class="line"><span class="lineno"> 4448</span>            <span class="keywordflow">if</span> (i &lt; numOverrides)</div>
<div class="line"><span class="lineno"> 4449</span>                phase = overridePhases[i];</div>
<div class="line"><span class="lineno"> 4450</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4451</span>                flatInd = 0;</div>
<div class="line"><span class="lineno"> 4452</span>                <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++) {</div>
<div class="line"><span class="lineno"> 4453</span>                    <span class="keywordflow">for</span> (t=0; t&lt;numTermsPerReg[r]; t++) {</div>
<div class="line"><span class="lineno"> 4454</span>                        phase += coeffs[flatInd] * pow(phaseInds[r], exponents[flatInd]);</div>
<div class="line"><span class="lineno"> 4455</span>                        flatInd++;</div>
<div class="line"><span class="lineno"> 4456</span>                    }</div>
<div class="line"><span class="lineno"> 4457</span>                }</div>
<div class="line"><span class="lineno"> 4458</span>            }</div>
<div class="line"><span class="lineno"> 4459</span>            </div>
<div class="line"><span class="lineno"> 4460</span>            <span class="comment">// negate phase to conjugate operator </span></div>
<div class="line"><span class="lineno"> 4461</span>            <span class="keywordflow">if</span> (conj)</div>
<div class="line"><span class="lineno"> 4462</span>                phase *= -1;</div>
<div class="line"><span class="lineno"> 4463</span> </div>
<div class="line"><span class="lineno"> 4464</span>            <span class="comment">// modify amp to amp * exp(i phase) </span></div>
<div class="line"><span class="lineno"> 4465</span>            c = cos(phase);</div>
<div class="line"><span class="lineno"> 4466</span>            s = sin(phase);</div>
<div class="line"><span class="lineno"> 4467</span>            re = stateRe[index];</div>
<div class="line"><span class="lineno"> 4468</span>            im = stateIm[index];</div>
<div class="line"><span class="lineno"> 4469</span> </div>
<div class="line"><span class="lineno"> 4470</span>            <span class="comment">// = {re[amp] cos(phase) - im[amp] sin(phase)} + i {re[amp] sin(phase) + im[amp] cos(phase)}</span></div>
<div class="line"><span class="lineno"> 4471</span>            stateRe[index] = re*c - im*s;</div>
<div class="line"><span class="lineno"> 4472</span>            stateIm[index] = re*s + im*c;</div>
<div class="line"><span class="lineno"> 4473</span>        }</div>
<div class="line"><span class="lineno"> 4474</span>    }</div>
<div class="line"><span class="lineno"> 4475</span>}</div>
<div class="ttc" id="aQuEST__precision_8h_html_a6698ce2a3971003a0a0289e5980d39c5"><div class="ttname"><a href="QuEST__precision_8h.html#a6698ce2a3971003a0a0289e5980d39c5">MAX_NUM_REGS_APPLY_ARBITRARY_PHASE</a></div><div class="ttdeci">#define MAX_NUM_REGS_APPLY_ARBITRARY_PHASE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__precision_8h_source.html#l00085">QuEST_precision.h:85</a></div></div>
<div class="ttc" id="agroup__type_html_gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae"><div class="ttname"><a href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a></div><div class="ttdeci">@ UNSIGNED</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00271">QuEST.h:271</a></div></div>
<div class="ttc" id="agroup__type_html_gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c"><div class="ttname"><a href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a></div><div class="ttdeci">@ TWOS_COMPLEMENT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00271">QuEST.h:271</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad5b7e25e42427dfa7f19fd950264bb16" name="ad5b7e25e42427dfa7f19fd950264bb16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5b7e25e42427dfa7f19fd950264bb16">&#9670;&#160;</a></span>statevec_applyParamNamedPhaseFuncOverrides()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_applyParamNamedPhaseFuncOverrides </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>numQubitsPerReg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numRegs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a>&#160;</td>
          <td class="paramname"><em>encoding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__type.html#gaa7d869b117ba5024d6b84938e8cdfc65">phaseFunc</a>&#160;</td>
          <td class="paramname"><em>phaseFuncName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int *&#160;</td>
          <td class="paramname"><em>overrideInds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>overridePhases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numOverrides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04477">4477</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4483</span>  {</div>
<div class="line"><span class="lineno"> 4484</span>    <span class="comment">// each node/chunk modifies only local values in an embarrassingly parallel way </span></div>
<div class="line"><span class="lineno"> 4485</span> </div>
<div class="line"><span class="lineno"> 4486</span>    <span class="comment">// note partitions of qubits, overrideInds are stored flat</span></div>
<div class="line"><span class="lineno"> 4487</span> </div>
<div class="line"><span class="lineno"> 4488</span>    <span class="comment">// thread-shared vaes</span></div>
<div class="line"><span class="lineno"> 4489</span>    <span class="keywordtype">int</span> chunkId = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 4490</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4491</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4492</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4493</span> </div>
<div class="line"><span class="lineno"> 4494</span>    <span class="comment">// thread-private vars</span></div>
<div class="line"><span class="lineno"> 4495</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index, globalAmpInd;</div>
<div class="line"><span class="lineno"> 4496</span>    <span class="keywordtype">int</span> r, q, i, found, flatInd;</div>
<div class="line"><span class="lineno"> 4497</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> phase, norm, prod, dist, c, s, re, im;</div>
<div class="line"><span class="lineno"> 4498</span> </div>
<div class="line"><span class="lineno"> 4499</span>    <span class="comment">// each thread has a private static array of length &gt;= numRegs (private var-length is illegal)</span></div>
<div class="line"><span class="lineno"> 4500</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> phaseInds[<a class="code hl_define" href="QuEST__precision_8h.html#a6698ce2a3971003a0a0289e5980d39c5">MAX_NUM_REGS_APPLY_ARBITRARY_PHASE</a>];</div>
<div class="line"><span class="lineno"> 4501</span> </div>
<div class="line"><span class="lineno"> 4502</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4503</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4504</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 4505</span><span class="preprocessor">    shared   (chunkId,numAmps, stateRe,stateIm, qubits,numQubitsPerReg,numRegs,encoding, phaseFuncName,params,numParams, overrideInds,overridePhases,numOverrides, conj) \</span></div>
<div class="line"><span class="lineno"> 4506</span><span class="preprocessor">    private  (index,globalAmpInd, r,q,i,flatInd, found, phaseInds,phase,norm,prod,dist, c,s,re,im) </span></div>
<div class="line"><span class="lineno"> 4507</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4508</span>    {</div>
<div class="line"><span class="lineno"> 4509</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4510</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 4511</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4512</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4513</span> </div>
<div class="line"><span class="lineno"> 4514</span>            <span class="comment">// determine global amplitude index </span></div>
<div class="line"><span class="lineno"> 4515</span>            globalAmpInd = chunkId * numAmps + index;</div>
<div class="line"><span class="lineno"> 4516</span> </div>
<div class="line"><span class="lineno"> 4517</span>            <span class="comment">// determine phase indices</span></div>
<div class="line"><span class="lineno"> 4518</span>            flatInd = 0;</div>
<div class="line"><span class="lineno"> 4519</span>            <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++) {</div>
<div class="line"><span class="lineno"> 4520</span>                phaseInds[r] = 0LL;</div>
<div class="line"><span class="lineno"> 4521</span> </div>
<div class="line"><span class="lineno"> 4522</span>                <span class="keywordflow">if</span> (encoding == <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a>) {</div>
<div class="line"><span class="lineno"> 4523</span>                    <span class="keywordflow">for</span> (q=0; q&lt;numQubitsPerReg[r]; q++)</div>
<div class="line"><span class="lineno"> 4524</span>                        phaseInds[r] += (1LL &lt;&lt; q) * <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[flatInd++], globalAmpInd);   <span class="comment">// qubits[flatInd] ~ qubits[r][q]</span></div>
<div class="line"><span class="lineno"> 4525</span>                }</div>
<div class="line"><span class="lineno"> 4526</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (encoding == <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a>) {</div>
<div class="line"><span class="lineno"> 4527</span>                    <span class="keywordflow">for</span> (q=0; q&lt;numQubitsPerReg[r]-1; q++)  </div>
<div class="line"><span class="lineno"> 4528</span>                        phaseInds[r] += (1LL &lt;&lt; q) * <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[flatInd++], globalAmpInd);</div>
<div class="line"><span class="lineno"> 4529</span>                    <span class="comment">// use final qubit to indicate sign</span></div>
<div class="line"><span class="lineno"> 4530</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[flatInd++], globalAmpInd) == 1)</div>
<div class="line"><span class="lineno"> 4531</span>                        phaseInds[r] -= (1LL &lt;&lt; (numQubitsPerReg[r]-1));</div>
<div class="line"><span class="lineno"> 4532</span>                }</div>
<div class="line"><span class="lineno"> 4533</span>            }</div>
<div class="line"><span class="lineno"> 4534</span> </div>
<div class="line"><span class="lineno"> 4535</span>            <span class="comment">// determine if this phase index has an overriden value (i &lt; numOverrides)</span></div>
<div class="line"><span class="lineno"> 4536</span>            <span class="keywordflow">for</span> (i=0; i&lt;numOverrides; i++) {</div>
<div class="line"><span class="lineno"> 4537</span>                found = 1;</div>
<div class="line"><span class="lineno"> 4538</span>                <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++) {</div>
<div class="line"><span class="lineno"> 4539</span>                    <span class="keywordflow">if</span> (phaseInds[r] != overrideInds[i*numRegs+r]) {</div>
<div class="line"><span class="lineno"> 4540</span>                        found = 0;</div>
<div class="line"><span class="lineno"> 4541</span>                        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4542</span>                    }</div>
<div class="line"><span class="lineno"> 4543</span>                }</div>
<div class="line"><span class="lineno"> 4544</span>                <span class="keywordflow">if</span> (found)</div>
<div class="line"><span class="lineno"> 4545</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4546</span>            }</div>
<div class="line"><span class="lineno"> 4547</span> </div>
<div class="line"><span class="lineno"> 4548</span>            <span class="comment">// compute the phase (unless overriden)</span></div>
<div class="line"><span class="lineno"> 4549</span>            phase = 0;</div>
<div class="line"><span class="lineno"> 4550</span>            <span class="keywordflow">if</span> (i &lt; numOverrides)</div>
<div class="line"><span class="lineno"> 4551</span>                phase = overridePhases[i];</div>
<div class="line"><span class="lineno"> 4552</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4553</span>                <span class="comment">// compute norm related phases</span></div>
<div class="line"><span class="lineno"> 4554</span>                <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e">NORM</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043">INVERSE_NORM</a> ||</div>
<div class="line"><span class="lineno"> 4555</span>                    phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1">SCALED_NORM</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2">SCALED_INVERSE_NORM</a> ||</div>
<div class="line"><span class="lineno"> 4556</span>                    phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a>) {</div>
<div class="line"><span class="lineno"> 4557</span> </div>
<div class="line"><span class="lineno"> 4558</span>                    norm = 0;</div>
<div class="line"><span class="lineno"> 4559</span>                    <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a>) {</div>
<div class="line"><span class="lineno"> 4560</span>                        <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++)</div>
<div class="line"><span class="lineno"> 4561</span>                            norm += (phaseInds[r] - params[2+r])*(phaseInds[r] - params[2+r]);</div>
<div class="line"><span class="lineno"> 4562</span>                    }</div>
<div class="line"><span class="lineno"> 4563</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4564</span>                        <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++)</div>
<div class="line"><span class="lineno"> 4565</span>                            norm += phaseInds[r]*phaseInds[r];</div>
<div class="line"><span class="lineno"> 4566</span>                    norm = sqrt(norm);</div>
<div class="line"><span class="lineno"> 4567</span> </div>
<div class="line"><span class="lineno"> 4568</span>                    <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e">NORM</a>)</div>
<div class="line"><span class="lineno"> 4569</span>                        phase = norm;</div>
<div class="line"><span class="lineno"> 4570</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043">INVERSE_NORM</a>)</div>
<div class="line"><span class="lineno"> 4571</span>                        phase = (norm == 0.)? params[0] : 1/norm;  <span class="comment">// smallest non-zero norm is 1</span></div>
<div class="line"><span class="lineno"> 4572</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1">SCALED_NORM</a>)</div>
<div class="line"><span class="lineno"> 4573</span>                        phase = params[0] * norm;</div>
<div class="line"><span class="lineno"> 4574</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2">SCALED_INVERSE_NORM</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a>)</div>
<div class="line"><span class="lineno"> 4575</span>                        phase = (norm &lt;= REAL_EPS)? params[1] : params[0] / norm; <span class="comment">// unless shifted closer to zero</span></div>
<div class="line"><span class="lineno"> 4576</span>                }</div>
<div class="line"><span class="lineno"> 4577</span>                <span class="comment">// compute product related phases</span></div>
<div class="line"><span class="lineno"> 4578</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4">PRODUCT</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556">INVERSE_PRODUCT</a> ||</div>
<div class="line"><span class="lineno"> 4579</span>                         phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93">SCALED_PRODUCT</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb">SCALED_INVERSE_PRODUCT</a>) {</div>
<div class="line"><span class="lineno"> 4580</span> </div>
<div class="line"><span class="lineno"> 4581</span>                    prod = 1;</div>
<div class="line"><span class="lineno"> 4582</span>                    <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r++)</div>
<div class="line"><span class="lineno"> 4583</span>                        prod *= phaseInds[r];</div>
<div class="line"><span class="lineno"> 4584</span> </div>
<div class="line"><span class="lineno"> 4585</span>                    <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4">PRODUCT</a>)</div>
<div class="line"><span class="lineno"> 4586</span>                        phase = prod;</div>
<div class="line"><span class="lineno"> 4587</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556">INVERSE_PRODUCT</a>)</div>
<div class="line"><span class="lineno"> 4588</span>                        phase = (prod == 0.)? params[0] : 1/prod;  <span class="comment">// smallest non-zero product norm is +- 1</span></div>
<div class="line"><span class="lineno"> 4589</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93">SCALED_PRODUCT</a>)</div>
<div class="line"><span class="lineno"> 4590</span>                        phase = params[0] * prod;</div>
<div class="line"><span class="lineno"> 4591</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb">SCALED_INVERSE_PRODUCT</a>)</div>
<div class="line"><span class="lineno"> 4592</span>                        phase = (prod == 0.)? params[1] : params[0] / prod;</div>
<div class="line"><span class="lineno"> 4593</span>                }</div>
<div class="line"><span class="lineno"> 4594</span>                <span class="comment">// compute Euclidean distance related phases </span></div>
<div class="line"><span class="lineno"> 4595</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91">DISTANCE</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0">INVERSE_DISTANCE</a> ||</div>
<div class="line"><span class="lineno"> 4596</span>                         phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4">SCALED_DISTANCE</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227">SCALED_INVERSE_DISTANCE</a> ||</div>
<div class="line"><span class="lineno"> 4597</span>                         phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a>) {</div>
<div class="line"><span class="lineno"> 4598</span> </div>
<div class="line"><span class="lineno"> 4599</span>                    dist = 0;</div>
<div class="line"><span class="lineno"> 4600</span>                    <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a>) {</div>
<div class="line"><span class="lineno"> 4601</span>                        <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r+=2)</div>
<div class="line"><span class="lineno"> 4602</span>                            dist += (phaseInds[r] - phaseInds[r+1] - params[2+r/2])*(phaseInds[r] - phaseInds[r+1] - params[2+r/2]);</div>
<div class="line"><span class="lineno"> 4603</span>                    }</div>
<div class="line"><span class="lineno"> 4604</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a>) {</div>
<div class="line"><span class="lineno"> 4605</span>                        <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r+=2)</div>
<div class="line"><span class="lineno"> 4606</span>                            dist += params[2+r] * (phaseInds[r] - phaseInds[r+1] - params[2+r+1])*(phaseInds[r] - phaseInds[r+1] - params[2+r+1]);</div>
<div class="line"><span class="lineno"> 4607</span>                    }</div>
<div class="line"><span class="lineno"> 4608</span>                    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4609</span>                        <span class="keywordflow">for</span> (r=0; r&lt;numRegs; r+=2)</div>
<div class="line"><span class="lineno"> 4610</span>                            dist += (phaseInds[r+1] - phaseInds[r])*(phaseInds[r+1] - phaseInds[r]);</div>
<div class="line"><span class="lineno"> 4611</span> </div>
<div class="line"><span class="lineno"> 4612</span>                    <span class="comment">// if sqrt() arg would be negative, set it to divergence param</span></div>
<div class="line"><span class="lineno"> 4613</span>                    <span class="keywordflow">if</span> (dist &lt; 0)</div>
<div class="line"><span class="lineno"> 4614</span>                        dist = 0;</div>
<div class="line"><span class="lineno"> 4615</span> </div>
<div class="line"><span class="lineno"> 4616</span>                    dist = sqrt(dist);</div>
<div class="line"><span class="lineno"> 4617</span> </div>
<div class="line"><span class="lineno"> 4618</span>                    <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91">DISTANCE</a>)</div>
<div class="line"><span class="lineno"> 4619</span>                        phase = dist;</div>
<div class="line"><span class="lineno"> 4620</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0">INVERSE_DISTANCE</a>)</div>
<div class="line"><span class="lineno"> 4621</span>                        phase = (dist == 0.)? params[0] : 1/dist; <span class="comment">// smallest non-zero dist is 1</span></div>
<div class="line"><span class="lineno"> 4622</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4">SCALED_DISTANCE</a>)</div>
<div class="line"><span class="lineno"> 4623</span>                        phase = params[0] * dist;</div>
<div class="line"><span class="lineno"> 4624</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227">SCALED_INVERSE_DISTANCE</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a> || phaseFuncName == <a class="code hl_enumvalue" href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a>)</div>
<div class="line"><span class="lineno"> 4625</span>                        phase = (dist &lt;= REAL_EPS)? params[1] : params[0] / dist; <span class="comment">// unless shifted closer to 0</span></div>
<div class="line"><span class="lineno"> 4626</span>                }</div>
<div class="line"><span class="lineno"> 4627</span>            }</div>
<div class="line"><span class="lineno"> 4628</span>            </div>
<div class="line"><span class="lineno"> 4629</span>            <span class="comment">// negate phase to conjugate operator </span></div>
<div class="line"><span class="lineno"> 4630</span>            <span class="keywordflow">if</span> (conj)</div>
<div class="line"><span class="lineno"> 4631</span>                phase *= -1;</div>
<div class="line"><span class="lineno"> 4632</span> </div>
<div class="line"><span class="lineno"> 4633</span>            <span class="comment">// modify amp to amp * exp(i phase) </span></div>
<div class="line"><span class="lineno"> 4634</span>            c = cos(phase);</div>
<div class="line"><span class="lineno"> 4635</span>            s = sin(phase);</div>
<div class="line"><span class="lineno"> 4636</span>            re = stateRe[index];</div>
<div class="line"><span class="lineno"> 4637</span>            im = stateIm[index];</div>
<div class="line"><span class="lineno"> 4638</span> </div>
<div class="line"><span class="lineno"> 4639</span>            <span class="comment">// = {re[amp] cos(phase) - im[amp] sin(phase)} + i {re[amp] sin(phase) + im[amp] cos(phase)}</span></div>
<div class="line"><span class="lineno"> 4640</span>            stateRe[index] = re*c - im*s;</div>
<div class="line"><span class="lineno"> 4641</span>            stateIm[index] = re*s + im*c;</div>
<div class="line"><span class="lineno"> 4642</span>        }</div>
<div class="line"><span class="lineno"> 4643</span>    }</div>
<div class="line"><span class="lineno"> 4644</span>}</div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a1a5168576607f460d3e60f184575cacb">SCALED_INVERSE_PRODUCT</a></div><div class="ttdeci">@ SCALED_INVERSE_PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a2ad72f168181763513d7793c13bf2a91">DISTANCE</a></div><div class="ttdeci">@ DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a31a29a30f92fe34c35098f941adbbc93">SCALED_PRODUCT</a></div><div class="ttdeci">@ SCALED_PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a39111120b79016d6b3e773b711fa63f7">SCALED_INVERSE_SHIFTED_DISTANCE</a></div><div class="ttdeci">@ SCALED_INVERSE_SHIFTED_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a6313e6ff48163c11c47866c4fda4bfa0">INVERSE_DISTANCE</a></div><div class="ttdeci">@ INVERSE_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a93c0c1e166dd43c6a57f61e5490808e1">SCALED_NORM</a></div><div class="ttdeci">@ SCALED_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65a99bdacc6f28e9f067ccf6f0d1d0b153f">SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</a></div><div class="ttdeci">@ SCALED_INVERSE_SHIFTED_WEIGHTED_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00236">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65aa318172feec5b530e9a7849f2f7b44e7">SCALED_INVERSE_SHIFTED_NORM</a></div><div class="ttdeci">@ SCALED_INVERSE_SHIFTED_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb26952815118f5ced7703302dbeb556">INVERSE_PRODUCT</a></div><div class="ttdeci">@ INVERSE_PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65acb6911398e0068f545a31b82bcdef3e4">PRODUCT</a></div><div class="ttdeci">@ PRODUCT</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00234">QuEST.h:234</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ace23d4b924240a245d83193f0ce398d4">SCALED_DISTANCE</a></div><div class="ttdeci">@ SCALED_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ad4c32e295c08ebe224e2c5ba6497f043">INVERSE_NORM</a></div><div class="ttdeci">@ INVERSE_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae003ec1158e3a4e295616ced12af154e">NORM</a></div><div class="ttdeci">@ NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae5114537389194302c7a619e35e6e227">SCALED_INVERSE_DISTANCE</a></div><div class="ttdeci">@ SCALED_INVERSE_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00235">QuEST.h:235</a></div></div>
<div class="ttc" id="agroup__type_html_ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2"><div class="ttname"><a href="group__type.html#ggaa7d869b117ba5024d6b84938e8cdfc65ae8c96906c1ec109d295c491e572d01e2">SCALED_INVERSE_NORM</a></div><div class="ttdeci">@ SCALED_INVERSE_NORM</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00233">QuEST.h:233</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d7928473aca695a614e9c24d903e578" name="a9d7928473aca695a614e9c24d903e578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d7928473aca695a614e9c24d903e578">&#9670;&#160;</a></span>statevec_applyPhaseFuncOverrides()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_applyPhaseFuncOverrides </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="group__type.html#ga9c91c41aa42ae537995e89ffc616afe1">bitEncoding</a>&#160;</td>
          <td class="paramname"><em>encoding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>coeffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>exponents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTerms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int *&#160;</td>
          <td class="paramname"><em>overrideInds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>overridePhases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numOverrides</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04299">4299</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4304</span>{</div>
<div class="line"><span class="lineno"> 4305</span>    <span class="comment">// each node/chunk modifies only local values in an embarrassingly parallel way </span></div>
<div class="line"><span class="lineno"> 4306</span> </div>
<div class="line"><span class="lineno"> 4307</span>    <span class="comment">// thread shared vars</span></div>
<div class="line"><span class="lineno"> 4308</span>    <span class="keywordtype">int</span> chunkId = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 4309</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4310</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4311</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4312</span> </div>
<div class="line"><span class="lineno"> 4313</span>    <span class="comment">// thread private vars</span></div>
<div class="line"><span class="lineno"> 4314</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index, globalAmpInd, phaseInd;</div>
<div class="line"><span class="lineno"> 4315</span>    <span class="keywordtype">int</span> i, t, q;</div>
<div class="line"><span class="lineno"> 4316</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> phase, c, s, re, im;</div>
<div class="line"><span class="lineno"> 4317</span> </div>
<div class="line"><span class="lineno"> 4318</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4319</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4320</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 4321</span><span class="preprocessor">    shared   (chunkId,numAmps, stateRe,stateIm, qubits,numQubits,encoding, coeffs,exponents,numTerms, overrideInds,overridePhases,numOverrides, conj) \</span></div>
<div class="line"><span class="lineno"> 4322</span><span class="preprocessor">    private  (index, globalAmpInd, phaseInd, i,t,q, phase, c,s,re,im) </span></div>
<div class="line"><span class="lineno"> 4323</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4324</span>    {</div>
<div class="line"><span class="lineno"> 4325</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4326</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 4327</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4328</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4329</span> </div>
<div class="line"><span class="lineno"> 4330</span>            <span class="comment">// determine global amplitude index </span></div>
<div class="line"><span class="lineno"> 4331</span>            globalAmpInd = chunkId * numAmps + index;</div>
<div class="line"><span class="lineno"> 4332</span> </div>
<div class="line"><span class="lineno"> 4333</span>            <span class="comment">// determine phase index of {qubits}</span></div>
<div class="line"><span class="lineno"> 4334</span>            phaseInd = 0LL;</div>
<div class="line"><span class="lineno"> 4335</span>            <span class="keywordflow">if</span> (encoding == <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a7165f9a47792f47c718ca128556fb3ae">UNSIGNED</a>) {</div>
<div class="line"><span class="lineno"> 4336</span>                <span class="keywordflow">for</span> (q=0; q&lt;numQubits; q++) <span class="comment">// use significance order specified by {qubits}</span></div>
<div class="line"><span class="lineno"> 4337</span>                    phaseInd += (1LL &lt;&lt; q) * <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[q], globalAmpInd);</div>
<div class="line"><span class="lineno"> 4338</span>            } </div>
<div class="line"><span class="lineno"> 4339</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (encoding == <a class="code hl_enumvalue" href="group__type.html#gga9c91c41aa42ae537995e89ffc616afe1a9aa2a35d92976c7de970506c4d19a96c">TWOS_COMPLEMENT</a>) {</div>
<div class="line"><span class="lineno"> 4340</span>                <span class="keywordflow">for</span> (q=0; q&lt;numQubits-1; q++) <span class="comment">// use final qubit to indicate sign </span></div>
<div class="line"><span class="lineno"> 4341</span>                    phaseInd += (1LL &lt;&lt; q) * <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[q], globalAmpInd);</div>
<div class="line"><span class="lineno"> 4342</span>                <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[numQubits-1], globalAmpInd) == 1)</div>
<div class="line"><span class="lineno"> 4343</span>                    phaseInd -= (1LL &lt;&lt; (numQubits-1));</div>
<div class="line"><span class="lineno"> 4344</span>            }</div>
<div class="line"><span class="lineno"> 4345</span> </div>
<div class="line"><span class="lineno"> 4346</span>            <span class="comment">// determine if this phase index has an overriden value (i &lt; numOverrides)</span></div>
<div class="line"><span class="lineno"> 4347</span>            <span class="keywordflow">for</span> (i=0; i&lt;numOverrides; i++)</div>
<div class="line"><span class="lineno"> 4348</span>                <span class="keywordflow">if</span> (phaseInd == overrideInds[i])</div>
<div class="line"><span class="lineno"> 4349</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 4350</span> </div>
<div class="line"><span class="lineno"> 4351</span>            <span class="comment">// determine phase from {coeffs}, {exponents} (unless overriden)</span></div>
<div class="line"><span class="lineno"> 4352</span>            phase = 0;</div>
<div class="line"><span class="lineno"> 4353</span>            <span class="keywordflow">if</span> (i &lt; numOverrides)</div>
<div class="line"><span class="lineno"> 4354</span>                phase = overridePhases[i];</div>
<div class="line"><span class="lineno"> 4355</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 4356</span>                <span class="keywordflow">for</span> (t=0; t&lt;numTerms; t++)</div>
<div class="line"><span class="lineno"> 4357</span>                    phase += coeffs[t] * pow(phaseInd, exponents[t]);</div>
<div class="line"><span class="lineno"> 4358</span>                    </div>
<div class="line"><span class="lineno"> 4359</span>            <span class="comment">// negate phase to conjugate operator </span></div>
<div class="line"><span class="lineno"> 4360</span>            <span class="keywordflow">if</span> (conj)</div>
<div class="line"><span class="lineno"> 4361</span>                phase *= -1;</div>
<div class="line"><span class="lineno"> 4362</span> </div>
<div class="line"><span class="lineno"> 4363</span>            <span class="comment">// modify amp to amp * exp(i phase) </span></div>
<div class="line"><span class="lineno"> 4364</span>            c = cos(phase);</div>
<div class="line"><span class="lineno"> 4365</span>            s = sin(phase);</div>
<div class="line"><span class="lineno"> 4366</span>            re = stateRe[index];</div>
<div class="line"><span class="lineno"> 4367</span>            im = stateIm[index];</div>
<div class="line"><span class="lineno"> 4368</span> </div>
<div class="line"><span class="lineno"> 4369</span>            <span class="comment">// = {re[amp] cos(phase) - im[amp] sin(phase)} + i {re[amp] sin(phase) + im[amp] cos(phase)}</span></div>
<div class="line"><span class="lineno"> 4370</span>            stateRe[index] = re*c - im*s;</div>
<div class="line"><span class="lineno"> 4371</span>            stateIm[index] = re*s + im*c;</div>
<div class="line"><span class="lineno"> 4372</span>        }</div>
<div class="line"><span class="lineno"> 4373</span>    }</div>
<div class="line"><span class="lineno"> 4374</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0bb94b4fe408f0abec1728ea613af137" name="a0bb94b4fe408f0abec1728ea613af137"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0bb94b4fe408f0abec1728ea613af137">&#9670;&#160;</a></span>statevec_applySubDiagonalOp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_applySubDiagonalOp </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>targets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structSubDiagonalOp.html">SubDiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01339">1339</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1339</span>                                                                                        {</div>
<div class="line"><span class="lineno"> 1340</span>    </div>
<div class="line"><span class="lineno"> 1341</span>    <span class="comment">// each node/chunk modifies only its values in an embarrassingly parallelisable way</span></div>
<div class="line"><span class="lineno"> 1342</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numLocalAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1343</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1344</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1345</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opRe = op.<a class="code hl_variable" href="structSubDiagonalOp.html#a7574f5598b97ff42a3d5238087722026">real</a>;</div>
<div class="line"><span class="lineno"> 1346</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* opIm = op.<a class="code hl_variable" href="structSubDiagonalOp.html#abb4b987a1e075fd89c03245d089a32c5">imag</a>;</div>
<div class="line"><span class="lineno"> 1347</span>    </div>
<div class="line"><span class="lineno"> 1348</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indPref = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * numLocalAmps;</div>
<div class="line"><span class="lineno"> 1349</span>    <span class="keywordtype">int</span> numTargets = op.<a class="code hl_variable" href="structSubDiagonalOp.html#af6cd52e0f020146e0019772d379c6996">numQubits</a>;</div>
<div class="line"><span class="lineno"> 1350</span>    </div>
<div class="line"><span class="lineno"> 1351</span>    <span class="keywordtype">int</span> conjFac = 1;</div>
<div class="line"><span class="lineno"> 1352</span>    <span class="keywordflow">if</span> (conj)</div>
<div class="line"><span class="lineno"> 1353</span>        conjFac = -1;</div>
<div class="line"><span class="lineno"> 1354</span>    </div>
<div class="line"><span class="lineno"> 1355</span>    <span class="keywordtype">int</span> t;</div>
<div class="line"><span class="lineno"> 1356</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i, j, v;</div>
<div class="line"><span class="lineno"> 1357</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> elemRe, elemIm, ampRe, ampIm;</div>
<div class="line"><span class="lineno"> 1358</span>    </div>
<div class="line"><span class="lineno"> 1359</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1360</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1361</span><span class="preprocessor">    shared    (numLocalAmps, indPref, numTargets, targets, stateRe,stateIm) \</span></div>
<div class="line"><span class="lineno"> 1362</span><span class="preprocessor">    private   (j,i,v,t, elemRe,elemIm, ampRe,ampIm)</span></div>
<div class="line"><span class="lineno"> 1363</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 1364</span>    {</div>
<div class="line"><span class="lineno"> 1365</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1366</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 1367</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1368</span>        <span class="keywordflow">for</span> (j=0; j&lt;numLocalAmps; j++) {</div>
<div class="line"><span class="lineno"> 1369</span>            </div>
<div class="line"><span class="lineno"> 1370</span>            i = indPref | j;</div>
<div class="line"><span class="lineno"> 1371</span>            v = 0;</div>
<div class="line"><span class="lineno"> 1372</span>            <span class="keywordflow">for</span> (t=0; t&lt;numTargets; t++)</div>
<div class="line"><span class="lineno"> 1373</span>                v |= <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(targets[t], i) &lt;&lt; t;</div>
<div class="line"><span class="lineno"> 1374</span>                </div>
<div class="line"><span class="lineno"> 1375</span>            elemRe = opRe[v];</div>
<div class="line"><span class="lineno"> 1376</span>            elemIm = opIm[v] * conjFac;</div>
<div class="line"><span class="lineno"> 1377</span>            </div>
<div class="line"><span class="lineno"> 1378</span>            ampRe = stateRe[j];</div>
<div class="line"><span class="lineno"> 1379</span>            ampIm = stateIm[j];</div>
<div class="line"><span class="lineno"> 1380</span>            </div>
<div class="line"><span class="lineno"> 1381</span>            <span class="comment">// (a + b i)(c + d i) = (a c - b d) + i (a d + b c)</span></div>
<div class="line"><span class="lineno"> 1382</span>            stateRe[j] = ampRe*elemRe - ampIm*elemIm;</div>
<div class="line"><span class="lineno"> 1383</span>            stateIm[j] = ampRe*elemIm + ampIm*elemRe;</div>
<div class="line"><span class="lineno"> 1384</span>        }</div>
<div class="line"><span class="lineno"> 1385</span>    }</div>
<div class="line"><span class="lineno"> 1386</span>}</div>
<div class="ttc" id="astructSubDiagonalOp_html_a7574f5598b97ff42a3d5238087722026"><div class="ttname"><a href="structSubDiagonalOp.html#a7574f5598b97ff42a3d5238087722026">SubDiagonalOp::real</a></div><div class="ttdeci">qreal * real</div><div class="ttdoc">The real values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00330">QuEST.h:330</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html_abb4b987a1e075fd89c03245d089a32c5"><div class="ttname"><a href="structSubDiagonalOp.html#abb4b987a1e075fd89c03245d089a32c5">SubDiagonalOp::imag</a></div><div class="ttdeci">qreal * imag</div><div class="ttdoc">The imaginary values of the 2^numQubits complex elements.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00332">QuEST.h:332</a></div></div>
<div class="ttc" id="astructSubDiagonalOp_html_af6cd52e0f020146e0019772d379c6996"><div class="ttname"><a href="structSubDiagonalOp.html#af6cd52e0f020146e0019772d379c6996">SubDiagonalOp::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdoc">The number of target qubits which this SubDiagonalOp can operate upon.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00326">QuEST.h:326</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16ccb485bcffb328bbd5b2af6977cead" name="a16ccb485bcffb328bbd5b2af6977cead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16ccb485bcffb328bbd5b2af6977cead">&#9670;&#160;</a></span>statevec_calcExpecDiagonalOpLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> statevec_calcExpecDiagonalOpLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structDiagonalOp.html">DiagonalOp</a>&#160;</td>
          <td class="paramname"><em>op</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04155">4155</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4155</span>                                                                      {</div>
<div class="line"><span class="lineno"> 4156</span>    </div>
<div class="line"><span class="lineno"> 4157</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> expecRe = 0;</div>
<div class="line"><span class="lineno"> 4158</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> expecIm = 0;</div>
<div class="line"><span class="lineno"> 4159</span>    </div>
<div class="line"><span class="lineno"> 4160</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 4161</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4162</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4163</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4164</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *opReal = op.<a class="code hl_variable" href="structDiagonalOp.html#a1d66088bed235d524cd452b107694d5c">real</a>;</div>
<div class="line"><span class="lineno"> 4165</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *opImag = op.<a class="code hl_variable" href="structDiagonalOp.html#a85c3f52533efe831bbe40b9a48602388">imag</a>;</div>
<div class="line"><span class="lineno"> 4166</span>    </div>
<div class="line"><span class="lineno"> 4167</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> vecRe,vecIm,vecAbs, opRe, opIm;</div>
<div class="line"><span class="lineno"> 4168</span>    </div>
<div class="line"><span class="lineno"> 4169</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4170</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4171</span><span class="preprocessor">    shared    (stateReal, stateImag, opReal, opImag, numAmps) \</span></div>
<div class="line"><span class="lineno"> 4172</span><span class="preprocessor">    private   (index, vecRe,vecIm,vecAbs, opRe,opIm) \</span></div>
<div class="line"><span class="lineno"> 4173</span><span class="preprocessor">    reduction ( +:expecRe, expecIm )</span></div>
<div class="line"><span class="lineno"> 4174</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 4175</span>    {</div>
<div class="line"><span class="lineno"> 4176</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4177</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 4178</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4179</span>        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4180</span>            vecRe = stateReal[index];</div>
<div class="line"><span class="lineno"> 4181</span>            vecIm = stateImag[index];</div>
<div class="line"><span class="lineno"> 4182</span>            opRe = opReal[index];</div>
<div class="line"><span class="lineno"> 4183</span>            opIm = opImag[index];</div>
<div class="line"><span class="lineno"> 4184</span>            </div>
<div class="line"><span class="lineno"> 4185</span>            <span class="comment">// abs(vec)^2 op</span></div>
<div class="line"><span class="lineno"> 4186</span>            vecAbs = vecRe*vecRe + vecIm*vecIm;</div>
<div class="line"><span class="lineno"> 4187</span>            expecRe += vecAbs*opRe;</div>
<div class="line"><span class="lineno"> 4188</span>            expecIm += vecAbs*opIm;</div>
<div class="line"><span class="lineno"> 4189</span>        }</div>
<div class="line"><span class="lineno"> 4190</span>    }</div>
<div class="line"><span class="lineno"> 4191</span>    </div>
<div class="line"><span class="lineno"> 4192</span>    <a class="code hl_struct" href="structComplex.html">Complex</a> innerProd;</div>
<div class="line"><span class="lineno"> 4193</span>    innerProd.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = expecRe;</div>
<div class="line"><span class="lineno"> 4194</span>    innerProd.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = expecIm;</div>
<div class="line"><span class="lineno"> 4195</span>    <span class="keywordflow">return</span> innerProd;</div>
<div class="line"><span class="lineno"> 4196</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00312">DiagonalOp::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>, <a class="el" href="QuEST_8h_source.html#l00310">DiagonalOp::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01602">statevec_calcExpecDiagonalOp()</a>.</p>

</div>
</div>
<a id="a6fbb3b693f25dde1e9e3dc87dc1984f7" name="a6fbb3b693f25dde1e9e3dc87dc1984f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fbb3b693f25dde1e9e3dc87dc1984f7">&#9670;&#160;</a></span>statevec_calcInnerProductLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structComplex.html">Complex</a> statevec_calcInnerProductLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>bra</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>ket</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01088">1088</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1088</span>                                                             {</div>
<div class="line"><span class="lineno"> 1089</span>    </div>
<div class="line"><span class="lineno"> 1090</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> innerProdReal = 0;</div>
<div class="line"><span class="lineno"> 1091</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> innerProdImag = 0;</div>
<div class="line"><span class="lineno"> 1092</span>    </div>
<div class="line"><span class="lineno"> 1093</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1094</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = bra.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1095</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *braVecReal = bra.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1096</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *braVecImag = bra.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1097</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *ketVecReal = ket.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1098</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *ketVecImag = ket.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1099</span>    </div>
<div class="line"><span class="lineno"> 1100</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> braRe, braIm, ketRe, ketIm;</div>
<div class="line"><span class="lineno"> 1101</span>    </div>
<div class="line"><span class="lineno"> 1102</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1103</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1104</span><span class="preprocessor">    shared    (braVecReal, braVecImag, ketVecReal, ketVecImag, numAmps) \</span></div>
<div class="line"><span class="lineno"> 1105</span><span class="preprocessor">    private   (index, braRe, braIm, ketRe, ketIm) \</span></div>
<div class="line"><span class="lineno"> 1106</span><span class="preprocessor">    reduction ( +:innerProdReal, innerProdImag )</span></div>
<div class="line"><span class="lineno"> 1107</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 1108</span>    {</div>
<div class="line"><span class="lineno"> 1109</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1110</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 1111</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1112</span>        <span class="keywordflow">for</span> (index=0; index &lt; numAmps; index++) {</div>
<div class="line"><span class="lineno"> 1113</span>            braRe = braVecReal[index];</div>
<div class="line"><span class="lineno"> 1114</span>            braIm = braVecImag[index];</div>
<div class="line"><span class="lineno"> 1115</span>            ketRe = ketVecReal[index];</div>
<div class="line"><span class="lineno"> 1116</span>            ketIm = ketVecImag[index];</div>
<div class="line"><span class="lineno"> 1117</span>            </div>
<div class="line"><span class="lineno"> 1118</span>            <span class="comment">// conj(bra_i) * ket_i</span></div>
<div class="line"><span class="lineno"> 1119</span>            innerProdReal += braRe*ketRe + braIm*ketIm;</div>
<div class="line"><span class="lineno"> 1120</span>            innerProdImag += braRe*ketIm - braIm*ketRe;</div>
<div class="line"><span class="lineno"> 1121</span>        }</div>
<div class="line"><span class="lineno"> 1122</span>    }</div>
<div class="line"><span class="lineno"> 1123</span>    </div>
<div class="line"><span class="lineno"> 1124</span>    <a class="code hl_struct" href="structComplex.html">Complex</a> innerProd;</div>
<div class="line"><span class="lineno"> 1125</span>    innerProd.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a> = innerProdReal;</div>
<div class="line"><span class="lineno"> 1126</span>    innerProd.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a> = innerProdImag;</div>
<div class="line"><span class="lineno"> 1127</span>    <span class="keywordflow">return</span> innerProd;</div>
<div class="line"><span class="lineno"> 1128</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00035">statevec_calcInnerProduct()</a>.</p>

</div>
</div>
<a id="afb1e220c272754d0773aeccdb613b6b3" name="afb1e220c272754d0773aeccdb613b6b3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb1e220c272754d0773aeccdb613b6b3">&#9670;&#160;</a></span>statevec_calcProbOfAllOutcomesLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_calcProbOfAllOutcomesLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>outcomeProbs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>qubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03580">3580</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3580</span>                                                                                                       {</div>
<div class="line"><span class="lineno"> 3581</span>    </div>
<div class="line"><span class="lineno"> 3582</span>    <span class="comment">/* Below, we manually reduce amplitudes into outcomeProbs by using atomic update.</span></div>
<div class="line"><span class="lineno"> 3583</span><span class="comment">     * This maintains OpenMP 3.1 compatibility. An alternative is to use array reduction </span></div>
<div class="line"><span class="lineno"> 3584</span><span class="comment">     * (requires OpenMP 4.5, limits #qubits since outcomeProbs must be a local stack array)</span></div>
<div class="line"><span class="lineno"> 3585</span><span class="comment">     * or a dynamic list of omp locks (duplicates memory cost of outcomeProbs).</span></div>
<div class="line"><span class="lineno"> 3586</span><span class="comment">     * Using locks was always slower than the method below. Using reduction was only </span></div>
<div class="line"><span class="lineno"> 3587</span><span class="comment">     * faster for very few threads, or very few outcomeProbs.</span></div>
<div class="line"><span class="lineno"> 3588</span><span class="comment">     * Finally, we exclude the &#39;update&#39; clause after &#39;atomic&#39; to maintain MSVC compatibility </span></div>
<div class="line"><span class="lineno"> 3589</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 3590</span> </div>
<div class="line"><span class="lineno"> 3591</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numOutcomeProbs = (1 &lt;&lt; numQubits);</div>
<div class="line"><span class="lineno"> 3592</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> j;</div>
<div class="line"><span class="lineno"> 3593</span>    </div>
<div class="line"><span class="lineno"> 3594</span>    <span class="comment">// clear outcomeProbs (in parallel, in case it&#39;s large)</span></div>
<div class="line"><span class="lineno"> 3595</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3596</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3597</span><span class="preprocessor">    default (none) \</span></div>
<div class="line"><span class="lineno"> 3598</span><span class="preprocessor">    shared    (numOutcomeProbs,outcomeProbs) \</span></div>
<div class="line"><span class="lineno"> 3599</span><span class="preprocessor">    private   (j)</span></div>
<div class="line"><span class="lineno"> 3600</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 3601</span>    {</div>
<div class="line"><span class="lineno"> 3602</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3603</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3604</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3605</span>        <span class="keywordflow">for</span> (j=0; j&lt;numOutcomeProbs; j++)</div>
<div class="line"><span class="lineno"> 3606</span>            outcomeProbs[j] = 0;</div>
<div class="line"><span class="lineno"> 3607</span>    }   </div>
<div class="line"><span class="lineno"> 3608</span>    </div>
<div class="line"><span class="lineno"> 3609</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3610</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3611</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3612</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3613</span>    </div>
<div class="line"><span class="lineno"> 3614</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 3615</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outcomeInd;</div>
<div class="line"><span class="lineno"> 3616</span>    <span class="keywordtype">int</span> q;</div>
<div class="line"><span class="lineno"> 3617</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> prob;</div>
<div class="line"><span class="lineno"> 3618</span>    </div>
<div class="line"><span class="lineno"> 3619</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3620</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3621</span><span class="preprocessor">    shared    (numTasks,offset, qubits,numQubits, stateRe,stateIm, outcomeProbs) \</span></div>
<div class="line"><span class="lineno"> 3622</span><span class="preprocessor">    private   (i, q, outcomeInd, prob)</span></div>
<div class="line"><span class="lineno"> 3623</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 3624</span>    {</div>
<div class="line"><span class="lineno"> 3625</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3626</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3627</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3628</span>        <span class="comment">// every amplitude contributes to a single element of retProbs</span></div>
<div class="line"><span class="lineno"> 3629</span>        <span class="keywordflow">for</span> (i=0; i&lt;numTasks; i++) {</div>
<div class="line"><span class="lineno"> 3630</span>            </div>
<div class="line"><span class="lineno"> 3631</span>            <span class="comment">// determine index informed by qubits outcome</span></div>
<div class="line"><span class="lineno"> 3632</span>            outcomeInd = 0;</div>
<div class="line"><span class="lineno"> 3633</span>            <span class="keywordflow">for</span> (q=0; q&lt;numQubits; q++)</div>
<div class="line"><span class="lineno"> 3634</span>                outcomeInd += <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubits[q], i + offset) * (1LL &lt;&lt; q);</div>
<div class="line"><span class="lineno"> 3635</span>            </div>
<div class="line"><span class="lineno"> 3636</span>            prob = stateRe[i]*stateRe[i] + stateIm[i]*stateIm[i];</div>
<div class="line"><span class="lineno"> 3637</span>            </div>
<div class="line"><span class="lineno"> 3638</span>            <span class="comment">// atomicly update corresponding outcome array element</span></div>
<div class="line"><span class="lineno"> 3639</span><span class="preprocessor">            # ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3640</span><span class="preprocessor">            # pragma omp atomic</span></div>
<div class="line"><span class="lineno"> 3641</span><span class="preprocessor">            # endif</span></div>
<div class="line"><span class="lineno"> 3642</span>            outcomeProbs[outcomeInd] += prob;</div>
<div class="line"><span class="lineno"> 3643</span>        }</div>
<div class="line"><span class="lineno"> 3644</span>    }</div>
<div class="line"><span class="lineno"> 3645</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01342">statevec_calcProbOfAllOutcomes()</a>.</p>

</div>
</div>
<a id="aa4b77089145184d990848cd66993aa8b" name="aa4b77089145184d990848cd66993aa8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4b77089145184d990848cd66993aa8b">&#9670;&#160;</a></span>statevec_cloneQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_cloneQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>targetQureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>copyQureg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01611">1611</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1611</span>                                                             {</div>
<div class="line"><span class="lineno"> 1612</span>    </div>
<div class="line"><span class="lineno"> 1613</span>    <span class="comment">// registers are equal sized, so nodes hold the same state-vector partitions</span></div>
<div class="line"><span class="lineno"> 1614</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 1615</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1616</span> </div>
<div class="line"><span class="lineno"> 1617</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1618</span>    stateVecSize = targetQureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1619</span> </div>
<div class="line"><span class="lineno"> 1620</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1621</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *targetStateVecReal = targetQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1622</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *targetStateVecImag = targetQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1623</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *copyStateVecReal = copyQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1624</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *copyStateVecImag = copyQureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>    <span class="comment">// initialise the state to |0000..0000&gt;</span></div>
<div class="line"><span class="lineno"> 1627</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1628</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1629</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1630</span><span class="preprocessor">    shared   (stateVecSize, targetStateVecReal, targetStateVecImag, copyStateVecReal, copyStateVecImag) \</span></div>
<div class="line"><span class="lineno"> 1631</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1632</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1633</span>    {</div>
<div class="line"><span class="lineno"> 1634</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1635</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1636</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1637</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 1638</span>            targetStateVecReal[index] = copyStateVecReal[index];</div>
<div class="line"><span class="lineno"> 1639</span>            targetStateVecImag[index] = copyStateVecImag[index];</div>
<div class="line"><span class="lineno"> 1640</span>        }</div>
<div class="line"><span class="lineno"> 1641</span>    }</div>
<div class="line"><span class="lineno"> 1642</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad09bb76ad67581b03ab176832cca37cf" name="ad09bb76ad67581b03ab176832cca37cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad09bb76ad67581b03ab176832cca37cf">&#9670;&#160;</a></span>statevec_collapseToKnownProbOutcomeDistributedRenorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcomeDistributedRenorm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Renormalise parts of the state vector where measureQubit=0 or 1, based on the total probability of that qubit being in state 0 or 1. </p>
<p >Measure in Zero performs an irreversible change to the state vector: it updates the vector according to the event that the value 'outcome' has been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. In the distributed version, one block (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) is spread over multiple chunks, meaning that each chunks performs only renormalisation or only setting amplitudes to 0. This function handles the renormalisation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being zero </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03880">3880</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3881</span>{</div>
<div class="line"><span class="lineno"> 3882</span>    <span class="comment">// ----- temp variables</span></div>
<div class="line"><span class="lineno"> 3883</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div>
<div class="line"><span class="lineno"> 3884</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3885</span> </div>
<div class="line"><span class="lineno"> 3886</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> renorm=1/sqrt(totalProbability);</div>
<div class="line"><span class="lineno"> 3887</span> </div>
<div class="line"><span class="lineno"> 3888</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3889</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3890</span> </div>
<div class="line"><span class="lineno"> 3891</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3892</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3893</span><span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div>
<div class="line"><span class="lineno"> 3894</span><span class="preprocessor">    private   (thisTask)</span></div>
<div class="line"><span class="lineno"> 3895</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3896</span>    {</div>
<div class="line"><span class="lineno"> 3897</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3898</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3899</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3900</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3901</span>            stateVecReal[thisTask] = stateVecReal[thisTask]*renorm;</div>
<div class="line"><span class="lineno"> 3902</span>            stateVecImag[thisTask] = stateVecImag[thisTask]*renorm;</div>
<div class="line"><span class="lineno"> 3903</span>        }</div>
<div class="line"><span class="lineno"> 3904</span>    }</div>
<div class="line"><span class="lineno"> 3905</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01370">statevec_collapseToKnownProbOutcome()</a>.</p>

</div>
</div>
<a id="ab02bce0ebbb8f624e8ced8b09b99cdef" name="ab02bce0ebbb8f624e8ced8b09b99cdef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab02bce0ebbb8f624e8ced8b09b99cdef">&#9670;&#160;</a></span>statevec_collapseToKnownProbOutcomeLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToKnownProbOutcomeLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>totalProbability</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the state vector to be consistent with measuring measureQubit=0 if outcome=0 and measureQubit=1 if outcome=1. </p>
<p >Performs an irreversible change to the state vector: it updates the vector according to the event that an outcome have been measured on the qubit indicated by measureQubit (where this label starts from 0, of course). It achieves this by setting all inconsistent amplitudes to 0 and then renormalising based on the total probability of measuring measureQubit=0 or 1 according to the value of outcome. In the local version, one or more blocks (with measureQubit=0 in the first half of the block and measureQubit=1 in the second half of the block) fit entirely into one chunk.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">totalProbability</td><td>probability of qubit measureQubit being either zero or one </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>to measure the probability of and set the state to &ndash; either zero or one </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03798">3798</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3799</span>{</div>
<div class="line"><span class="lineno"> 3800</span>    <span class="comment">// ----- sizes</span></div>
<div class="line"><span class="lineno"> 3801</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span></div>
<div class="line"><span class="lineno"> 3802</span>         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div>
<div class="line"><span class="lineno"> 3803</span>    <span class="comment">// ----- indices</span></div>
<div class="line"><span class="lineno"> 3804</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 3805</span>         index;                                               <span class="comment">// current index for first half block</span></div>
<div class="line"><span class="lineno"> 3806</span>    <span class="comment">// ----- measured probability</span></div>
<div class="line"><span class="lineno"> 3807</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   renorm;                                            <span class="comment">// probability (returned) value</span></div>
<div class="line"><span class="lineno"> 3808</span>    <span class="comment">// ----- temp variables</span></div>
<div class="line"><span class="lineno"> 3809</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div>
<div class="line"><span class="lineno"> 3810</span>    <span class="comment">// (good for shared memory parallelism)</span></div>
<div class="line"><span class="lineno"> 3811</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 3812</span> </div>
<div class="line"><span class="lineno"> 3813</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3814</span>    <span class="comment">//            dimensions                                            //</span></div>
<div class="line"><span class="lineno"> 3815</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3816</span>    sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div>
<div class="line"><span class="lineno"> 3817</span>    <span class="comment">// and then the number to skip</span></div>
<div class="line"><span class="lineno"> 3818</span>    sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div>
<div class="line"><span class="lineno"> 3819</span> </div>
<div class="line"><span class="lineno"> 3820</span>    renorm=1/sqrt(totalProbability);</div>
<div class="line"><span class="lineno"> 3821</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3822</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3823</span> </div>
<div class="line"><span class="lineno"> 3824</span> </div>
<div class="line"><span class="lineno"> 3825</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3826</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3827</span><span class="preprocessor">    default (none) \</span></div>
<div class="line"><span class="lineno"> 3828</span><span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,renorm,outcome) \</span></div>
<div class="line"><span class="lineno"> 3829</span><span class="preprocessor">    private   (thisTask,thisBlock,index)</span></div>
<div class="line"><span class="lineno"> 3830</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3831</span>    {</div>
<div class="line"><span class="lineno"> 3832</span>        <span class="keywordflow">if</span> (outcome==0){</div>
<div class="line"><span class="lineno"> 3833</span>            <span class="comment">// measure qubit is 0</span></div>
<div class="line"><span class="lineno"> 3834</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3835</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3836</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3837</span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3838</span>                thisBlock = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3839</span>                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3840</span>                stateVecReal[index]=stateVecReal[index]*renorm;</div>
<div class="line"><span class="lineno"> 3841</span>                stateVecImag[index]=stateVecImag[index]*renorm;</div>
<div class="line"><span class="lineno"> 3842</span> </div>
<div class="line"><span class="lineno"> 3843</span>                stateVecReal[index+sizeHalfBlock]=0;</div>
<div class="line"><span class="lineno"> 3844</span>                stateVecImag[index+sizeHalfBlock]=0;</div>
<div class="line"><span class="lineno"> 3845</span>            }</div>
<div class="line"><span class="lineno"> 3846</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3847</span>            <span class="comment">// measure qubit is 1</span></div>
<div class="line"><span class="lineno"> 3848</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3849</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3850</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3851</span>            <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3852</span>                thisBlock = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3853</span>                index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3854</span>                stateVecReal[index]=0;</div>
<div class="line"><span class="lineno"> 3855</span>                stateVecImag[index]=0;</div>
<div class="line"><span class="lineno"> 3856</span> </div>
<div class="line"><span class="lineno"> 3857</span>                stateVecReal[index+sizeHalfBlock]=stateVecReal[index+sizeHalfBlock]*renorm;</div>
<div class="line"><span class="lineno"> 3858</span>                stateVecImag[index+sizeHalfBlock]=stateVecImag[index+sizeHalfBlock]*renorm;</div>
<div class="line"><span class="lineno"> 3859</span>            }</div>
<div class="line"><span class="lineno"> 3860</span>        }</div>
<div class="line"><span class="lineno"> 3861</span>    }</div>
<div class="line"><span class="lineno"> 3862</span> </div>
<div class="line"><span class="lineno"> 3863</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01370">statevec_collapseToKnownProbOutcome()</a>.</p>

</div>
</div>
<a id="a7ea68e9132ed9db9c242353a33dba2f0" name="a7ea68e9132ed9db9c242353a33dba2f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ea68e9132ed9db9c242353a33dba2f0">&#9670;&#160;</a></span>statevec_collapseToOutcomeDistributedSetZero()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_collapseToOutcomeDistributedSetZero </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03918">3918</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3919</span>{</div>
<div class="line"><span class="lineno"> 3920</span>    <span class="comment">// ----- temp variables</span></div>
<div class="line"><span class="lineno"> 3921</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div>
<div class="line"><span class="lineno"> 3922</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3923</span> </div>
<div class="line"><span class="lineno"> 3924</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3925</span>    <span class="comment">//            find probability                                      //</span></div>
<div class="line"><span class="lineno"> 3926</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3927</span> </div>
<div class="line"><span class="lineno"> 3928</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3929</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3930</span> </div>
<div class="line"><span class="lineno"> 3931</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3932</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3933</span><span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div>
<div class="line"><span class="lineno"> 3934</span><span class="preprocessor">    private   (thisTask)</span></div>
<div class="line"><span class="lineno"> 3935</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3936</span>    {</div>
<div class="line"><span class="lineno"> 3937</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3938</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3939</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3940</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3941</span>            stateVecReal[thisTask] = 0;</div>
<div class="line"><span class="lineno"> 3942</span>            stateVecImag[thisTask] = 0;</div>
<div class="line"><span class="lineno"> 3943</span>        }</div>
<div class="line"><span class="lineno"> 3944</span>    }</div>
<div class="line"><span class="lineno"> 3945</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01370">statevec_collapseToKnownProbOutcome()</a>.</p>

</div>
</div>
<a id="a0a7a35628b1c1eb47336deb9afda5b68" name="a0a7a35628b1c1eb47336deb9afda5b68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a7a35628b1c1eb47336deb9afda5b68">&#9670;&#160;</a></span>statevec_compactUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta, and a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02126">2126</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2131</span>{</div>
<div class="line"><span class="lineno"> 2132</span> </div>
<div class="line"><span class="lineno"> 2133</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2134</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2135</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2136</span> </div>
<div class="line"><span class="lineno"> 2137</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2138</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2139</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div>
<div class="line"><span class="lineno"> 2140</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div>
<div class="line"><span class="lineno"> 2141</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2142</span> </div>
<div class="line"><span class="lineno"> 2143</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2144</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2145</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2146</span><span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2147</span><span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag,numTasks) \</span></div>
<div class="line"><span class="lineno"> 2148</span><span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 2149</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2150</span>    {</div>
<div class="line"><span class="lineno"> 2151</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2152</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2153</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2154</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2155</span>            <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2156</span>            stateRealUp = stateVecRealUp[thisTask];</div>
<div class="line"><span class="lineno"> 2157</span>            stateImagUp = stateVecImagUp[thisTask];</div>
<div class="line"><span class="lineno"> 2158</span> </div>
<div class="line"><span class="lineno"> 2159</span>            stateRealLo = stateVecRealLo[thisTask];</div>
<div class="line"><span class="lineno"> 2160</span>            stateImagLo = stateVecImagLo[thisTask];</div>
<div class="line"><span class="lineno"> 2161</span> </div>
<div class="line"><span class="lineno"> 2162</span>            <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2163</span>            stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2164</span>            stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2165</span>        }</div>
<div class="line"><span class="lineno"> 2166</span>    }</div>
<div class="line"><span class="lineno"> 2167</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00860">statevec_compactUnitary()</a>.</p>

</div>
</div>
<a id="a5ddfdb22e4704b680d67d08d9e80835b" name="a5ddfdb22e4704b680d67d08d9e80835b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ddfdb22e4704b680d67d08d9e80835b">&#9670;&#160;</a></span>statevec_compactUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_compactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01785">1785</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1786</span>{</div>
<div class="line"><span class="lineno"> 1787</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 1788</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 1789</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 1790</span> </div>
<div class="line"><span class="lineno"> 1791</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 1792</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 1793</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 1794</span> </div>
<div class="line"><span class="lineno"> 1795</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 1796</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 1797</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1800</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1801</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1802</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> alphaImag=alpha.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alphaReal=alpha.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 1803</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> betaImag=beta.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, betaReal=beta.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 1804</span> </div>
<div class="line"><span class="lineno"> 1805</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1806</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1807</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1808</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag, numTasks) \</span></div>
<div class="line"><span class="lineno"> 1809</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 1810</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1811</span>    {</div>
<div class="line"><span class="lineno"> 1812</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1813</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1814</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1815</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 1816</span> </div>
<div class="line"><span class="lineno"> 1817</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 1818</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 1819</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 1820</span> </div>
<div class="line"><span class="lineno"> 1821</span>            <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 1822</span>            stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 1823</span>            stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 1824</span> </div>
<div class="line"><span class="lineno"> 1825</span>            stateRealLo = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 1826</span>            stateImagLo = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 1827</span> </div>
<div class="line"><span class="lineno"> 1828</span>            <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 1829</span>            stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div>
<div class="line"><span class="lineno"> 1830</span>                - betaReal*stateRealLo - betaImag*stateImagLo;</div>
<div class="line"><span class="lineno"> 1831</span>            stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div>
<div class="line"><span class="lineno"> 1832</span>                - betaReal*stateImagLo + betaImag*stateRealLo;</div>
<div class="line"><span class="lineno"> 1833</span> </div>
<div class="line"><span class="lineno"> 1834</span>            <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 1835</span>            stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div>
<div class="line"><span class="lineno"> 1836</span>                + alphaReal*stateRealLo + alphaImag*stateImagLo;</div>
<div class="line"><span class="lineno"> 1837</span>            stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div>
<div class="line"><span class="lineno"> 1838</span>                + alphaReal*stateImagLo - alphaImag*stateRealLo;</div>
<div class="line"><span class="lineno"> 1839</span>        } </div>
<div class="line"><span class="lineno"> 1840</span>    }</div>
<div class="line"><span class="lineno"> 1841</span> </div>
<div class="line"><span class="lineno"> 1842</span>} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00860">statevec_compactUnitary()</a>.</p>

</div>
</div>
<a id="ae6cecbad32a03416138b321cdc1a2c33" name="ae6cecbad32a03416138b321cdc1a2c33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cecbad32a03416138b321cdc1a2c33">&#9670;&#160;</a></span>statevec_compareStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_compareStates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>mq1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>mq2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>precision</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01772">1772</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1772</span>                                                                 {</div>
<div class="line"><span class="lineno"> 1773</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> diff;</div>
<div class="line"><span class="lineno"> 1774</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize = mq1.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1775</span>    </div>
<div class="line"><span class="lineno"> 1776</span>    <span class="keywordflow">for</span> (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i=0; i&lt;chunkSize; i++){</div>
<div class="line"><span class="lineno"> 1777</span>        diff = absReal(mq1.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] - mq2.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i]);</div>
<div class="line"><span class="lineno"> 1778</span>        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1779</span>        diff = absReal(mq1.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] - mq2.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i]);</div>
<div class="line"><span class="lineno"> 1780</span>        <span class="keywordflow">if</span> (diff&gt;precision) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1781</span>    }</div>
<div class="line"><span class="lineno"> 1782</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1783</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a071baf8b6951d2a7d6529394b6f39364" name="a071baf8b6951d2a7d6529394b6f39364"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a071baf8b6951d2a7d6529394b6f39364">&#9670;&#160;</a></span>statevec_controlledCompactUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p >Only perform the rotation where the control qubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02445">2445</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2450</span>{</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2453</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2454</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2455</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2456</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2457</span> </div>
<div class="line"><span class="lineno"> 2458</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 2459</span> </div>
<div class="line"><span class="lineno"> 2460</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2461</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2462</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div>
<div class="line"><span class="lineno"> 2463</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div>
<div class="line"><span class="lineno"> 2464</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2465</span> </div>
<div class="line"><span class="lineno"> 2466</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2467</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2468</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2469</span><span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2470</span><span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag,numTasks,chunkId,chunkSize,controlQubit) \</span></div>
<div class="line"><span class="lineno"> 2471</span><span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div>
<div class="line"><span class="lineno"> 2472</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2473</span>    {</div>
<div class="line"><span class="lineno"> 2474</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2475</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2476</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2477</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2478</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 2479</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 2480</span>                <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2481</span>                stateRealUp = stateVecRealUp[thisTask];</div>
<div class="line"><span class="lineno"> 2482</span>                stateImagUp = stateVecImagUp[thisTask];</div>
<div class="line"><span class="lineno"> 2483</span> </div>
<div class="line"><span class="lineno"> 2484</span>                stateRealLo = stateVecRealLo[thisTask];</div>
<div class="line"><span class="lineno"> 2485</span>                stateImagLo = stateVecImagLo[thisTask];</div>
<div class="line"><span class="lineno"> 2486</span> </div>
<div class="line"><span class="lineno"> 2487</span>                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2488</span>                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp + rot2Real*stateRealLo + rot2Imag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2489</span>                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp + rot2Real*stateImagLo - rot2Imag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2490</span>            }</div>
<div class="line"><span class="lineno"> 2491</span>        }</div>
<div class="line"><span class="lineno"> 2492</span>    }</div>
<div class="line"><span class="lineno"> 2493</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00936">statevec_controlledCompactUnitary()</a>.</p>

</div>
</div>
<a id="a215e2d6f88dbecc0b408b3573b5e144f" name="a215e2d6f88dbecc0b408b3573b5e144f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a215e2d6f88dbecc0b408b3573b5e144f">&#9670;&#160;</a></span>statevec_controlledCompactUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledCompactUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02227">2227</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2229</span>{</div>
<div class="line"><span class="lineno"> 2230</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2231</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2232</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2233</span> </div>
<div class="line"><span class="lineno"> 2234</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2235</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2236</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2237</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2238</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2239</span> </div>
<div class="line"><span class="lineno"> 2240</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 2241</span> </div>
<div class="line"><span class="lineno"> 2242</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2243</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2244</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2245</span> </div>
<div class="line"><span class="lineno"> 2246</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2247</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2248</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2249</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> alphaImag=alpha.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, alphaReal=alpha.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 2250</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> betaImag=beta.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>, betaReal=beta.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 2251</span> </div>
<div class="line"><span class="lineno"> 2252</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2253</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2254</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2255</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, alphaReal,alphaImag, betaReal,betaImag, \</span></div>
<div class="line"><span class="lineno"> 2256</span><span class="preprocessor">                numTasks,chunkId,chunkSize,controlQubit) \</span></div>
<div class="line"><span class="lineno"> 2257</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div>
<div class="line"><span class="lineno"> 2258</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2259</span>    {</div>
<div class="line"><span class="lineno"> 2260</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2261</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2262</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2263</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2264</span> </div>
<div class="line"><span class="lineno"> 2265</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2266</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2267</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 2270</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 2271</span>                <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2272</span>                stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2273</span>                stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2274</span> </div>
<div class="line"><span class="lineno"> 2275</span>                stateRealLo = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2276</span>                stateImagLo = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2277</span> </div>
<div class="line"><span class="lineno"> 2278</span>                <span class="comment">// state[indexUp] = alpha * state[indexUp] - conj(beta)  * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2279</span>                stateVecReal[indexUp] = alphaReal*stateRealUp - alphaImag*stateImagUp </div>
<div class="line"><span class="lineno"> 2280</span>                    - betaReal*stateRealLo - betaImag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2281</span>                stateVecImag[indexUp] = alphaReal*stateImagUp + alphaImag*stateRealUp </div>
<div class="line"><span class="lineno"> 2282</span>                    - betaReal*stateImagLo + betaImag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2283</span> </div>
<div class="line"><span class="lineno"> 2284</span>                <span class="comment">// state[indexLo] = beta  * state[indexUp] + conj(alpha) * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2285</span>                stateVecReal[indexLo] = betaReal*stateRealUp - betaImag*stateImagUp </div>
<div class="line"><span class="lineno"> 2286</span>                    + alphaReal*stateRealLo + alphaImag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2287</span>                stateVecImag[indexLo] = betaReal*stateImagUp + betaImag*stateRealUp </div>
<div class="line"><span class="lineno"> 2288</span>                    + alphaReal*stateImagLo - alphaImag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2289</span>            }</div>
<div class="line"><span class="lineno"> 2290</span>        } </div>
<div class="line"><span class="lineno"> 2291</span>    }</div>
<div class="line"><span class="lineno"> 2292</span> </div>
<div class="line"><span class="lineno"> 2293</span>} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00936">statevec_controlledCompactUnitary()</a>.</p>

</div>
</div>
<a id="a393da4c4bc582a757ca8406d8501aca0" name="a393da4c4bc582a757ca8406d8501aca0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a393da4c4bc582a757ca8406d8501aca0">&#9670;&#160;</a></span>statevec_controlledNotDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p >Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk. Only perform the rotation for elements where controlQubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>the control qubit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02773">2773</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2776</span>{</div>
<div class="line"><span class="lineno"> 2777</span> </div>
<div class="line"><span class="lineno"> 2778</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2779</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2780</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2781</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2782</span> </div>
<div class="line"><span class="lineno"> 2783</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 2784</span> </div>
<div class="line"><span class="lineno"> 2785</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div>
<div class="line"><span class="lineno"> 2786</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2787</span> </div>
<div class="line"><span class="lineno"> 2788</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2789</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2790</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2791</span><span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2792</span><span class="preprocessor">                numTasks,chunkId,chunkSize,controlQubit) \</span></div>
<div class="line"><span class="lineno"> 2793</span><span class="preprocessor">    private  (thisTask,controlBit)</span></div>
<div class="line"><span class="lineno"> 2794</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2795</span>    {</div>
<div class="line"><span class="lineno"> 2796</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2797</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2798</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2799</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2800</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 2801</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 2802</span>                stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div>
<div class="line"><span class="lineno"> 2803</span>                stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div>
<div class="line"><span class="lineno"> 2804</span>            }</div>
<div class="line"><span class="lineno"> 2805</span>        }</div>
<div class="line"><span class="lineno"> 2806</span>    }</div>
<div class="line"><span class="lineno"> 2807</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, and <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01077">statevec_controlledNot()</a>.</p>

</div>
</div>
<a id="ace1482ef82b83e7f926634a67b322fc4" name="ace1482ef82b83e7f926634a67b322fc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace1482ef82b83e7f926634a67b322fc4">&#9670;&#160;</a></span>statevec_controlledNotLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02710">2710</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2711</span>{</div>
<div class="line"><span class="lineno"> 2712</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2713</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2714</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2715</span> </div>
<div class="line"><span class="lineno"> 2716</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div>
<div class="line"><span class="lineno"> 2717</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2718</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2719</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2720</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2721</span> </div>
<div class="line"><span class="lineno"> 2722</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 2723</span> </div>
<div class="line"><span class="lineno"> 2724</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2725</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2726</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2727</span> </div>
<div class="line"><span class="lineno"> 2728</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2729</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2730</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2731</span> </div>
<div class="line"><span class="lineno"> 2732</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2733</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2734</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2735</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag,numTasks,chunkId,chunkSize,controlQubit) \</span></div>
<div class="line"><span class="lineno"> 2736</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit)</span></div>
<div class="line"><span class="lineno"> 2737</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2738</span>    {</div>
<div class="line"><span class="lineno"> 2739</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2740</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2741</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2742</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2743</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2744</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2745</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2746</span> </div>
<div class="line"><span class="lineno"> 2747</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 2748</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 2749</span>                stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2750</span>                stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2751</span> </div>
<div class="line"><span class="lineno"> 2752</span>                stateVecReal[indexUp] = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2753</span>                stateVecImag[indexUp] = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2754</span> </div>
<div class="line"><span class="lineno"> 2755</span>                stateVecReal[indexLo] = stateRealUp;</div>
<div class="line"><span class="lineno"> 2756</span>                stateVecImag[indexLo] = stateImagUp;</div>
<div class="line"><span class="lineno"> 2757</span>            }</div>
<div class="line"><span class="lineno"> 2758</span>        } </div>
<div class="line"><span class="lineno"> 2759</span>    }</div>
<div class="line"><span class="lineno"> 2760</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01077">statevec_controlledNot()</a>.</p>

</div>
</div>
<a id="a790add229738945812ae2048c03d58ec" name="a790add229738945812ae2048c03d58ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a790add229738945812ae2048c03d58ec">&#9670;&#160;</a></span>statevec_controlledPauliYDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03067">3067</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3070</span>{</div>
<div class="line"><span class="lineno"> 3071</span> </div>
<div class="line"><span class="lineno"> 3072</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 3073</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3074</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3075</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3076</span> </div>
<div class="line"><span class="lineno"> 3077</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 3078</span> </div>
<div class="line"><span class="lineno"> 3079</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div>
<div class="line"><span class="lineno"> 3080</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 3081</span> </div>
<div class="line"><span class="lineno"> 3082</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3083</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3084</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3085</span><span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 3086</span><span class="preprocessor">                numTasks,chunkId,chunkSize,controlQubit,conjFac) \</span></div>
<div class="line"><span class="lineno"> 3087</span><span class="preprocessor">    private  (thisTask,controlBit)</span></div>
<div class="line"><span class="lineno"> 3088</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3089</span>    {</div>
<div class="line"><span class="lineno"> 3090</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3091</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3092</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3093</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3094</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3095</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 3096</span>                stateVecRealOut[thisTask] = conjFac * stateVecImagIn[thisTask];</div>
<div class="line"><span class="lineno"> 3097</span>                stateVecImagOut[thisTask] = conjFac * -stateVecRealIn[thisTask];</div>
<div class="line"><span class="lineno"> 3098</span>            }</div>
<div class="line"><span class="lineno"> 3099</span>        }</div>
<div class="line"><span class="lineno"> 3100</span>    }</div>
<div class="line"><span class="lineno"> 3101</span>} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, and <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01194">statevec_controlledPauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01227">statevec_controlledPauliYConj()</a>.</p>

</div>
</div>
<a id="a06fb16aa4af7c54d36052a14d3ad58a7" name="a06fb16aa4af7c54d36052a14d3ad58a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06fb16aa4af7c54d36052a14d3ad58a7">&#9670;&#160;</a></span>statevec_controlledPauliYLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPauliYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03013">3013</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3014</span>{</div>
<div class="line"><span class="lineno"> 3015</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3016</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 3017</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 3018</span> </div>
<div class="line"><span class="lineno"> 3019</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div>
<div class="line"><span class="lineno"> 3020</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 3021</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 3022</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3023</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3024</span> </div>
<div class="line"><span class="lineno"> 3025</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 3026</span> </div>
<div class="line"><span class="lineno"> 3027</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 3028</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 3029</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 3030</span> </div>
<div class="line"><span class="lineno"> 3031</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 3032</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3033</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3034</span> </div>
<div class="line"><span class="lineno"> 3035</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3036</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3037</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3038</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, numTasks,chunkId, \</span></div>
<div class="line"><span class="lineno"> 3039</span><span class="preprocessor">                chunkSize,controlQubit,conjFac) \</span></div>
<div class="line"><span class="lineno"> 3040</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,controlBit)</span></div>
<div class="line"><span class="lineno"> 3041</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3042</span>    {</div>
<div class="line"><span class="lineno"> 3043</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3044</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3045</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3046</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3047</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3048</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3049</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3050</span> </div>
<div class="line"><span class="lineno"> 3051</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(controlQubit, indexUp+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3052</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 3053</span>                stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 3054</span>                stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 3055</span> </div>
<div class="line"><span class="lineno"> 3056</span>                <span class="comment">// update under +-{{0, -i}, {i, 0}}</span></div>
<div class="line"><span class="lineno"> 3057</span>                stateVecReal[indexUp] = conjFac * stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 3058</span>                stateVecImag[indexUp] = conjFac * -stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 3059</span>                stateVecReal[indexLo] = conjFac * -stateImagUp;</div>
<div class="line"><span class="lineno"> 3060</span>                stateVecImag[indexLo] = conjFac * stateRealUp;</div>
<div class="line"><span class="lineno"> 3061</span>            }</div>
<div class="line"><span class="lineno"> 3062</span>        } </div>
<div class="line"><span class="lineno"> 3063</span>    }</div>
<div class="line"><span class="lineno"> 3064</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01194">statevec_controlledPauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01227">statevec_controlledPauliYConj()</a>.</p>

</div>
</div>
<a id="aaf78491e35d165edfd57387f9fffecbd" name="aaf78491e35d165edfd57387f9fffecbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf78491e35d165edfd57387f9fffecbd">&#9670;&#160;</a></span>statevec_controlledPhaseFlip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idQubit2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03718">3718</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3719</span>{</div>
<div class="line"><span class="lineno"> 3720</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 3721</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 3722</span>    <span class="keywordtype">int</span> bit1, bit2;</div>
<div class="line"><span class="lineno"> 3723</span> </div>
<div class="line"><span class="lineno"> 3724</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3725</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3726</span>    </div>
<div class="line"><span class="lineno"> 3727</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 3728</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3729</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3730</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3731</span> </div>
<div class="line"><span class="lineno"> 3732</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3733</span><span class="preprocessor"># pragma omp parallel for \</span></div>
<div class="line"><span class="lineno"> 3734</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3735</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, chunkId,chunkSize,idQubit1,idQubit2 ) \</span></div>
<div class="line"><span class="lineno"> 3736</span><span class="preprocessor">    private  (index,bit1,bit2) \</span></div>
<div class="line"><span class="lineno"> 3737</span><span class="preprocessor">    schedule (static)</span></div>
<div class="line"><span class="lineno"> 3738</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3739</span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3740</span>        bit1 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3741</span>        bit2 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3742</span>        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div>
<div class="line"><span class="lineno"> 3743</span>            stateVecReal [index] = - stateVecReal [index];</div>
<div class="line"><span class="lineno"> 3744</span>            stateVecImag [index] = - stateVecImag [index];</div>
<div class="line"><span class="lineno"> 3745</span>        }</div>
<div class="line"><span class="lineno"> 3746</span>    }</div>
<div class="line"><span class="lineno"> 3747</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a63df1ec14ff7cc81c3f392ac10fcc744" name="a63df1ec14ff7cc81c3f392ac10fcc744"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63df1ec14ff7cc81c3f392ac10fcc744">&#9670;&#160;</a></span>statevec_controlledPhaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idQubit1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>idQubit2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03257">3257</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3258</span>{</div>
<div class="line"><span class="lineno"> 3259</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 3260</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 3261</span>    <span class="keywordtype">int</span> bit1, bit2;</div>
<div class="line"><span class="lineno"> 3262</span>    </div>
<div class="line"><span class="lineno"> 3263</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3264</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3265</span> </div>
<div class="line"><span class="lineno"> 3266</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 3267</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3268</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3269</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3270</span>    </div>
<div class="line"><span class="lineno"> 3271</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div>
<div class="line"><span class="lineno"> 3272</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle);</div>
<div class="line"><span class="lineno"> 3273</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle);</div>
<div class="line"><span class="lineno"> 3274</span> </div>
<div class="line"><span class="lineno"> 3275</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3276</span><span class="preprocessor"># pragma omp parallel for \</span></div>
<div class="line"><span class="lineno"> 3277</span><span class="preprocessor">    default  (none)              \</span></div>
<div class="line"><span class="lineno"> 3278</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, chunkId,chunkSize, \</span></div>
<div class="line"><span class="lineno"> 3279</span><span class="preprocessor">                idQubit1,idQubit2,cosAngle,sinAngle ) \</span></div>
<div class="line"><span class="lineno"> 3280</span><span class="preprocessor">    private  (index,bit1,bit2,stateRealLo,stateImagLo) \</span></div>
<div class="line"><span class="lineno"> 3281</span><span class="preprocessor">    schedule (static)</span></div>
<div class="line"><span class="lineno"> 3282</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3283</span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3284</span>        bit1 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit1, index+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3285</span>        bit2 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (idQubit2, index+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3286</span>        <span class="keywordflow">if</span> (bit1 &amp;&amp; bit2) {</div>
<div class="line"><span class="lineno"> 3287</span>            </div>
<div class="line"><span class="lineno"> 3288</span>            stateRealLo = stateVecReal[index];</div>
<div class="line"><span class="lineno"> 3289</span>            stateImagLo = stateVecImag[index];</div>
<div class="line"><span class="lineno"> 3290</span>            </div>
<div class="line"><span class="lineno"> 3291</span>            stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div>
<div class="line"><span class="lineno"> 3292</span>            stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div>
<div class="line"><span class="lineno"> 3293</span>        }</div>
<div class="line"><span class="lineno"> 3294</span>    }</div>
<div class="line"><span class="lineno"> 3295</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a57368529b2a7e76fec423cbfe9980b22" name="a57368529b2a7e76fec423cbfe9980b22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57368529b2a7e76fec423cbfe9980b22">&#9670;&#160;</a></span>statevec_controlledUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit in the state vector of probability amplitudes, given two complex numbers alpha and beta and a subset of the state vector with upper and lower block values stored seperately. </p>
<p >Only perform the rotation where the control qubit is one.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">controlQubit</td><td>qubit to determine whether or not to perform a rotation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02507">2507</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2512</span>{</div>
<div class="line"><span class="lineno"> 2513</span> </div>
<div class="line"><span class="lineno"> 2514</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2515</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2516</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2517</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2518</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2519</span> </div>
<div class="line"><span class="lineno"> 2520</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 2521</span> </div>
<div class="line"><span class="lineno"> 2522</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2523</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2524</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div>
<div class="line"><span class="lineno"> 2525</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div>
<div class="line"><span class="lineno"> 2526</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2528</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2529</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2530</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2531</span><span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2532</span><span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag, numTasks,chunkId,chunkSize,controlQubit) \</span></div>
<div class="line"><span class="lineno"> 2533</span><span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div>
<div class="line"><span class="lineno"> 2534</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2535</span>    {</div>
<div class="line"><span class="lineno"> 2536</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2537</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2538</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2539</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2540</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, thisTask+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 2541</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 2542</span>                <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2543</span>                stateRealUp = stateVecRealUp[thisTask];</div>
<div class="line"><span class="lineno"> 2544</span>                stateImagUp = stateVecImagUp[thisTask];</div>
<div class="line"><span class="lineno"> 2545</span> </div>
<div class="line"><span class="lineno"> 2546</span>                stateRealLo = stateVecRealLo[thisTask];</div>
<div class="line"><span class="lineno"> 2547</span>                stateImagLo = stateVecImagLo[thisTask];</div>
<div class="line"><span class="lineno"> 2548</span> </div>
<div class="line"><span class="lineno"> 2549</span>                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div>
<div class="line"><span class="lineno"> 2550</span>                    + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2551</span>                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div>
<div class="line"><span class="lineno"> 2552</span>                    + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2553</span>            }</div>
<div class="line"><span class="lineno"> 2554</span>        }</div>
<div class="line"><span class="lineno"> 2555</span>    }</div>
<div class="line"><span class="lineno"> 2556</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00974">statevec_controlledUnitary()</a>.</p>

</div>
</div>
<a id="a903beb4f5d8753a964ce2dc5f9096a24" name="a903beb4f5d8753a964ce2dc5f9096a24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a903beb4f5d8753a964ce2dc5f9096a24">&#9670;&#160;</a></span>statevec_controlledUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_controlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>controlQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02367">2367</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2369</span>{</div>
<div class="line"><span class="lineno"> 2370</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2371</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2372</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2375</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2376</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2377</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2378</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2379</span> </div>
<div class="line"><span class="lineno"> 2380</span>    <span class="keywordtype">int</span> controlBit;</div>
<div class="line"><span class="lineno"> 2381</span> </div>
<div class="line"><span class="lineno"> 2382</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2383</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2384</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2385</span> </div>
<div class="line"><span class="lineno"> 2386</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2387</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2388</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2389</span> </div>
<div class="line"><span class="lineno"> 2390</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2391</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2392</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2393</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u,numTasks,chunkId,chunkSize,controlQubit) \</span></div>
<div class="line"><span class="lineno"> 2394</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo,controlBit)</span></div>
<div class="line"><span class="lineno"> 2395</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2396</span>    {</div>
<div class="line"><span class="lineno"> 2397</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2398</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2399</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2400</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2401</span> </div>
<div class="line"><span class="lineno"> 2402</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2403</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2404</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2405</span> </div>
<div class="line"><span class="lineno"> 2406</span>            controlBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (controlQubit, indexUp+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 2407</span>            <span class="keywordflow">if</span> (controlBit){</div>
<div class="line"><span class="lineno"> 2408</span>                <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2409</span>                stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2410</span>                stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2411</span> </div>
<div class="line"><span class="lineno"> 2412</span>                stateRealLo = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2413</span>                stateImagLo = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2414</span> </div>
<div class="line"><span class="lineno"> 2415</span> </div>
<div class="line"><span class="lineno"> 2416</span>                <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2417</span>                stateVecReal[indexUp] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateRealUp - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateImagUp </div>
<div class="line"><span class="lineno"> 2418</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateRealLo - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateImagLo;</div>
<div class="line"><span class="lineno"> 2419</span>                stateVecImag[indexUp] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateImagUp + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateRealUp </div>
<div class="line"><span class="lineno"> 2420</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateImagLo + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateRealLo;</div>
<div class="line"><span class="lineno"> 2421</span> </div>
<div class="line"><span class="lineno"> 2422</span>                <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2423</span>                stateVecReal[indexLo] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateRealUp  - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateImagUp </div>
<div class="line"><span class="lineno"> 2424</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateRealLo  -  u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateImagLo;</div>
<div class="line"><span class="lineno"> 2425</span>                stateVecImag[indexLo] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateImagUp + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateRealUp </div>
<div class="line"><span class="lineno"> 2426</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateImagLo + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateRealLo;</div>
<div class="line"><span class="lineno"> 2427</span>            }</div>
<div class="line"><span class="lineno"> 2428</span>        } </div>
<div class="line"><span class="lineno"> 2429</span>    }</div>
<div class="line"><span class="lineno"> 2430</span> </div>
<div class="line"><span class="lineno"> 2431</span>}</div>
<div class="ttc" id="astructComplexMatrix2_html_a3a2b60a9e00ccef054a6de3b9307c1be"><div class="ttname"><a href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">ComplexMatrix2::imag</a></div><div class="ttdeci">qreal imag[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00140">QuEST.h:140</a></div></div>
<div class="ttc" id="astructComplexMatrix2_html_a3ea98d545b67a190ee6abe936c72076f"><div class="ttname"><a href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">ComplexMatrix2::real</a></div><div class="ttdeci">qreal real[2][2]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00139">QuEST.h:139</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST_8h_source.html#l00140">ComplexMatrix2::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00139">ComplexMatrix2::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00974">statevec_controlledUnitary()</a>.</p>

</div>
</div>
<a id="af92ff38e45213eb32a3c8b9815358032" name="af92ff38e45213eb32a3c8b9815358032"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af92ff38e45213eb32a3c8b9815358032">&#9670;&#160;</a></span>statevec_copySubstateFromGPU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_copySubstateFromGPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00052">52</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>                                                                                              {</div>
<div class="line"><span class="lineno">   53</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b8fe192658d0524ec8f9f9ba0a6e68d" name="a6b8fe192658d0524ec8f9f9ba0a6e68d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b8fe192658d0524ec8f9f9ba0a6e68d">&#9670;&#160;</a></span>statevec_copySubstateToGPU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_copySubstateToGPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00049">49</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   49</span>                                                                                            {</div>
<div class="line"><span class="lineno">   50</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a365bbb1b80cb00405c8bf1a4fa1ea8e5" name="a365bbb1b80cb00405c8bf1a4fa1ea8e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a365bbb1b80cb00405c8bf1a4fa1ea8e5">&#9670;&#160;</a></span>statevec_createQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_createQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01296">1296</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1297</span>{</div>
<div class="line"><span class="lineno"> 1298</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = 1LL &lt;&lt; numQubits;</div>
<div class="line"><span class="lineno"> 1299</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmpsPerRank = numAmps/env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>    <a class="code hl_function" href="QuEST__validation_8c.html#ac513dac77e4e965a5f17c6ddc1601c49">validateMemoryAllocationSize</a>(numAmpsPerRank, __func__);</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>    <span class="keywordtype">size_t</span> arrSize = (size_t) (numAmpsPerRank * <span class="keyword">sizeof</span>(*(qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real)));</div>
<div class="line"><span class="lineno"> 1304</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real = malloc(arrSize);</div>
<div class="line"><span class="lineno"> 1305</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag = malloc(arrSize);</div>
<div class="line"><span class="lineno"> 1306</span>    <span class="keywordflow">if</span> (env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div>
<div class="line"><span class="lineno"> 1307</span>        qureg-&gt;<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = malloc(arrSize);</div>
<div class="line"><span class="lineno"> 1308</span>        qureg-&gt;<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = malloc(arrSize);</div>
<div class="line"><span class="lineno"> 1309</span>    }</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = numQubits;</div>
<div class="line"><span class="lineno"> 1312</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a> = numAmps;</div>
<div class="line"><span class="lineno"> 1313</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> = numAmpsPerRank;</div>
<div class="line"><span class="lineno"> 1314</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> = env.<a class="code hl_variable" href="structQuESTEnv.html#aa648bb336cf8598467cb62db00b9cee8">rank</a>;</div>
<div class="line"><span class="lineno"> 1315</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a> = env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>;</div>
<div class="line"><span class="lineno"> 1316</span>    qureg-&gt;<a class="code hl_variable" href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">isDensityMatrix</a> = 0;</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>    <a class="code hl_function" href="QuEST__validation_8c.html#a9065cac1b311da713ed2a7dd99cc0530">validateQuregAllocation</a>(qureg, env, __func__);</div>
<div class="line"><span class="lineno"> 1319</span>}</div>
<div class="ttc" id="aQuEST__validation_8c_html_a9065cac1b311da713ed2a7dd99cc0530"><div class="ttname"><a href="QuEST__validation_8c.html#a9065cac1b311da713ed2a7dd99cc0530">validateQuregAllocation</a></div><div class="ttdeci">void validateQuregAllocation(Qureg *qureg, QuESTEnv env, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l01054">QuEST_validation.c:1054</a></div></div>
<div class="ttc" id="aQuEST__validation_8c_html_ac513dac77e4e965a5f17c6ddc1601c49"><div class="ttname"><a href="QuEST__validation_8c.html#ac513dac77e4e965a5f17c6ddc1601c49">validateMemoryAllocationSize</a></div><div class="ttdeci">void validateMemoryAllocationSize(long long int numAmpsPerRank, const char *caller)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__validation_8c_source.html#l01050">QuEST_validation.c:1050</a></div></div>
<div class="ttc" id="astructQureg_html_a0a86e8a50ea8c998b4a0a6640c5a1218"><div class="ttname"><a href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">Qureg::numQubitsInStateVec</a></div><div class="ttdeci">int numQubitsInStateVec</div><div class="ttdoc">Number of qubits in the state-vector - this is double the number represented for mixed states.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00350">QuEST.h:350</a></div></div>
<div class="ttc" id="astructQureg_html_aa3deb7163aab90a61e755a1f200f5413"><div class="ttname"><a href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">Qureg::numChunks</a></div><div class="ttdeci">int numChunks</div><div class="ttdoc">Number of chunks the state vector is broken up into  the number of MPI processes used.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00359">QuEST.h:359</a></div></div>
<div class="ttc" id="astructQureg_html_acf78445e9435d09f44f0cc832c6aee79"><div class="ttname"><a href="structQureg.html#acf78445e9435d09f44f0cc832c6aee79">Qureg::isDensityMatrix</a></div><div class="ttdeci">int isDensityMatrix</div><div class="ttdoc">Whether this instance is a density-state representation.</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00346">QuEST.h:346</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a52ad9f9ad9b2fd6a76f6d433b3b217" name="a2a52ad9f9ad9b2fd6a76f6d433b3b217"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a52ad9f9ad9b2fd6a76f6d433b3b217">&#9670;&#160;</a></span>statevec_destroyQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_destroyQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01321">1321</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1321</span>                                                     {</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>    qureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a> = 0;</div>
<div class="line"><span class="lineno"> 1324</span>    qureg.<a class="code hl_variable" href="structQureg.html#adef4935cac95763c29164cf99b144ed4">numAmpsTotal</a> = 0;</div>
<div class="line"><span class="lineno"> 1325</span>    qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> = 0;</div>
<div class="line"><span class="lineno"> 1326</span> </div>
<div class="line"><span class="lineno"> 1327</span>    free(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real);</div>
<div class="line"><span class="lineno"> 1328</span>    free(qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag);</div>
<div class="line"><span class="lineno"> 1329</span>    <span class="keywordflow">if</span> (env.<a class="code hl_variable" href="structQuESTEnv.html#af22aacd7c9905accae28484785c193b4">numRanks</a>&gt;1){</div>
<div class="line"><span class="lineno"> 1330</span>        free(qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real);</div>
<div class="line"><span class="lineno"> 1331</span>        free(qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag);</div>
<div class="line"><span class="lineno"> 1332</span>    }</div>
<div class="line"><span class="lineno"> 1333</span>    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real = NULL;</div>
<div class="line"><span class="lineno"> 1334</span>    qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag = NULL;</div>
<div class="line"><span class="lineno"> 1335</span>    qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real = NULL;</div>
<div class="line"><span class="lineno"> 1336</span>    qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag = NULL;</div>
<div class="line"><span class="lineno"> 1337</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a430d98e35f1eae7f0815ac539057cf67" name="a430d98e35f1eae7f0815ac539057cf67"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a430d98e35f1eae7f0815ac539057cf67">&#9670;&#160;</a></span>statevec_findProbabilityOfZeroDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_findProbabilityOfZeroDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the probability of a specified qubit being in the zero state across all amplitudes held in this chunk. </p>
<p >Size of regions to skip is a multiple of chunkSize. The results are communicated and aggregated by the caller</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03544">3544</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3544</span>                                                              {</div>
<div class="line"><span class="lineno"> 3545</span>    <span class="comment">// ----- measured probability</span></div>
<div class="line"><span class="lineno"> 3546</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span></div>
<div class="line"><span class="lineno"> 3547</span>    <span class="comment">// ----- temp variables</span></div>
<div class="line"><span class="lineno"> 3548</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   <span class="comment">// task based approach for expose loop with small granularity</span></div>
<div class="line"><span class="lineno"> 3549</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3550</span> </div>
<div class="line"><span class="lineno"> 3551</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3552</span>    <span class="comment">//            find probability                                      //</span></div>
<div class="line"><span class="lineno"> 3553</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3554</span> </div>
<div class="line"><span class="lineno"> 3555</span>    <span class="comment">// initialise returned value</span></div>
<div class="line"><span class="lineno"> 3556</span>    totalProbability = 0.0;</div>
<div class="line"><span class="lineno"> 3557</span> </div>
<div class="line"><span class="lineno"> 3558</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3559</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3560</span> </div>
<div class="line"><span class="lineno"> 3561</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3562</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3563</span><span class="preprocessor">    shared    (numTasks,stateVecReal,stateVecImag) \</span></div>
<div class="line"><span class="lineno"> 3564</span><span class="preprocessor">    private   (thisTask) \</span></div>
<div class="line"><span class="lineno"> 3565</span><span class="preprocessor">    reduction ( +:totalProbability )</span></div>
<div class="line"><span class="lineno"> 3566</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3567</span>    {</div>
<div class="line"><span class="lineno"> 3568</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3569</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3570</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3571</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3572</span>            totalProbability += stateVecReal[thisTask]*stateVecReal[thisTask]</div>
<div class="line"><span class="lineno"> 3573</span>                + stateVecImag[thisTask]*stateVecImag[thisTask];</div>
<div class="line"><span class="lineno"> 3574</span>        }</div>
<div class="line"><span class="lineno"> 3575</span>    }</div>
<div class="line"><span class="lineno"> 3576</span> </div>
<div class="line"><span class="lineno"> 3577</span>    <span class="keywordflow">return</span> totalProbability;</div>
<div class="line"><span class="lineno"> 3578</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01314">statevec_calcProbOfOutcome()</a>.</p>

</div>
</div>
<a id="a8535bc15c2ff249ddddb3fde6eff1490" name="a8535bc15c2ff249ddddb3fde6eff1490"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8535bc15c2ff249ddddb3fde6eff1490">&#9670;&#160;</a></span>statevec_findProbabilityOfZeroLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> statevec_findProbabilityOfZeroLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>measureQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Measure the total probability of a specified qubit being in the zero state across all amplitudes in this chunk. </p>
<p >Size of regions to skip is less than the size of one chunk. <br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">measureQubit</td><td>qubit to measure </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>probability of qubit measureQubit being zero </dd></dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03488">3488</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3490</span>{</div>
<div class="line"><span class="lineno"> 3491</span>    <span class="comment">// ----- sizes</span></div>
<div class="line"><span class="lineno"> 3492</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock,                                  <span class="comment">// size of blocks</span></div>
<div class="line"><span class="lineno"> 3493</span>         sizeHalfBlock;                                       <span class="comment">// size of blocks halved</span></div>
<div class="line"><span class="lineno"> 3494</span>    <span class="comment">// ----- indices</span></div>
<div class="line"><span class="lineno"> 3495</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock,                                  <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 3496</span>         index;                                               <span class="comment">// current index for first half block</span></div>
<div class="line"><span class="lineno"> 3497</span>    <span class="comment">// ----- measured probability</span></div>
<div class="line"><span class="lineno"> 3498</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   totalProbability;                                  <span class="comment">// probability (returned) value</span></div>
<div class="line"><span class="lineno"> 3499</span>    <span class="comment">// ----- temp variables</span></div>
<div class="line"><span class="lineno"> 3500</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;                                   </div>
<div class="line"><span class="lineno"> 3501</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 3502</span> </div>
<div class="line"><span class="lineno"> 3503</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3504</span>    <span class="comment">//            dimensions                                            //</span></div>
<div class="line"><span class="lineno"> 3505</span>    <span class="comment">// ---------------------------------------------------------------- //</span></div>
<div class="line"><span class="lineno"> 3506</span>    sizeHalfBlock = 1LL &lt;&lt; (measureQubit);                       <span class="comment">// number of state vector elements to sum,</span></div>
<div class="line"><span class="lineno"> 3507</span>    <span class="comment">// and then the number to skip</span></div>
<div class="line"><span class="lineno"> 3508</span>    sizeBlock     = 2LL * sizeHalfBlock;                         <span class="comment">// size of blocks (pairs of measure and skip entries)</span></div>
<div class="line"><span class="lineno"> 3509</span> </div>
<div class="line"><span class="lineno"> 3510</span>    <span class="comment">// initialise returned value</span></div>
<div class="line"><span class="lineno"> 3511</span>    totalProbability = 0.0;</div>
<div class="line"><span class="lineno"> 3512</span> </div>
<div class="line"><span class="lineno"> 3513</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3514</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3515</span> </div>
<div class="line"><span class="lineno"> 3516</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3517</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3518</span><span class="preprocessor">    shared    (numTasks,sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag) \</span></div>
<div class="line"><span class="lineno"> 3519</span><span class="preprocessor">    private   (thisTask,thisBlock,index) \</span></div>
<div class="line"><span class="lineno"> 3520</span><span class="preprocessor">    reduction ( +:totalProbability )</span></div>
<div class="line"><span class="lineno"> 3521</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 3522</span>    {</div>
<div class="line"><span class="lineno"> 3523</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3524</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 3525</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3526</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3527</span>            thisBlock = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3528</span>            index     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3529</span> </div>
<div class="line"><span class="lineno"> 3530</span>            totalProbability += stateVecReal[index]*stateVecReal[index]</div>
<div class="line"><span class="lineno"> 3531</span>                + stateVecImag[index]*stateVecImag[index];</div>
<div class="line"><span class="lineno"> 3532</span>        }</div>
<div class="line"><span class="lineno"> 3533</span>    }</div>
<div class="line"><span class="lineno"> 3534</span>    <span class="keywordflow">return</span> totalProbability;</div>
<div class="line"><span class="lineno"> 3535</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01314">statevec_calcProbOfOutcome()</a>.</p>

</div>
</div>
<a id="abea6570b95fdfa102511ccd1fcb30685" name="abea6570b95fdfa102511ccd1fcb30685"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abea6570b95fdfa102511ccd1fcb30685">&#9670;&#160;</a></span>statevec_hadamardDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamardDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{1,1},{1,-1}}/sqrt2. </p>
<p >Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03170">3170</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3175</span>{</div>
<div class="line"><span class="lineno"> 3176</span> </div>
<div class="line"><span class="lineno"> 3177</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 3178</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 3179</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3180</span> </div>
<div class="line"><span class="lineno"> 3181</span>    <span class="keywordtype">int</span> sign;</div>
<div class="line"><span class="lineno"> 3182</span>    <span class="keywordflow">if</span> (updateUpper) sign=1;</div>
<div class="line"><span class="lineno"> 3183</span>    <span class="keywordflow">else</span> sign=-1;</div>
<div class="line"><span class="lineno"> 3184</span> </div>
<div class="line"><span class="lineno"> 3185</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> recRoot2 = 1.0/sqrt(2);</div>
<div class="line"><span class="lineno"> 3186</span> </div>
<div class="line"><span class="lineno"> 3187</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div>
<div class="line"><span class="lineno"> 3188</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div>
<div class="line"><span class="lineno"> 3189</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 3190</span> </div>
<div class="line"><span class="lineno"> 3191</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3192</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3193</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3194</span><span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 3195</span><span class="preprocessor">            recRoot2, sign, numTasks) \</span></div>
<div class="line"><span class="lineno"> 3196</span><span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 3197</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3198</span>    {</div>
<div class="line"><span class="lineno"> 3199</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3200</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3201</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3202</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3203</span>            <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 3204</span>            stateRealUp = stateVecRealUp[thisTask];</div>
<div class="line"><span class="lineno"> 3205</span>            stateImagUp = stateVecImagUp[thisTask];</div>
<div class="line"><span class="lineno"> 3206</span> </div>
<div class="line"><span class="lineno"> 3207</span>            stateRealLo = stateVecRealLo[thisTask];</div>
<div class="line"><span class="lineno"> 3208</span>            stateImagLo = stateVecImagLo[thisTask];</div>
<div class="line"><span class="lineno"> 3209</span> </div>
<div class="line"><span class="lineno"> 3210</span>            stateVecRealOut[thisTask] = recRoot2*(stateRealUp + sign*stateRealLo);</div>
<div class="line"><span class="lineno"> 3211</span>            stateVecImagOut[thisTask] = recRoot2*(stateImagUp + sign*stateImagLo);</div>
<div class="line"><span class="lineno"> 3212</span>        }</div>
<div class="line"><span class="lineno"> 3213</span>    }</div>
<div class="line"><span class="lineno"> 3214</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, and <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01260">statevec_hadamard()</a>.</p>

</div>
</div>
<a id="a86dbcc3db99294add9964741e19fbdab" name="a86dbcc3db99294add9964741e19fbdab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86dbcc3db99294add9964741e19fbdab">&#9670;&#160;</a></span>statevec_hadamardLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_hadamardLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03109">3109</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3110</span>{</div>
<div class="line"><span class="lineno"> 3111</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3112</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 3113</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 3114</span> </div>
<div class="line"><span class="lineno"> 3115</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 3116</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 3117</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 3118</span> </div>
<div class="line"><span class="lineno"> 3119</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 3120</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 3121</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 3122</span> </div>
<div class="line"><span class="lineno"> 3123</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 3124</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3125</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3126</span> </div>
<div class="line"><span class="lineno"> 3127</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> recRoot2 = 1.0/sqrt(2);</div>
<div class="line"><span class="lineno"> 3128</span> </div>
<div class="line"><span class="lineno"> 3129</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3130</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3131</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3132</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, recRoot2, numTasks) \</span></div>
<div class="line"><span class="lineno"> 3133</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 3134</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3135</span>    {</div>
<div class="line"><span class="lineno"> 3136</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3137</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3138</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3139</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3140</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3141</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3142</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 3143</span> </div>
<div class="line"><span class="lineno"> 3144</span>            stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 3145</span>            stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 3146</span> </div>
<div class="line"><span class="lineno"> 3147</span>            stateRealLo = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 3148</span>            stateImagLo = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 3149</span> </div>
<div class="line"><span class="lineno"> 3150</span>            stateVecReal[indexUp] = recRoot2*(stateRealUp + stateRealLo);</div>
<div class="line"><span class="lineno"> 3151</span>            stateVecImag[indexUp] = recRoot2*(stateImagUp + stateImagLo);</div>
<div class="line"><span class="lineno"> 3152</span> </div>
<div class="line"><span class="lineno"> 3153</span>            stateVecReal[indexLo] = recRoot2*(stateRealUp - stateRealLo);</div>
<div class="line"><span class="lineno"> 3154</span>            stateVecImag[indexLo] = recRoot2*(stateImagUp - stateImagLo);</div>
<div class="line"><span class="lineno"> 3155</span>        } </div>
<div class="line"><span class="lineno"> 3156</span>    }</div>
<div class="line"><span class="lineno"> 3157</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01260">statevec_hadamard()</a>.</p>

</div>
</div>
<a id="a758bad4237ff0bf3b4ff5be626a982ae" name="a758bad4237ff0bf3b4ff5be626a982ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a758bad4237ff0bf3b4ff5be626a982ae">&#9670;&#160;</a></span>statevec_initBlankState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initBlankState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01503">1503</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1504</span>{</div>
<div class="line"><span class="lineno"> 1505</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 1506</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1507</span> </div>
<div class="line"><span class="lineno"> 1508</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1509</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1510</span> </div>
<div class="line"><span class="lineno"> 1511</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1512</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1513</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>    <span class="comment">// initialise the state-vector to all-zeroes</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1517</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1519</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div>
<div class="line"><span class="lineno"> 1520</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1521</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1522</span>    {</div>
<div class="line"><span class="lineno"> 1523</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1524</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1525</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1526</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 1527</span>            stateVecReal[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1528</span>            stateVecImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1529</span>        }</div>
<div class="line"><span class="lineno"> 1530</span>    }</div>
<div class="line"><span class="lineno"> 1531</span>}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l01533">statevec_initZeroState()</a>.</p>

</div>
</div>
<a id="a288dc4b46bdacd69cbf4a6fd070d26a7" name="a288dc4b46bdacd69cbf4a6fd070d26a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288dc4b46bdacd69cbf4a6fd070d26a7">&#9670;&#160;</a></span>statevec_initClassicalState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initClassicalState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>stateInd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01575">1575</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1576</span>{</div>
<div class="line"><span class="lineno"> 1577</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 1578</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1581</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1584</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1585</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1586</span> </div>
<div class="line"><span class="lineno"> 1587</span>    <span class="comment">// initialise the state to vector to all zeros</span></div>
<div class="line"><span class="lineno"> 1588</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1589</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1590</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1591</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag) \</span></div>
<div class="line"><span class="lineno"> 1592</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1593</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1594</span>    {</div>
<div class="line"><span class="lineno"> 1595</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1596</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1597</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1598</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 1599</span>            stateVecReal[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1600</span>            stateVecImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1601</span>        }</div>
<div class="line"><span class="lineno"> 1602</span>    }</div>
<div class="line"><span class="lineno"> 1603</span> </div>
<div class="line"><span class="lineno"> 1604</span>    <span class="comment">// give the specified classical state prob 1</span></div>
<div class="line"><span class="lineno"> 1605</span>    <span class="keywordflow">if</span> (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> == stateInd/stateVecSize){</div>
<div class="line"><span class="lineno"> 1606</span>        stateVecReal[stateInd % stateVecSize] = 1.0;</div>
<div class="line"><span class="lineno"> 1607</span>        stateVecImag[stateInd % stateVecSize] = 0.0;</div>
<div class="line"><span class="lineno"> 1608</span>    }</div>
<div class="line"><span class="lineno"> 1609</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad9fd3017ea40cf63fd04b39e03494972" name="ad9fd3017ea40cf63fd04b39e03494972"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9fd3017ea40cf63fd04b39e03494972">&#9670;&#160;</a></span>statevec_initDebugState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initDebugState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes to an (unphysical) state with each component of each probability amplitude a unique floating point value. </p>
<p >For debugging processes </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits to be initialised </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01696">1696</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1697</span>{</div>
<div class="line"><span class="lineno"> 1698</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize;</div>
<div class="line"><span class="lineno"> 1699</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1700</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexOffset;</div>
<div class="line"><span class="lineno"> 1701</span> </div>
<div class="line"><span class="lineno"> 1702</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1703</span>    chunkSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1704</span> </div>
<div class="line"><span class="lineno"> 1705</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1706</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1707</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>    indexOffset = chunkSize * qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>    <span class="comment">// initialise the state to |0000..0000&gt;</span></div>
<div class="line"><span class="lineno"> 1712</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1713</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1714</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1715</span><span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, indexOffset) \</span></div>
<div class="line"><span class="lineno"> 1716</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1717</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1718</span>    {</div>
<div class="line"><span class="lineno"> 1719</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1720</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1721</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1722</span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div>
<div class="line"><span class="lineno"> 1723</span>            stateVecReal[index] = ((indexOffset + index)*2.0)/10.0;</div>
<div class="line"><span class="lineno"> 1724</span>            stateVecImag[index] = ((indexOffset + index)*2.0+1.0)/10.0;</div>
<div class="line"><span class="lineno"> 1725</span>        }</div>
<div class="line"><span class="lineno"> 1726</span>    }</div>
<div class="line"><span class="lineno"> 1727</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a482fc361fd5f08075404c72e536316a0" name="a482fc361fd5f08075404c72e536316a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a482fc361fd5f08075404c72e536316a0">&#9670;&#160;</a></span>statevec_initPlusState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initPlusState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01543">1543</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1544</span>{</div>
<div class="line"><span class="lineno"> 1545</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div>
<div class="line"><span class="lineno"> 1546</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1549</span>    chunkSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1550</span>    stateVecSize = chunkSize*qureg.<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div>
<div class="line"><span class="lineno"> 1551</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> normFactor = 1.0/sqrt((<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>)stateVecSize);</div>
<div class="line"><span class="lineno"> 1552</span> </div>
<div class="line"><span class="lineno"> 1553</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1554</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1555</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1556</span> </div>
<div class="line"><span class="lineno"> 1557</span>    <span class="comment">// initialise the state to |+++..+++&gt; = 1/normFactor {1, 1, 1, ...}</span></div>
<div class="line"><span class="lineno"> 1558</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1559</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1560</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1561</span><span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor) \</span></div>
<div class="line"><span class="lineno"> 1562</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1563</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1564</span>    {</div>
<div class="line"><span class="lineno"> 1565</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1566</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1567</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1568</span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div>
<div class="line"><span class="lineno"> 1569</span>            stateVecReal[index] = normFactor;</div>
<div class="line"><span class="lineno"> 1570</span>            stateVecImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1571</span>        }</div>
<div class="line"><span class="lineno"> 1572</span>    }</div>
<div class="line"><span class="lineno"> 1573</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a05756b45f10135bb2eeb07380f806c20" name="a05756b45f10135bb2eeb07380f806c20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05756b45f10135bb2eeb07380f806c20">&#9670;&#160;</a></span>statevec_initStateFromSingleFile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int statevec_initStateFromSingleFile </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>filename</em>[200], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01730">1730</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1730</span>                                                                                    {</div>
<div class="line"><span class="lineno"> 1731</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div>
<div class="line"><span class="lineno"> 1732</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> indexInChunk, totalIndex;</div>
<div class="line"><span class="lineno"> 1733</span> </div>
<div class="line"><span class="lineno"> 1734</span>    chunkSize = qureg-&gt;<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1735</span>    stateVecSize = chunkSize*qureg-&gt;<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div>
<div class="line"><span class="lineno"> 1736</span> </div>
<div class="line"><span class="lineno"> 1737</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1738</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1739</span> </div>
<div class="line"><span class="lineno"> 1740</span>    FILE *fp;</div>
<div class="line"><span class="lineno"> 1741</span>    <span class="keywordtype">char</span> <a class="code hl_variable" href="cuda__to__hip_8h.html#a6beead53361e7874b4ead6b1c6bba2cf">line</a>[200];</div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rank=0; rank&lt;(qureg-&gt;<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>); rank++){</div>
<div class="line"><span class="lineno"> 1744</span>        <span class="keywordflow">if</span> (rank==qureg-&gt;<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>){</div>
<div class="line"><span class="lineno"> 1745</span>            fp = fopen(filename, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno"> 1746</span>            </div>
<div class="line"><span class="lineno"> 1747</span>            <span class="comment">// indicate file open failure</span></div>
<div class="line"><span class="lineno"> 1748</span>            <span class="keywordflow">if</span> (fp == NULL)</div>
<div class="line"><span class="lineno"> 1749</span>                <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno"> 1750</span>            </div>
<div class="line"><span class="lineno"> 1751</span>            indexInChunk = 0; totalIndex = 0;</div>
<div class="line"><span class="lineno"> 1752</span>            <span class="keywordflow">while</span> (fgets(<a class="code hl_variable" href="cuda__to__hip_8h.html#a6beead53361e7874b4ead6b1c6bba2cf">line</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>)*200, fp) != NULL &amp;&amp; totalIndex&lt;stateVecSize){</div>
<div class="line"><span class="lineno"> 1753</span>                <span class="keywordflow">if</span> (<a class="code hl_variable" href="cuda__to__hip_8h.html#a6beead53361e7874b4ead6b1c6bba2cf">line</a>[0]!=<span class="charliteral">&#39;#&#39;</span>){</div>
<div class="line"><span class="lineno"> 1754</span>                    <span class="keywordtype">int</span> chunkId = (int) (totalIndex/chunkSize);</div>
<div class="line"><span class="lineno"> 1755</span>                    <span class="keywordflow">if</span> (chunkId==qureg-&gt;<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>){</div>
<div class="line"><span class="lineno"> 1756</span>                        sscanf(<a class="code hl_variable" href="cuda__to__hip_8h.html#a6beead53361e7874b4ead6b1c6bba2cf">line</a>, REAL_SPECIFIER <span class="stringliteral">&quot;, &quot;</span> REAL_SPECIFIER, &amp;(stateVecReal[indexInChunk]),</div>
<div class="line"><span class="lineno"> 1757</span>                                &amp;(stateVecImag[indexInChunk])); </div>
<div class="line"><span class="lineno"> 1758</span>                        indexInChunk += 1;</div>
<div class="line"><span class="lineno"> 1759</span>                    }</div>
<div class="line"><span class="lineno"> 1760</span>                    totalIndex += 1;</div>
<div class="line"><span class="lineno"> 1761</span>                }</div>
<div class="line"><span class="lineno"> 1762</span>            }   </div>
<div class="line"><span class="lineno"> 1763</span>            fclose(fp);</div>
<div class="line"><span class="lineno"> 1764</span>        }</div>
<div class="line"><span class="lineno"> 1765</span>        <a class="code hl_function" href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div>
<div class="line"><span class="lineno"> 1766</span>    }</div>
<div class="line"><span class="lineno"> 1767</span>    </div>
<div class="line"><span class="lineno"> 1768</span>    <span class="comment">// indicate success</span></div>
<div class="line"><span class="lineno"> 1769</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno"> 1770</span>}</div>
<div class="ttc" id="acuda__to__hip_8h_html_a6beead53361e7874b4ead6b1c6bba2cf"><div class="ttname"><a href="cuda__to__hip_8h.html#a6beead53361e7874b4ead6b1c6bba2cf">line</a></div><div class="ttdeci">static void const char *const const int line</div><div class="ttdef"><b>Definition:</b> <a href="cuda__to__hip_8h_source.html#l00061">cuda_to_hip.h:62</a></div></div>
<div class="ttc" id="agroup__debug_html_ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77"><div class="ttname"><a href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a></div><div class="ttdeci">void syncQuESTEnv(QuESTEnv env)</div><div class="ttdoc">Guarantees that all code up to the given point has been executed on all nodes (if running in distribu...</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__distributed_8c_source.html#l00166">QuEST_cpu_distributed.c:166</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a923906770cac0da9e3459bae58de9e64" name="a923906770cac0da9e3459bae58de9e64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a923906770cac0da9e3459bae58de9e64">&#9670;&#160;</a></span>statevec_initStateOfSingleQubit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initStateOfSingleQubit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a> *&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qubitId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>outcome</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the state vector of probability amplitudes such that one qubit is set to 'outcome' and all other qubits are in an equal superposition of zero and one. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits to be initialised </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">qubitId</td><td>id of qubit to set to state 'outcome' </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outcome</td><td>of qubit 'qubitId' </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01650">1650</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1651</span>{</div>
<div class="line"><span class="lineno"> 1652</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize, stateVecSize;</div>
<div class="line"><span class="lineno"> 1653</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1654</span>    <span class="keywordtype">int</span> bit;</div>
<div class="line"><span class="lineno"> 1655</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg-&gt;<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 1656</span> </div>
<div class="line"><span class="lineno"> 1657</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 1658</span>    chunkSize = qureg-&gt;<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1659</span>    stateVecSize = chunkSize*qureg-&gt;<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>;</div>
<div class="line"><span class="lineno"> 1660</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> normFactor = 1.0/sqrt((<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>)stateVecSize/2.0);</div>
<div class="line"><span class="lineno"> 1661</span> </div>
<div class="line"><span class="lineno"> 1662</span>    <span class="comment">// Can&#39;t use qureg-&gt;stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1663</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1664</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg-&gt;<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1665</span> </div>
<div class="line"><span class="lineno"> 1666</span>    <span class="comment">// initialise the state to |0000..0000&gt;</span></div>
<div class="line"><span class="lineno"> 1667</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1668</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1669</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1670</span><span class="preprocessor">    shared   (chunkSize, stateVecReal, stateVecImag, normFactor, qubitId, outcome, chunkId) \</span></div>
<div class="line"><span class="lineno"> 1671</span><span class="preprocessor">    private  (index, bit)</span></div>
<div class="line"><span class="lineno"> 1672</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1673</span>    {</div>
<div class="line"><span class="lineno"> 1674</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1675</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1676</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1677</span>        <span class="keywordflow">for</span> (index=0; index&lt;chunkSize; index++) {</div>
<div class="line"><span class="lineno"> 1678</span>            bit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(qubitId, index+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 1679</span>            <span class="keywordflow">if</span> (bit==outcome) {</div>
<div class="line"><span class="lineno"> 1680</span>                stateVecReal[index] = normFactor;</div>
<div class="line"><span class="lineno"> 1681</span>                stateVecImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1682</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1683</span>                stateVecReal[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1684</span>                stateVecImag[index] = 0.0;</div>
<div class="line"><span class="lineno"> 1685</span>            }</div>
<div class="line"><span class="lineno"> 1686</span>        }</div>
<div class="line"><span class="lineno"> 1687</span>    }</div>
<div class="line"><span class="lineno"> 1688</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ca0c6ba07ab2b4b437321bf17efc966" name="a2ca0c6ba07ab2b4b437321bf17efc966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca0c6ba07ab2b4b437321bf17efc966">&#9670;&#160;</a></span>statevec_initZeroState()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_initZeroState </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01533">1533</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1534</span>{</div>
<div class="line"><span class="lineno"> 1535</span>    <a class="code hl_function" href="QuEST__cpu_8c.html#a758bad4237ff0bf3b4ff5be626a982ae">statevec_initBlankState</a>(qureg);</div>
<div class="line"><span class="lineno"> 1536</span>    <span class="keywordflow">if</span> (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==0){</div>
<div class="line"><span class="lineno"> 1537</span>        <span class="comment">// zero state |0000..0000&gt; has probability 1</span></div>
<div class="line"><span class="lineno"> 1538</span>        qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[0] = 1.0;</div>
<div class="line"><span class="lineno"> 1539</span>        qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[0] = 0.0;</div>
<div class="line"><span class="lineno"> 1540</span>    }</div>
<div class="line"><span class="lineno"> 1541</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_a758bad4237ff0bf3b4ff5be626a982ae"><div class="ttname"><a href="QuEST__cpu_8c.html#a758bad4237ff0bf3b4ff5be626a982ae">statevec_initBlankState</a></div><div class="ttdeci">void statevec_initBlankState(Qureg qureg)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01503">QuEST_cpu.c:1503</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6f0c9ed9261afbab4712e056a88763d" name="ae6f0c9ed9261afbab4712e056a88763d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6f0c9ed9261afbab4712e056a88763d">&#9670;&#160;</a></span>statevec_multiControlledMultiQubitNotDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledMultiQubitNotDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02865">2865</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2869</span>  {</div>
<div class="line"><span class="lineno"> 2870</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2871</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalOffset = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * numAmps;</div>
<div class="line"><span class="lineno"> 2872</span>    </div>
<div class="line"><span class="lineno"> 2873</span>    <span class="comment">/* stateVecOut is qureg&#39;s local state-vector partition, which we modify.</span></div>
<div class="line"><span class="lineno"> 2874</span><span class="comment">     * stateVecIn is the pair node&#39;s state-vector partition, in an order which </span></div>
<div class="line"><span class="lineno"> 2875</span><span class="comment">     * does not necessarily correlate to stateVecOut&#39;s </span></div>
<div class="line"><span class="lineno"> 2876</span><span class="comment">     */</span></div>
<div class="line"><span class="lineno"> 2877</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* inReal = stateVecIn.real;</div>
<div class="line"><span class="lineno"> 2878</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* inImag = stateVecIn.imag;</div>
<div class="line"><span class="lineno"> 2879</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* outReal = stateVecOut.real;</div>
<div class="line"><span class="lineno"> 2880</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* outImag = stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2881</span>    </div>
<div class="line"><span class="lineno"> 2882</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> outInd, outIndGlobal, inInd, inIndGlobal;</div>
<div class="line"><span class="lineno"> 2883</span>    </div>
<div class="line"><span class="lineno"> 2884</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2885</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2886</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2887</span><span class="preprocessor">    shared   (inReal,inImag,outReal,outImag, numAmps,globalOffset, ctrlMask,targMask) \</span></div>
<div class="line"><span class="lineno"> 2888</span><span class="preprocessor">    private  (outInd,outIndGlobal, inInd,inIndGlobal)</span></div>
<div class="line"><span class="lineno"> 2889</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2890</span>    {</div>
<div class="line"><span class="lineno"> 2891</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2892</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2893</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2894</span>        <span class="keywordflow">for</span> (outInd = 0; outInd &lt; numAmps; outInd++) {</div>
<div class="line"><span class="lineno"> 2895</span>            </div>
<div class="line"><span class="lineno"> 2896</span>            <span class="comment">// modify amplitude only if control qubits are 1 for this state</span></div>
<div class="line"><span class="lineno"> 2897</span>            outIndGlobal = outInd + globalOffset;</div>
<div class="line"><span class="lineno"> 2898</span>            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; outIndGlobal) != ctrlMask))</div>
<div class="line"><span class="lineno"> 2899</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2900</span>            <span class="comment">/* it is a premature optimisation to remove this seemingly wasteful abort above,</span></div>
<div class="line"><span class="lineno"> 2901</span><span class="comment">             * because the maximum skipped amplitudes is 1/2 that stored in the node </span></div>
<div class="line"><span class="lineno"> 2902</span><span class="comment">             * (since this function is not called if all amps should be skipped)</span></div>
<div class="line"><span class="lineno"> 2903</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 2904</span>             </div>
<div class="line"><span class="lineno"> 2905</span>            <span class="comment">/* unlike statevec_controlledNotDistributed(), we cannot assume stateVecOut </span></div>
<div class="line"><span class="lineno"> 2906</span><span class="comment">             * maps contiguously/parallel into stateVecIn; we must map each amplitude, bit-wise.</span></div>
<div class="line"><span class="lineno"> 2907</span><span class="comment">             * However, the arithmetic doesn&#39;t necessitate knowing the rank of stateVecIn </span></div>
<div class="line"><span class="lineno"> 2908</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 2909</span>            inIndGlobal = outIndGlobal ^ targMask;</div>
<div class="line"><span class="lineno"> 2910</span>            inInd = inIndGlobal % numAmps;              <span class="comment">// = inIndGlobal - pairRank * numAmps</span></div>
<div class="line"><span class="lineno"> 2911</span>            </div>
<div class="line"><span class="lineno"> 2912</span>            outReal[outInd] = inReal[inInd];</div>
<div class="line"><span class="lineno"> 2913</span>            outImag[outInd] = inImag[inInd];</div>
<div class="line"><span class="lineno"> 2914</span>        }</div>
<div class="line"><span class="lineno"> 2915</span>    }</div>
<div class="line"><span class="lineno"> 2916</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, and <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01099">statevec_multiControlledMultiQubitNot()</a>.</p>

</div>
</div>
<a id="ac7d30ce54573c75b35386cd0e284adc5" name="ac7d30ce54573c75b35386cd0e284adc5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7d30ce54573c75b35386cd0e284adc5">&#9670;&#160;</a></span>statevec_multiControlledMultiQubitNotLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledMultiQubitNotLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targMask</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02809">2809</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2809</span>                                                                                         {</div>
<div class="line"><span class="lineno"> 2810</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2811</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2812</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* stateIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2813</span>    </div>
<div class="line"><span class="lineno"> 2814</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalOffset = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * numAmps;</div>
<div class="line"><span class="lineno"> 2815</span>    </div>
<div class="line"><span class="lineno"> 2816</span>    <span class="comment">// each amplitude is swapped with a &#39;mate&#39; amplitude</span></div>
<div class="line"><span class="lineno"> 2817</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ampInd, mateInd, globalInd;</div>
<div class="line"><span class="lineno"> 2818</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> mateRe, mateIm;</div>
<div class="line"><span class="lineno"> 2819</span> </div>
<div class="line"><span class="lineno"> 2820</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2821</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2822</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2823</span><span class="preprocessor">    shared   (stateRe,stateIm, numAmps, ctrlMask,targMask, globalOffset) \</span></div>
<div class="line"><span class="lineno"> 2824</span><span class="preprocessor">    private  (ampInd, mateInd,mateRe,mateIm, globalInd)</span></div>
<div class="line"><span class="lineno"> 2825</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2826</span>    {</div>
<div class="line"><span class="lineno"> 2827</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2828</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2829</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2830</span>        <span class="keywordflow">for</span> (ampInd = 0; ampInd &lt; numAmps; ampInd++) {</div>
<div class="line"><span class="lineno"> 2831</span>            </div>
<div class="line"><span class="lineno"> 2832</span>            <span class="comment">/* it may be a premature optimisation to remove the seemingly wasteful continues below,</span></div>
<div class="line"><span class="lineno"> 2833</span><span class="comment">             * because the maximum skipped amplitudes is 1/2 that stored in the node </span></div>
<div class="line"><span class="lineno"> 2834</span><span class="comment">             * (e.g. since this function is not called if all amps should be skipped via controls),</span></div>
<div class="line"><span class="lineno"> 2835</span><span class="comment">             * and since we&#39;re memory-bandwidth bottlenecked. </span></div>
<div class="line"><span class="lineno"> 2836</span><span class="comment">             */</span></div>
<div class="line"><span class="lineno"> 2837</span>             </div>
<div class="line"><span class="lineno"> 2838</span>            <span class="comment">// although amps are local, we may still be running in distributed mode, </span></div>
<div class="line"><span class="lineno"> 2839</span>            <span class="comment">// and hence need to consult the global index to determine the values of </span></div>
<div class="line"><span class="lineno"> 2840</span>            <span class="comment">// the control qubits</span></div>
<div class="line"><span class="lineno"> 2841</span>            globalInd = ampInd + globalOffset;</div>
<div class="line"><span class="lineno"> 2842</span>            </div>
<div class="line"><span class="lineno"> 2843</span>            <span class="comment">// modify amplitude only if control qubits are 1 for this state</span></div>
<div class="line"><span class="lineno"> 2844</span>            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; globalInd) != ctrlMask))</div>
<div class="line"><span class="lineno"> 2845</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2846</span> </div>
<div class="line"><span class="lineno"> 2847</span>            mateInd = ampInd ^ targMask;</div>
<div class="line"><span class="lineno"> 2848</span>            </div>
<div class="line"><span class="lineno"> 2849</span>            <span class="comment">// if the mate is behind, it was already processed</span></div>
<div class="line"><span class="lineno"> 2850</span>            <span class="keywordflow">if</span> (mateInd &lt; ampInd)</div>
<div class="line"><span class="lineno"> 2851</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2852</span>            </div>
<div class="line"><span class="lineno"> 2853</span>            mateRe = stateRe[mateInd];</div>
<div class="line"><span class="lineno"> 2854</span>            mateIm = stateIm[mateInd];</div>
<div class="line"><span class="lineno"> 2855</span>            </div>
<div class="line"><span class="lineno"> 2856</span>            <span class="comment">// swap amp with mate</span></div>
<div class="line"><span class="lineno"> 2857</span>            stateRe[mateInd] = stateRe[ampInd];</div>
<div class="line"><span class="lineno"> 2858</span>            stateIm[mateInd] = stateIm[ampInd];</div>
<div class="line"><span class="lineno"> 2859</span>            stateRe[ampInd] = mateRe;</div>
<div class="line"><span class="lineno"> 2860</span>            stateIm[ampInd] = mateIm;</div>
<div class="line"><span class="lineno"> 2861</span>        }</div>
<div class="line"><span class="lineno"> 2862</span>    }</div>
<div class="line"><span class="lineno"> 2863</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01099">statevec_multiControlledMultiQubitNot()</a>.</p>

</div>
</div>
<a id="a0aedcccfa50c7aaa8b7fc4c14d7cdfb8" name="a0aedcccfa50c7aaa8b7fc4c14d7cdfb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aedcccfa50c7aaa8b7fc4c14d7cdfb8">&#9670;&#160;</a></span>statevec_multiControlledMultiQubitUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledMultiQubitUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>targs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numTargs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrixN.html">ComplexMatrixN</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01943">1943</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1944</span>{</div>
<div class="line"><span class="lineno"> 1945</span>    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1946</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1947</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1948</span>    </div>
<div class="line"><span class="lineno"> 1949</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> &gt;&gt; numTargs;  <span class="comment">// kernel called on every 1 in 2^numTargs amplitudes</span></div>
<div class="line"><span class="lineno"> 1950</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTargAmps = 1 &lt;&lt; u.<a class="code hl_variable" href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">numQubits</a>;  <span class="comment">// num amps to be modified by each task</span></div>
<div class="line"><span class="lineno"> 1951</span>    </div>
<div class="line"><span class="lineno"> 1952</span>    <span class="comment">// the global (between all nodes) index of this node&#39;s start index</span></div>
<div class="line"><span class="lineno"> 1953</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndStart = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; </div>
<div class="line"><span class="lineno"> 1954</span>    </div>
<div class="line"><span class="lineno"> 1955</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno"> 1956</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisInd00; <span class="comment">// this thread&#39;s index of |..0..0..&gt; (target qubits = 0) </span></div>
<div class="line"><span class="lineno"> 1957</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisGlobalInd00; <span class="comment">// the global (between all nodes) index of this thread&#39;s |..0..0..&gt; state</span></div>
<div class="line"><span class="lineno"> 1958</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind;   <span class="comment">// each thread&#39;s iteration of amplitudes to modify</span></div>
<div class="line"><span class="lineno"> 1959</span>    <span class="keywordtype">int</span> i, t, r, c;  <span class="comment">// each thread&#39;s iteration of amps and targets </span></div>
<div class="line"><span class="lineno"> 1960</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> reElem, imElem;  <span class="comment">// each thread&#39;s iteration of u elements</span></div>
<div class="line"><span class="lineno"> 1961</span>    </div>
<div class="line"><span class="lineno"> 1962</span>    <span class="comment">// each thread/task will record and modify numTargAmps amplitudes, privately</span></div>
<div class="line"><span class="lineno"> 1963</span>    <span class="comment">// (of course, tasks eliminated by the ctrlMask won&#39;t edit their allocation)</span></div>
<div class="line"><span class="lineno"> 1964</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1965</span>    <span class="comment">// If we&#39;re NOT on windows, we can fortunately use the stack directly</span></div>
<div class="line"><span class="lineno"> 1966</span><span class="preprocessor">    #ifndef _WIN32</span></div>
<div class="line"><span class="lineno"> 1967</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ampInds[numTargAmps];</div>
<div class="line"><span class="lineno"> 1968</span>        <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> reAmps[numTargAmps];</div>
<div class="line"><span class="lineno"> 1969</span>        <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> imAmps[numTargAmps];</div>
<div class="line"><span class="lineno"> 1970</span> </div>
<div class="line"><span class="lineno"> 1971</span>        <span class="keywordtype">int</span> sortedTargs[numTargs];</div>
<div class="line"><span class="lineno"> 1972</span>    <span class="comment">// on Windows, with no VLA, we can use _malloca to allocate on stack (must free)</span></div>
<div class="line"><span class="lineno"> 1973</span><span class="preprocessor">    #else</span></div>
<div class="line"><span class="lineno"> 1974</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>* ampInds;</div>
<div class="line"><span class="lineno"> 1975</span>        <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* reAmps;</div>
<div class="line"><span class="lineno"> 1976</span>        <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* imAmps;</div>
<div class="line"><span class="lineno"> 1977</span>        <span class="keywordtype">int</span>* sortedTargs = (<span class="keywordtype">int</span>*) _malloca(numTargs * <span class="keyword">sizeof</span> *sortedTargs);</div>
<div class="line"><span class="lineno"> 1978</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 1979</span> </div>
<div class="line"><span class="lineno"> 1980</span>    <span class="comment">// we need a sorted targets list to find thisInd00 for each task.</span></div>
<div class="line"><span class="lineno"> 1981</span>    <span class="comment">// we can&#39;t modify targets, because the user-ordering of targets matters in u</span></div>
<div class="line"><span class="lineno"> 1982</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t=0; t &lt; numTargs; t++) </div>
<div class="line"><span class="lineno"> 1983</span>        sortedTargs[t] = targs[t];</div>
<div class="line"><span class="lineno"> 1984</span>    qsort(sortedTargs, numTargs, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>), <a class="code hl_function" href="QuEST__cpu_8c.html#afa4231f79fe9498e4fd87cc70cde5a9d">qsortComp</a>);</div>
<div class="line"><span class="lineno"> 1985</span>    </div>
<div class="line"><span class="lineno"> 1986</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1987</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1988</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1989</span><span class="preprocessor">    shared   (reVec,imVec, numTasks,numTargAmps,globalIndStart, ctrlMask,targs,sortedTargs,u,numTargs) \</span></div>
<div class="line"><span class="lineno"> 1990</span><span class="preprocessor">    private  (thisTask,thisInd00,thisGlobalInd00,ind,i,t,r,c,reElem,imElem,  ampInds,reAmps,imAmps)</span></div>
<div class="line"><span class="lineno"> 1991</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1992</span>    {</div>
<div class="line"><span class="lineno"> 1993</span>        <span class="comment">// when manually allocating array memory (on Windows), this must be done in each thread</span></div>
<div class="line"><span class="lineno"> 1994</span>        <span class="comment">// separately and is not performed automatically by declaring a var as omp-private</span></div>
<div class="line"><span class="lineno"> 1995</span><span class="preprocessor">        # ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 1996</span>            ampInds = (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>*) _malloca(numTargAmps * <span class="keyword">sizeof</span> *ampInds);</div>
<div class="line"><span class="lineno"> 1997</span>            reAmps = (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) _malloca(numTargAmps * <span class="keyword">sizeof</span> *reAmps);</div>
<div class="line"><span class="lineno"> 1998</span>            imAmps = (<a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>*) _malloca(numTargAmps * <span class="keyword">sizeof</span> *imAmps);</div>
<div class="line"><span class="lineno"> 1999</span><span class="preprocessor">        # endif</span></div>
<div class="line"><span class="lineno"> 2000</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2001</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2002</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2003</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2004</span>            </div>
<div class="line"><span class="lineno"> 2005</span>            <span class="comment">// find this task&#39;s start index (where all targs are 0)</span></div>
<div class="line"><span class="lineno"> 2006</span>            thisInd00 = thisTask;</div>
<div class="line"><span class="lineno"> 2007</span>            <span class="keywordflow">for</span> (t=0; t &lt; numTargs; t++)</div>
<div class="line"><span class="lineno"> 2008</span>                thisInd00 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#aa183d46d750769c42ff07ae1aaedc105">insertZeroBit</a>(thisInd00, sortedTargs[t]);</div>
<div class="line"><span class="lineno"> 2009</span>                </div>
<div class="line"><span class="lineno"> 2010</span>            <span class="comment">// this task only modifies amplitudes if control qubits are 1 for this state</span></div>
<div class="line"><span class="lineno"> 2011</span>            thisGlobalInd00 = thisInd00 + globalIndStart;</div>
<div class="line"><span class="lineno"> 2012</span>            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; thisGlobalInd00) != ctrlMask))</div>
<div class="line"><span class="lineno"> 2013</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 2014</span>                </div>
<div class="line"><span class="lineno"> 2015</span>            <span class="comment">// determine the indices and record values of this tasks&#39;s target amps</span></div>
<div class="line"><span class="lineno"> 2016</span>            <span class="keywordflow">for</span> (i=0; i &lt; numTargAmps; i++) {</div>
<div class="line"><span class="lineno"> 2017</span>                </div>
<div class="line"><span class="lineno"> 2018</span>                <span class="comment">// get statevec index of current target qubit assignment</span></div>
<div class="line"><span class="lineno"> 2019</span>                ind = thisInd00;</div>
<div class="line"><span class="lineno"> 2020</span>                <span class="keywordflow">for</span> (t=0; t &lt; numTargs; t++)</div>
<div class="line"><span class="lineno"> 2021</span>                    <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a>(t, i))</div>
<div class="line"><span class="lineno"> 2022</span>                        ind = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(ind, targs[t]);</div>
<div class="line"><span class="lineno"> 2023</span>                </div>
<div class="line"><span class="lineno"> 2024</span>                <span class="comment">// update this tasks&#39;s private arrays</span></div>
<div class="line"><span class="lineno"> 2025</span>                ampInds[i] = ind;</div>
<div class="line"><span class="lineno"> 2026</span>                reAmps [i] = reVec[ind];</div>
<div class="line"><span class="lineno"> 2027</span>                imAmps [i] = imVec[ind];</div>
<div class="line"><span class="lineno"> 2028</span>            }</div>
<div class="line"><span class="lineno"> 2029</span>            </div>
<div class="line"><span class="lineno"> 2030</span>            <span class="comment">// modify this tasks&#39;s target amplitudes</span></div>
<div class="line"><span class="lineno"> 2031</span>            <span class="keywordflow">for</span> (r=0; r &lt; numTargAmps; r++) {</div>
<div class="line"><span class="lineno"> 2032</span>                ind = ampInds[r];</div>
<div class="line"><span class="lineno"> 2033</span>                reVec[ind] = 0;</div>
<div class="line"><span class="lineno"> 2034</span>                imVec[ind] = 0;</div>
<div class="line"><span class="lineno"> 2035</span>                </div>
<div class="line"><span class="lineno"> 2036</span>                <span class="keywordflow">for</span> (c=0; c &lt; numTargAmps; c++) {</div>
<div class="line"><span class="lineno"> 2037</span>                    reElem = u.<a class="code hl_variable" href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">real</a>[r][c];</div>
<div class="line"><span class="lineno"> 2038</span>                    imElem = u.<a class="code hl_variable" href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">imag</a>[r][c];</div>
<div class="line"><span class="lineno"> 2039</span>                    reVec[ind] += reAmps[c]*reElem - imAmps[c]*imElem;</div>
<div class="line"><span class="lineno"> 2040</span>                    imVec[ind] += reAmps[c]*imElem + imAmps[c]*reElem;</div>
<div class="line"><span class="lineno"> 2041</span>                }</div>
<div class="line"><span class="lineno"> 2042</span>            }</div>
<div class="line"><span class="lineno"> 2043</span>        }</div>
<div class="line"><span class="lineno"> 2044</span>        <span class="comment">// on Windows, we must explicitly free the stack structures</span></div>
<div class="line"><span class="lineno"> 2045</span><span class="preprocessor">        #ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 2046</span>            _freea(ampInds);</div>
<div class="line"><span class="lineno"> 2047</span>            _freea(reAmps);</div>
<div class="line"><span class="lineno"> 2048</span>            _freea(imAmps);</div>
<div class="line"><span class="lineno"> 2049</span><span class="preprocessor">        #endif</span></div>
<div class="line"><span class="lineno"> 2050</span>    }</div>
<div class="line"><span class="lineno"> 2051</span> </div>
<div class="line"><span class="lineno"> 2052</span><span class="preprocessor">    #ifdef _WIN32</span></div>
<div class="line"><span class="lineno"> 2053</span>        _freea(sortedTargs);</div>
<div class="line"><span class="lineno"> 2054</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno"> 2055</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_afa4231f79fe9498e4fd87cc70cde5a9d"><div class="ttname"><a href="QuEST__cpu_8c.html#afa4231f79fe9498e4fd87cc70cde5a9d">qsortComp</a></div><div class="ttdeci">int qsortComp(const void *a, const void *b)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l01939">QuEST_cpu.c:1939</a></div></div>
<div class="ttc" id="aQuEST__cpu__internal_8h_html_a234f55b49a14dc4c58b1959effeb1b56"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a></div><div class="ttdeci">static long long int flipBit(const long long int number, const int bitInd)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00030">QuEST_cpu_internal.h:30</a></div></div>
<div class="ttc" id="aQuEST__cpu__internal_8h_html_aa183d46d750769c42ff07ae1aaedc105"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#aa183d46d750769c42ff07ae1aaedc105">insertZeroBit</a></div><div class="ttdeci">static long long int insertZeroBit(const long long int number, const int index)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00042">QuEST_cpu_internal.h:42</a></div></div>
<div class="ttc" id="astructComplexMatrixN_html_a446e8a077597e4f76049d547df0c9738"><div class="ttname"><a href="structComplexMatrixN.html#a446e8a077597e4f76049d547df0c9738">ComplexMatrixN::real</a></div><div class="ttdeci">qreal ** real</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00189">QuEST.h:189</a></div></div>
<div class="ttc" id="astructComplexMatrixN_html_a606f7afbc3f65a596bdca21cb43be6a8"><div class="ttname"><a href="structComplexMatrixN.html#a606f7afbc3f65a596bdca21cb43be6a8">ComplexMatrixN::numQubits</a></div><div class="ttdeci">int numQubits</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00188">QuEST.h:188</a></div></div>
<div class="ttc" id="astructComplexMatrixN_html_afde13e469a3b4f179f45e53d1ec0a7cf"><div class="ttname"><a href="structComplexMatrixN.html#afde13e469a3b4f179f45e53d1ec0a7cf">ComplexMatrixN::imag</a></div><div class="ttdeci">qreal ** imag</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00190">QuEST.h:190</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00026">extractBit()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00030">flipBit()</a>, <a class="el" href="QuEST_8h_source.html#l00190">ComplexMatrixN::imag</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00042">insertZeroBit()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00188">ComplexMatrixN::numQubits</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST__cpu_8c_source.html#l01939">qsortComp()</a>, <a class="el" href="QuEST_8h_source.html#l00189">ComplexMatrixN::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01516">statevec_multiControlledMultiQubitUnitary()</a>.</p>

</div>
</div>
<a id="a3ed30f823a59890be17441d97ce90c5c" name="a3ed30f823a59890be17441d97ce90c5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ed30f823a59890be17441d97ce90c5c">&#9670;&#160;</a></span>statevec_multiControlledMultiRotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledMultiRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>targMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03389">3389</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3390</span>{</div>
<div class="line"><span class="lineno"> 3391</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3392</span> </div>
<div class="line"><span class="lineno"> 3393</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3394</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3395</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3396</span>    </div>
<div class="line"><span class="lineno"> 3397</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateReal, stateImag;</div>
<div class="line"><span class="lineno"> 3398</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle/2.0);</div>
<div class="line"><span class="lineno"> 3399</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle/2.0); </div>
<div class="line"><span class="lineno"> 3400</span>    </div>
<div class="line"><span class="lineno"> 3401</span>    <span class="comment">// = +-1, to flip sinAngle based on target qubit parity, to effect</span></div>
<div class="line"><span class="lineno"> 3402</span>    <span class="comment">// exp(-angle/2 i fac_j)|j&gt;</span></div>
<div class="line"><span class="lineno"> 3403</span>    <span class="keywordtype">int</span> fac; </div>
<div class="line"><span class="lineno"> 3404</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index, globalIndex;</div>
<div class="line"><span class="lineno"> 3405</span> </div>
<div class="line"><span class="lineno"> 3406</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3407</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3408</span><span class="preprocessor">    default  (none)              \</span></div>
<div class="line"><span class="lineno"> 3409</span><span class="preprocessor">    shared   (offset, stateVecSize, stateVecReal,stateVecImag, ctrlMask,targMask, cosAngle,sinAngle) \</span></div>
<div class="line"><span class="lineno"> 3410</span><span class="preprocessor">    private  (index,globalIndex, fac, stateReal,stateImag)</span></div>
<div class="line"><span class="lineno"> 3411</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3412</span>    {</div>
<div class="line"><span class="lineno"> 3413</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3414</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3415</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3416</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3417</span>            stateReal = stateVecReal[index];</div>
<div class="line"><span class="lineno"> 3418</span>            stateImag = stateVecImag[index];</div>
<div class="line"><span class="lineno"> 3419</span>            </div>
<div class="line"><span class="lineno"> 3420</span>            <span class="comment">// states with not-all-one control qubits are unmodified</span></div>
<div class="line"><span class="lineno"> 3421</span>            globalIndex = index + offset;</div>
<div class="line"><span class="lineno"> 3422</span>            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; globalIndex) != ctrlMask))</div>
<div class="line"><span class="lineno"> 3423</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 3424</span>            </div>
<div class="line"><span class="lineno"> 3425</span>            <span class="comment">// odd-parity target qubits get fac_j = -1 (avoid thread divergence)</span></div>
<div class="line"><span class="lineno"> 3426</span>            fac = 1-2*<a class="code hl_function" href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a>(targMask &amp; globalIndex);</div>
<div class="line"><span class="lineno"> 3427</span>            stateVecReal[index] = cosAngle*stateReal + fac * sinAngle*stateImag;</div>
<div class="line"><span class="lineno"> 3428</span>            stateVecImag[index] = - fac * sinAngle*stateReal + cosAngle*stateImag;  </div>
<div class="line"><span class="lineno"> 3429</span>        }</div>
<div class="line"><span class="lineno"> 3430</span>    }    </div>
<div class="line"><span class="lineno"> 3431</span>}</div>
<div class="ttc" id="aQuEST__cpu_8c_html_a37e522505286f17fe6ef74b9f607a5c6"><div class="ttname"><a href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a></div><div class="ttdeci">int getBitMaskParity(long long int mask)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu_8c_source.html#l03338">QuEST_cpu.c:3338</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac4ee5979d475e8c729294b8ef7e0270d" name="ac4ee5979d475e8c729294b8ef7e0270d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4ee5979d475e8c729294b8ef7e0270d">&#9670;&#160;</a></span>statevec_multiControlledPhaseFlip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseFlip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03749">3749</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3750</span>{</div>
<div class="line"><span class="lineno"> 3751</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 3752</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 3753</span> </div>
<div class="line"><span class="lineno"> 3754</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3755</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3756</span> </div>
<div class="line"><span class="lineno"> 3757</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask = <a class="code hl_function" href="QuEST__common_8c.html#acc45bb8300922ea5933e294921e25ea2">getQubitBitMask</a>(controlQubits, numControlQubits);</div>
<div class="line"><span class="lineno"> 3758</span> </div>
<div class="line"><span class="lineno"> 3759</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3760</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3761</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3762</span> </div>
<div class="line"><span class="lineno"> 3763</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3764</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3765</span><span class="preprocessor">    default  (none)              \</span></div>
<div class="line"><span class="lineno"> 3766</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, mask, chunkId,chunkSize ) \</span></div>
<div class="line"><span class="lineno"> 3767</span><span class="preprocessor">    private  (index)</span></div>
<div class="line"><span class="lineno"> 3768</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3769</span>    {</div>
<div class="line"><span class="lineno"> 3770</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3771</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3772</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3773</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3774</span>            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div>
<div class="line"><span class="lineno"> 3775</span>                stateVecReal [index] = - stateVecReal [index];</div>
<div class="line"><span class="lineno"> 3776</span>                stateVecImag [index] = - stateVecImag [index];</div>
<div class="line"><span class="lineno"> 3777</span>            }</div>
<div class="line"><span class="lineno"> 3778</span>        }</div>
<div class="line"><span class="lineno"> 3779</span>    }</div>
<div class="line"><span class="lineno"> 3780</span>}</div>
<div class="ttc" id="aQuEST__common_8c_html_acc45bb8300922ea5933e294921e25ea2"><div class="ttname"><a href="QuEST__common_8c.html#acc45bb8300922ea5933e294921e25ea2">getQubitBitMask</a></div><div class="ttdeci">long long int getQubitBitMask(int *qubits, int numQubits)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__common_8c_source.html#l00050">QuEST_common.c:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa662796ea6e0f471143c53becae8c12c" name="aa662796ea6e0f471143c53becae8c12c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa662796ea6e0f471143c53becae8c12c">&#9670;&#160;</a></span>statevec_multiControlledPhaseShift()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledPhaseShift </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>controlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>numControlQubits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03297">3297</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3298</span>{</div>
<div class="line"><span class="lineno"> 3299</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 3300</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 3301</span> </div>
<div class="line"><span class="lineno"> 3302</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3303</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3304</span> </div>
<div class="line"><span class="lineno"> 3305</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> mask = <a class="code hl_function" href="QuEST__common_8c.html#acc45bb8300922ea5933e294921e25ea2">getQubitBitMask</a>(controlQubits, numControlQubits);</div>
<div class="line"><span class="lineno"> 3306</span> </div>
<div class="line"><span class="lineno"> 3307</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3308</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3309</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3310</span>    </div>
<div class="line"><span class="lineno"> 3311</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div>
<div class="line"><span class="lineno"> 3312</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle);</div>
<div class="line"><span class="lineno"> 3313</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle);</div>
<div class="line"><span class="lineno"> 3314</span> </div>
<div class="line"><span class="lineno"> 3315</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3316</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3317</span><span class="preprocessor">    default  (none)              \</span></div>
<div class="line"><span class="lineno"> 3318</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask, chunkId,chunkSize,cosAngle,sinAngle) \</span></div>
<div class="line"><span class="lineno"> 3319</span><span class="preprocessor">    private  (index, stateRealLo, stateImagLo)</span></div>
<div class="line"><span class="lineno"> 3320</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3321</span>    {</div>
<div class="line"><span class="lineno"> 3322</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3323</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3324</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3325</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3326</span>            <span class="keywordflow">if</span> (mask == (mask &amp; (index+chunkId*chunkSize)) ){</div>
<div class="line"><span class="lineno"> 3327</span>                </div>
<div class="line"><span class="lineno"> 3328</span>                stateRealLo = stateVecReal[index];</div>
<div class="line"><span class="lineno"> 3329</span>                stateImagLo = stateVecImag[index];</div>
<div class="line"><span class="lineno"> 3330</span>            </div>
<div class="line"><span class="lineno"> 3331</span>                stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div>
<div class="line"><span class="lineno"> 3332</span>                stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div>
<div class="line"><span class="lineno"> 3333</span>            }</div>
<div class="line"><span class="lineno"> 3334</span>        }</div>
<div class="line"><span class="lineno"> 3335</span>    }</div>
<div class="line"><span class="lineno"> 3336</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af8236a00389137b5eff986a40577eaf3" name="af8236a00389137b5eff986a40577eaf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8236a00389137b5eff986a40577eaf3">&#9670;&#160;</a></span>statevec_multiControlledTwoQubitUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledTwoQubitUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>q2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix4.html">ComplexMatrix4</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01844">1844</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1844</span>                                                                                                                         {</div>
<div class="line"><span class="lineno"> 1845</span> </div>
<div class="line"><span class="lineno"> 1846</span>    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 1847</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1848</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1849</span>    </div>
<div class="line"><span class="lineno"> 1850</span>    <span class="comment">// the global (between all nodes) index of this node&#39;s start index</span></div>
<div class="line"><span class="lineno"> 1851</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalIndStart = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; </div>
<div class="line"><span class="lineno"> 1852</span>    </div>
<div class="line"><span class="lineno"> 1853</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> &gt;&gt; 2; <span class="comment">// each iteration updates 4 amplitudes</span></div>
<div class="line"><span class="lineno"> 1854</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno"> 1855</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisGlobalInd00;</div>
<div class="line"><span class="lineno"> 1856</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind00, ind01, ind10, ind11;</div>
<div class="line"><span class="lineno"> 1857</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> re00, re01, re10, re11;</div>
<div class="line"><span class="lineno"> 1858</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> im00, im01, im10, im11;</div>
<div class="line"><span class="lineno"> 1859</span>    </div>
<div class="line"><span class="lineno"> 1860</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1861</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1862</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1863</span><span class="preprocessor">    shared   (reVec,imVec,globalIndStart,numTasks,ctrlMask,u,q2,q1) \</span></div>
<div class="line"><span class="lineno"> 1864</span><span class="preprocessor">    private  (thisTask, thisGlobalInd00, ind00,ind01,ind10,ind11, re00,re01,re10,re11, im00,im01,im10,im11)</span></div>
<div class="line"><span class="lineno"> 1865</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1866</span>    {</div>
<div class="line"><span class="lineno"> 1867</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1868</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1869</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1870</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 1871</span>            </div>
<div class="line"><span class="lineno"> 1872</span>            <span class="comment">// determine ind00 of |..0..0..&gt;</span></div>
<div class="line"><span class="lineno"> 1873</span>            ind00 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a8909226b5f0589d82b34af7f6bf2a339">insertTwoZeroBits</a>(thisTask, q1, q2);</div>
<div class="line"><span class="lineno"> 1874</span>            </div>
<div class="line"><span class="lineno"> 1875</span>            <span class="comment">// skip amplitude if controls aren&#39;t in 1 state (overloaded for speed)</span></div>
<div class="line"><span class="lineno"> 1876</span>            thisGlobalInd00 = ind00 + globalIndStart;</div>
<div class="line"><span class="lineno"> 1877</span>            <span class="keywordflow">if</span> (ctrlMask &amp;&amp; ((ctrlMask &amp; thisGlobalInd00) != ctrlMask))</div>
<div class="line"><span class="lineno"> 1878</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1879</span>            </div>
<div class="line"><span class="lineno"> 1880</span>            <span class="comment">// inds of |..0..1..&gt;, |..1..0..&gt; and |..1..1..&gt;</span></div>
<div class="line"><span class="lineno"> 1881</span>            ind01 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(ind00, q1);</div>
<div class="line"><span class="lineno"> 1882</span>            ind10 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(ind00, q2);</div>
<div class="line"><span class="lineno"> 1883</span>            ind11 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(ind01, q2);</div>
<div class="line"><span class="lineno"> 1884</span> </div>
<div class="line"><span class="lineno"> 1885</span>            <span class="comment">// extract statevec amplitudes </span></div>
<div class="line"><span class="lineno"> 1886</span>            re00 = reVec[ind00]; im00 = imVec[ind00];</div>
<div class="line"><span class="lineno"> 1887</span>            re01 = reVec[ind01]; im01 = imVec[ind01];</div>
<div class="line"><span class="lineno"> 1888</span>            re10 = reVec[ind10]; im10 = imVec[ind10];</div>
<div class="line"><span class="lineno"> 1889</span>            re11 = reVec[ind11]; im11 = imVec[ind11];</div>
<div class="line"><span class="lineno"> 1890</span> </div>
<div class="line"><span class="lineno"> 1891</span>            <span class="comment">// apply u * {amp00, amp01, amp10, amp11}</span></div>
<div class="line"><span class="lineno"> 1892</span>            reVec[ind00] = </div>
<div class="line"><span class="lineno"> 1893</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][0]*re00 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][0]*im00 +</div>
<div class="line"><span class="lineno"> 1894</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][1]*re01 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][1]*im01 +</div>
<div class="line"><span class="lineno"> 1895</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][2]*re10 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][2]*im10 +</div>
<div class="line"><span class="lineno"> 1896</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][3]*re11 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][3]*im11;</div>
<div class="line"><span class="lineno"> 1897</span>            imVec[ind00] =</div>
<div class="line"><span class="lineno"> 1898</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][0]*re00 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][0]*im00 +</div>
<div class="line"><span class="lineno"> 1899</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][1]*re01 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][1]*im01 +</div>
<div class="line"><span class="lineno"> 1900</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][2]*re10 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][2]*im10 +</div>
<div class="line"><span class="lineno"> 1901</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[0][3]*re11 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[0][3]*im11;</div>
<div class="line"><span class="lineno"> 1902</span>                </div>
<div class="line"><span class="lineno"> 1903</span>            reVec[ind01] = </div>
<div class="line"><span class="lineno"> 1904</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][0]*re00 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][0]*im00 +</div>
<div class="line"><span class="lineno"> 1905</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][1]*re01 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][1]*im01 +</div>
<div class="line"><span class="lineno"> 1906</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][2]*re10 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][2]*im10 +</div>
<div class="line"><span class="lineno"> 1907</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][3]*re11 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][3]*im11;</div>
<div class="line"><span class="lineno"> 1908</span>            imVec[ind01] =</div>
<div class="line"><span class="lineno"> 1909</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][0]*re00 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][0]*im00 +</div>
<div class="line"><span class="lineno"> 1910</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][1]*re01 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][1]*im01 +</div>
<div class="line"><span class="lineno"> 1911</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][2]*re10 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][2]*im10 +</div>
<div class="line"><span class="lineno"> 1912</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[1][3]*re11 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[1][3]*im11;</div>
<div class="line"><span class="lineno"> 1913</span>                </div>
<div class="line"><span class="lineno"> 1914</span>            reVec[ind10] = </div>
<div class="line"><span class="lineno"> 1915</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][0]*re00 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][0]*im00 +</div>
<div class="line"><span class="lineno"> 1916</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][1]*re01 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][1]*im01 +</div>
<div class="line"><span class="lineno"> 1917</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][2]*re10 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][2]*im10 +</div>
<div class="line"><span class="lineno"> 1918</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][3]*re11 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][3]*im11;</div>
<div class="line"><span class="lineno"> 1919</span>            imVec[ind10] =</div>
<div class="line"><span class="lineno"> 1920</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][0]*re00 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][0]*im00 +</div>
<div class="line"><span class="lineno"> 1921</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][1]*re01 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][1]*im01 +</div>
<div class="line"><span class="lineno"> 1922</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][2]*re10 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][2]*im10 +</div>
<div class="line"><span class="lineno"> 1923</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[2][3]*re11 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[2][3]*im11;    </div>
<div class="line"><span class="lineno"> 1924</span>                </div>
<div class="line"><span class="lineno"> 1925</span>            reVec[ind11] = </div>
<div class="line"><span class="lineno"> 1926</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][0]*re00 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][0]*im00 +</div>
<div class="line"><span class="lineno"> 1927</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][1]*re01 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][1]*im01 +</div>
<div class="line"><span class="lineno"> 1928</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][2]*re10 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][2]*im10 +</div>
<div class="line"><span class="lineno"> 1929</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][3]*re11 - u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][3]*im11;</div>
<div class="line"><span class="lineno"> 1930</span>            imVec[ind11] =</div>
<div class="line"><span class="lineno"> 1931</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][0]*re00 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][0]*im00 +</div>
<div class="line"><span class="lineno"> 1932</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][1]*re01 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][1]*im01 +</div>
<div class="line"><span class="lineno"> 1933</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][2]*re10 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][2]*im10 +</div>
<div class="line"><span class="lineno"> 1934</span>                u.<a class="code hl_variable" href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">imag</a>[3][3]*re11 + u.<a class="code hl_variable" href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">real</a>[3][3]*im11;    </div>
<div class="line"><span class="lineno"> 1935</span>        }</div>
<div class="line"><span class="lineno"> 1936</span>    }</div>
<div class="line"><span class="lineno"> 1937</span>}</div>
<div class="ttc" id="aQuEST__cpu__internal_8h_html_a8909226b5f0589d82b34af7f6bf2a339"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a8909226b5f0589d82b34af7f6bf2a339">insertTwoZeroBits</a></div><div class="ttdeci">static long long int insertTwoZeroBits(const long long int number, const int bit1, const int bit2)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00049">QuEST_cpu_internal.h:49</a></div></div>
<div class="ttc" id="astructComplexMatrix4_html_a1f6bb840b5a9e6252980cab7a14f1a35"><div class="ttname"><a href="structComplexMatrix4.html#a1f6bb840b5a9e6252980cab7a14f1a35">ComplexMatrix4::imag</a></div><div class="ttdeci">qreal imag[4][4]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00178">QuEST.h:178</a></div></div>
<div class="ttc" id="astructComplexMatrix4_html_aeadc9893e1b16cdd585dac523e73926c"><div class="ttname"><a href="structComplexMatrix4.html#aeadc9893e1b16cdd585dac523e73926c">ComplexMatrix4::real</a></div><div class="ttdeci">qreal real[4][4]</div><div class="ttdef"><b>Definition:</b> <a href="QuEST_8h_source.html#l00177">QuEST.h:177</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00030">flipBit()</a>, <a class="el" href="QuEST_8h_source.html#l00178">ComplexMatrix4::imag</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00049">insertTwoZeroBits()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00177">ComplexMatrix4::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01460">statevec_multiControlledTwoQubitUnitary()</a>.</p>

</div>
</div>
<a id="ab58fe4be895283c2c4eb86ec9af5682e" name="ab58fe4be895283c2c4eb86ec9af5682e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab58fe4be895283c2c4eb86ec9af5682e">&#9670;&#160;</a></span>statevec_multiControlledUnitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlQubitsMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlFlipMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a unitary operation to a single qubit in the state vector of probability amplitudes, given a subset of the state vector with upper and lower block values stored seperately. </p>
<p >Only perform the rotation where all the control qubits are 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">targetQubit</td><td>qubit to rotate </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctrlQubitsMask</td><td>a bit mask indicating whether each qubit is a control (1) or not (0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctrlFlipMask</td><td>a bit mask indicating whether each qubit (only controls are relevant) should be flipped when checking the control condition </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td>rotation angle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02573">2573</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2581</span>{</div>
<div class="line"><span class="lineno"> 2582</span> </div>
<div class="line"><span class="lineno"> 2583</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2584</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2585</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2586</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2587</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2588</span> </div>
<div class="line"><span class="lineno"> 2589</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2590</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2591</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div>
<div class="line"><span class="lineno"> 2592</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div>
<div class="line"><span class="lineno"> 2593</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2594</span> </div>
<div class="line"><span class="lineno"> 2595</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2596</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2597</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2598</span><span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2599</span><span class="preprocessor">            rot1Real,rot1Imag, rot2Real,rot2Imag, ctrlQubitsMask,ctrlFlipMask, numTasks,chunkId,chunkSize) \</span></div>
<div class="line"><span class="lineno"> 2600</span><span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 2601</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2602</span>    {</div>
<div class="line"><span class="lineno"> 2603</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2604</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2605</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2606</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2607</span>            <span class="keywordflow">if</span> (ctrlQubitsMask == (ctrlQubitsMask &amp; ((thisTask+chunkId*chunkSize) ^ ctrlFlipMask))) {</div>
<div class="line"><span class="lineno"> 2608</span>                <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2609</span>                stateRealUp = stateVecRealUp[thisTask];</div>
<div class="line"><span class="lineno"> 2610</span>                stateImagUp = stateVecImagUp[thisTask];</div>
<div class="line"><span class="lineno"> 2611</span> </div>
<div class="line"><span class="lineno"> 2612</span>                stateRealLo = stateVecRealLo[thisTask];</div>
<div class="line"><span class="lineno"> 2613</span>                stateImagLo = stateVecImagLo[thisTask];</div>
<div class="line"><span class="lineno"> 2614</span> </div>
<div class="line"><span class="lineno"> 2615</span>                stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div>
<div class="line"><span class="lineno"> 2616</span>                    + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2617</span>                stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div>
<div class="line"><span class="lineno"> 2618</span>                    + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2619</span>            }</div>
<div class="line"><span class="lineno"> 2620</span>        }</div>
<div class="line"><span class="lineno"> 2621</span>    }</div>
<div class="line"><span class="lineno"> 2622</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01013">statevec_multiControlledUnitary()</a>.</p>

</div>
</div>
<a id="ab19f28e68330da68ea3caa2bdef32da9" name="ab19f28e68330da68ea3caa2bdef32da9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab19f28e68330da68ea3caa2bdef32da9">&#9670;&#160;</a></span>statevec_multiControlledUnitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiControlledUnitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlQubitsMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>ctrlFlipMask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02299">2299</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2303</span>{</div>
<div class="line"><span class="lineno"> 2304</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2305</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2306</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2307</span> </div>
<div class="line"><span class="lineno"> 2308</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2309</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2310</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2311</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2312</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 2313</span> </div>
<div class="line"><span class="lineno"> 2314</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2315</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2316</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2317</span> </div>
<div class="line"><span class="lineno"> 2318</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2319</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2320</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2321</span> </div>
<div class="line"><span class="lineno"> 2322</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2323</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2324</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2325</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u, ctrlQubitsMask,ctrlFlipMask, \</span></div>
<div class="line"><span class="lineno"> 2326</span><span class="preprocessor">                numTasks,chunkId,chunkSize) \</span></div>
<div class="line"><span class="lineno"> 2327</span><span class="preprocessor">    private  (thisTask,thisBlock, indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 2328</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2329</span>    {</div>
<div class="line"><span class="lineno"> 2330</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2331</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2332</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2333</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2334</span> </div>
<div class="line"><span class="lineno"> 2335</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2336</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2337</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2338</span>            </div>
<div class="line"><span class="lineno"> 2339</span>            </div>
<div class="line"><span class="lineno"> 2340</span>            <span class="comment">// take the basis index, flip the designated (XOR) &#39;control&#39; bits, AND with the controls.</span></div>
<div class="line"><span class="lineno"> 2341</span>            <span class="comment">// if this equals the control mask, the control qubits have the desired values in the basis index</span></div>
<div class="line"><span class="lineno"> 2342</span>            <span class="keywordflow">if</span> (ctrlQubitsMask == (ctrlQubitsMask &amp; ((indexUp+chunkId*chunkSize) ^ ctrlFlipMask))) {</div>
<div class="line"><span class="lineno"> 2343</span>                <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2344</span>                stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2345</span>                stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2346</span> </div>
<div class="line"><span class="lineno"> 2347</span>                stateRealLo = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2348</span>                stateImagLo = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2349</span> </div>
<div class="line"><span class="lineno"> 2350</span>                <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2351</span>                stateVecReal[indexUp] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateRealUp - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateImagUp </div>
<div class="line"><span class="lineno"> 2352</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateRealLo - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateImagLo;</div>
<div class="line"><span class="lineno"> 2353</span>                stateVecImag[indexUp] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateImagUp + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateRealUp </div>
<div class="line"><span class="lineno"> 2354</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateImagLo + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateRealLo;</div>
<div class="line"><span class="lineno"> 2355</span> </div>
<div class="line"><span class="lineno"> 2356</span>                <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2357</span>                stateVecReal[indexLo] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateRealUp  - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateImagUp </div>
<div class="line"><span class="lineno"> 2358</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateRealLo  -  u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateImagLo;</div>
<div class="line"><span class="lineno"> 2359</span>                stateVecImag[indexLo] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateImagUp + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateRealUp </div>
<div class="line"><span class="lineno"> 2360</span>                    + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateImagLo + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateRealLo;</div>
<div class="line"><span class="lineno"> 2361</span>            }</div>
<div class="line"><span class="lineno"> 2362</span>        } </div>
<div class="line"><span class="lineno"> 2363</span>    }</div>
<div class="line"><span class="lineno"> 2364</span> </div>
<div class="line"><span class="lineno"> 2365</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST_8h_source.html#l00140">ComplexMatrix2::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00139">ComplexMatrix2::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01013">statevec_multiControlledUnitary()</a>.</p>

</div>
</div>
<a id="a8d88b4ed94ab024e5e7b2f1f4f505b44" name="a8d88b4ed94ab024e5e7b2f1f4f505b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d88b4ed94ab024e5e7b2f1f4f505b44">&#9670;&#160;</a></span>statevec_multiRotateZ()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_multiRotateZ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>mask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>&#160;</td>
          <td class="paramname"><em>angle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03347">3347</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3348</span>{</div>
<div class="line"><span class="lineno"> 3349</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 3350</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 3351</span> </div>
<div class="line"><span class="lineno"> 3352</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3353</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3354</span> </div>
<div class="line"><span class="lineno"> 3355</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3356</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3357</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3358</span>    </div>
<div class="line"><span class="lineno"> 3359</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateReal, stateImag;</div>
<div class="line"><span class="lineno"> 3360</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = cos(angle/2.0);</div>
<div class="line"><span class="lineno"> 3361</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = sin(angle/2.0); </div>
<div class="line"><span class="lineno"> 3362</span>    </div>
<div class="line"><span class="lineno"> 3363</span>    <span class="comment">// = +-1, to flip sinAngle based on target qubit parity, to effect</span></div>
<div class="line"><span class="lineno"> 3364</span>    <span class="comment">// exp(-angle/2 i fac_j)|j&gt;</span></div>
<div class="line"><span class="lineno"> 3365</span>    <span class="keywordtype">int</span> fac; </div>
<div class="line"><span class="lineno"> 3366</span> </div>
<div class="line"><span class="lineno"> 3367</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3368</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3369</span><span class="preprocessor">    default  (none)              \</span></div>
<div class="line"><span class="lineno"> 3370</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal, stateVecImag, mask, chunkId,chunkSize,cosAngle,sinAngle) \</span></div>
<div class="line"><span class="lineno"> 3371</span><span class="preprocessor">    private  (index, fac, stateReal, stateImag)</span></div>
<div class="line"><span class="lineno"> 3372</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3373</span>    {</div>
<div class="line"><span class="lineno"> 3374</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3375</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3376</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3377</span>        <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3378</span>            stateReal = stateVecReal[index];</div>
<div class="line"><span class="lineno"> 3379</span>            stateImag = stateVecImag[index];</div>
<div class="line"><span class="lineno"> 3380</span>            </div>
<div class="line"><span class="lineno"> 3381</span>            <span class="comment">// odd-parity target qubits get fac_j = -1</span></div>
<div class="line"><span class="lineno"> 3382</span>            fac = <a class="code hl_function" href="QuEST__cpu_8c.html#a37e522505286f17fe6ef74b9f607a5c6">getBitMaskParity</a>(mask &amp; (index+chunkId*chunkSize))? -1 : 1;</div>
<div class="line"><span class="lineno"> 3383</span>            stateVecReal[index] = cosAngle*stateReal + fac * sinAngle*stateImag;</div>
<div class="line"><span class="lineno"> 3384</span>            stateVecImag[index] = - fac * sinAngle*stateReal + cosAngle*stateImag;  </div>
<div class="line"><span class="lineno"> 3385</span>        }</div>
<div class="line"><span class="lineno"> 3386</span>    }</div>
<div class="line"><span class="lineno"> 3387</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a464efbd1d7ca5a7b25c83ada001955c2" name="a464efbd1d7ca5a7b25c83ada001955c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a464efbd1d7ca5a7b25c83ada001955c2">&#9670;&#160;</a></span>statevec_pauliXDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliXDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by {{0,1},{1,0}. </p>
<p >Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the <br  />
 the first qubit is the rightmost <br  />
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02682">2682</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2685</span>{</div>
<div class="line"><span class="lineno"> 2686</span> </div>
<div class="line"><span class="lineno"> 2687</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2688</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2689</span> </div>
<div class="line"><span class="lineno"> 2690</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div>
<div class="line"><span class="lineno"> 2691</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2692</span> </div>
<div class="line"><span class="lineno"> 2693</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2694</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2695</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2696</span><span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut,numTasks) \</span></div>
<div class="line"><span class="lineno"> 2697</span><span class="preprocessor">    private  (thisTask)</span></div>
<div class="line"><span class="lineno"> 2698</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2699</span>    {</div>
<div class="line"><span class="lineno"> 2700</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2701</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2702</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2703</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2704</span>            stateVecRealOut[thisTask] = stateVecRealIn[thisTask];</div>
<div class="line"><span class="lineno"> 2705</span>            stateVecImagOut[thisTask] = stateVecImagIn[thisTask];</div>
<div class="line"><span class="lineno"> 2706</span>        }</div>
<div class="line"><span class="lineno"> 2707</span>    }</div>
<div class="line"><span class="lineno"> 2708</span>} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, and <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01050">statevec_pauliX()</a>.</p>

</div>
</div>
<a id="aa987d1e0ba97da2ca540194356dd62de" name="aa987d1e0ba97da2ca540194356dd62de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa987d1e0ba97da2ca540194356dd62de">&#9670;&#160;</a></span>statevec_pauliXLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliXLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02624">2624</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2625</span>{</div>
<div class="line"><span class="lineno"> 2626</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2627</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2628</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2629</span> </div>
<div class="line"><span class="lineno"> 2630</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div>
<div class="line"><span class="lineno"> 2631</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2632</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2633</span> </div>
<div class="line"><span class="lineno"> 2634</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2635</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2636</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2639</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2640</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2641</span> </div>
<div class="line"><span class="lineno"> 2642</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2643</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2644</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2645</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, numTasks) \</span></div>
<div class="line"><span class="lineno"> 2646</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp)</span></div>
<div class="line"><span class="lineno"> 2647</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2648</span>    {</div>
<div class="line"><span class="lineno"> 2649</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2650</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2651</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2652</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2653</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2654</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2655</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2656</span> </div>
<div class="line"><span class="lineno"> 2657</span>            stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2658</span>            stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2659</span> </div>
<div class="line"><span class="lineno"> 2660</span>            stateVecReal[indexUp] = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2661</span>            stateVecImag[indexUp] = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2662</span> </div>
<div class="line"><span class="lineno"> 2663</span>            stateVecReal[indexLo] = stateRealUp;</div>
<div class="line"><span class="lineno"> 2664</span>            stateVecImag[indexLo] = stateImagUp;</div>
<div class="line"><span class="lineno"> 2665</span>        } </div>
<div class="line"><span class="lineno"> 2666</span>    }</div>
<div class="line"><span class="lineno"> 2667</span> </div>
<div class="line"><span class="lineno"> 2668</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01050">statevec_pauliX()</a>.</p>

</div>
</div>
<a id="a0f562af6cb665a8a7a3f80e9449734d5" name="a0f562af6cb665a8a7a3f80e9449734d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f562af6cb665a8a7a3f80e9449734d5">&#9670;&#160;</a></span>statevec_pauliYDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>updateUpper</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate a single qubit by +-{{0,-i},{i,0}. </p>
<p >Operate on a subset of the state vector with upper and lower block values stored seperately. This rotation is just swapping upper and lower values, and stateVecIn must already be the correct section for this chunk</p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the <br  />
 the first qubit is the rightmost <br  />
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecIn</td><td>probability amplitudes in lower or upper half of a block depending on chunkId </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">updateUpper</td><td>flag, 1: updating upper values, 0: updating lower values in block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">conjFac</td><td>1: apply conj(pauliY), 0: apply pauliY </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02976">2976</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2980</span>{</div>
<div class="line"><span class="lineno"> 2981</span> </div>
<div class="line"><span class="lineno"> 2982</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2983</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2984</span> </div>
<div class="line"><span class="lineno"> 2985</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealIn=stateVecIn.real, *stateVecImagIn=stateVecIn.imag;</div>
<div class="line"><span class="lineno"> 2986</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2987</span> </div>
<div class="line"><span class="lineno"> 2988</span>    <span class="keywordtype">int</span> realSign=1, imagSign=1;</div>
<div class="line"><span class="lineno"> 2989</span>    <span class="keywordflow">if</span> (updateUpper) imagSign=-1;</div>
<div class="line"><span class="lineno"> 2990</span>    <span class="keywordflow">else</span> realSign = -1;</div>
<div class="line"><span class="lineno"> 2991</span> </div>
<div class="line"><span class="lineno"> 2992</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2993</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2994</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2995</span><span class="preprocessor">    shared   (stateVecRealIn,stateVecImagIn,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2996</span><span class="preprocessor">                realSign,imagSign, numTasks,conjFac) \</span></div>
<div class="line"><span class="lineno"> 2997</span><span class="preprocessor">    private  (thisTask)</span></div>
<div class="line"><span class="lineno"> 2998</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2999</span>    {</div>
<div class="line"><span class="lineno"> 3000</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3001</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3002</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3003</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 3004</span>            stateVecRealOut[thisTask] = conjFac * realSign * stateVecImagIn[thisTask];</div>
<div class="line"><span class="lineno"> 3005</span>            stateVecImagOut[thisTask] = conjFac * imagSign * stateVecRealIn[thisTask];</div>
<div class="line"><span class="lineno"> 3006</span>        }</div>
<div class="line"><span class="lineno"> 3007</span>    }</div>
<div class="line"><span class="lineno"> 3008</span>} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, and <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01144">statevec_pauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01169">statevec_pauliYConj()</a>.</p>

</div>
</div>
<a id="a45b0916c3e121837f214b64f7424e479" name="a45b0916c3e121837f214b64f7424e479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45b0916c3e121837f214b64f7424e479">&#9670;&#160;</a></span>statevec_pauliYLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_pauliYLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>conjFac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02918">2918</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2919</span>{</div>
<div class="line"><span class="lineno"> 2920</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2921</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2922</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2923</span> </div>
<div class="line"><span class="lineno"> 2924</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateImagUp;</div>
<div class="line"><span class="lineno"> 2925</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2926</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2927</span> </div>
<div class="line"><span class="lineno"> 2928</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2929</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2930</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2931</span> </div>
<div class="line"><span class="lineno"> 2932</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2933</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2934</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2935</span> </div>
<div class="line"><span class="lineno"> 2936</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2937</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2938</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2939</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, numTasks,conjFac) \</span></div>
<div class="line"><span class="lineno"> 2940</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp)</span></div>
<div class="line"><span class="lineno"> 2941</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2942</span>    {</div>
<div class="line"><span class="lineno"> 2943</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2944</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2945</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2946</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2947</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2948</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2949</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2950</span> </div>
<div class="line"><span class="lineno"> 2951</span>            stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2952</span>            stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2953</span> </div>
<div class="line"><span class="lineno"> 2954</span>            stateVecReal[indexUp] = conjFac * stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2955</span>            stateVecImag[indexUp] = conjFac * -stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2956</span>            stateVecReal[indexLo] = conjFac * -stateImagUp;</div>
<div class="line"><span class="lineno"> 2957</span>            stateVecImag[indexLo] = conjFac * stateRealUp;</div>
<div class="line"><span class="lineno"> 2958</span>        } </div>
<div class="line"><span class="lineno"> 2959</span>    }</div>
<div class="line"><span class="lineno"> 2960</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01144">statevec_pauliY()</a>, and <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01169">statevec_pauliYConj()</a>.</p>

</div>
</div>
<a id="a535cc3c9962d511078691e4d64b4e272" name="a535cc3c9962d511078691e4d64b4e272"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a535cc3c9962d511078691e4d64b4e272">&#9670;&#160;</a></span>statevec_phaseShiftByTerm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_phaseShiftByTerm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>term</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03216">3216</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3217</span>{       </div>
<div class="line"><span class="lineno"> 3218</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 3219</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> stateVecSize;</div>
<div class="line"><span class="lineno"> 3220</span>    <span class="keywordtype">int</span> targetBit;</div>
<div class="line"><span class="lineno"> 3221</span>    </div>
<div class="line"><span class="lineno"> 3222</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkSize=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3223</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> chunkId=qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>;</div>
<div class="line"><span class="lineno"> 3224</span> </div>
<div class="line"><span class="lineno"> 3225</span>    <span class="comment">// dimension of the state vector</span></div>
<div class="line"><span class="lineno"> 3226</span>    stateVecSize = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 3227</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3228</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3229</span>    </div>
<div class="line"><span class="lineno"> 3230</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealLo, stateImagLo;</div>
<div class="line"><span class="lineno"> 3231</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> cosAngle = term.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 3232</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> sinAngle = term.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 3233</span> </div>
<div class="line"><span class="lineno"> 3234</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3235</span><span class="preprocessor"># pragma omp parallel for \</span></div>
<div class="line"><span class="lineno"> 3236</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3237</span><span class="preprocessor">    shared   (stateVecSize, stateVecReal,stateVecImag, cosAngle,sinAngle, \</span></div>
<div class="line"><span class="lineno"> 3238</span><span class="preprocessor">                chunkId,chunkSize,targetQubit) \</span></div>
<div class="line"><span class="lineno"> 3239</span><span class="preprocessor">    private  (index,targetBit,stateRealLo,stateImagLo) \</span></div>
<div class="line"><span class="lineno"> 3240</span><span class="preprocessor">    schedule (static)</span></div>
<div class="line"><span class="lineno"> 3241</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3242</span>    <span class="keywordflow">for</span> (index=0; index&lt;stateVecSize; index++) {</div>
<div class="line"><span class="lineno"> 3243</span>        </div>
<div class="line"><span class="lineno"> 3244</span>        <span class="comment">// update the coeff of the |1&gt; state of the target qubit</span></div>
<div class="line"><span class="lineno"> 3245</span>        targetBit = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a100463f6ec212c76a5fad99579000505">extractBit</a> (targetQubit, index+chunkId*chunkSize);</div>
<div class="line"><span class="lineno"> 3246</span>        <span class="keywordflow">if</span> (targetBit) {</div>
<div class="line"><span class="lineno"> 3247</span>            </div>
<div class="line"><span class="lineno"> 3248</span>            stateRealLo = stateVecReal[index];</div>
<div class="line"><span class="lineno"> 3249</span>            stateImagLo = stateVecImag[index];</div>
<div class="line"><span class="lineno"> 3250</span>            </div>
<div class="line"><span class="lineno"> 3251</span>            stateVecReal[index] = cosAngle*stateRealLo - sinAngle*stateImagLo;</div>
<div class="line"><span class="lineno"> 3252</span>            stateVecImag[index] = sinAngle*stateRealLo + cosAngle*stateImagLo;  </div>
<div class="line"><span class="lineno"> 3253</span>        }</div>
<div class="line"><span class="lineno"> 3254</span>    }</div>
<div class="line"><span class="lineno"> 3255</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1e57230c7995447039e62a84c0a36524" name="a1e57230c7995447039e62a84c0a36524"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e57230c7995447039e62a84c0a36524">&#9670;&#160;</a></span>statevec_reportStateToScreen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_reportStateToScreen </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQuESTEnv.html">QuESTEnv</a>&#160;</td>
          <td class="paramname"><em>env</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>reportRank</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01478">1478</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1478</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1479</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1480</span>    <span class="keywordtype">int</span> rank;</div>
<div class="line"><span class="lineno"> 1481</span>    <span class="keywordflow">if</span> (qureg.<a class="code hl_variable" href="structQureg.html#a0a86e8a50ea8c998b4a0a6640c5a1218">numQubitsInStateVec</a>&lt;=5){</div>
<div class="line"><span class="lineno"> 1482</span>        <span class="keywordflow">for</span> (rank=0; rank&lt;qureg.<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>; rank++){</div>
<div class="line"><span class="lineno"> 1483</span>            <span class="keywordflow">if</span> (qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>==rank){</div>
<div class="line"><span class="lineno"> 1484</span>                <span class="keywordflow">if</span> (reportRank) {</div>
<div class="line"><span class="lineno"> 1485</span>                    printf(<span class="stringliteral">&quot;Reporting state from rank %d [\n&quot;</span>, qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>);</div>
<div class="line"><span class="lineno"> 1486</span>                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1487</span>                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rank==0) {</div>
<div class="line"><span class="lineno"> 1488</span>                    printf(<span class="stringliteral">&quot;Reporting state [\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1489</span>                    printf(<span class="stringliteral">&quot;real, imag\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1490</span>                }</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>                <span class="keywordflow">for</span>(index=0; index&lt;qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>; index++){</div>
<div class="line"><span class="lineno"> 1493</span>                    <span class="comment">//printf(REAL_STRING_FORMAT &quot;, &quot; REAL_STRING_FORMAT &quot;\n&quot;, qureg.pairStateVec.real[index], qureg.pairStateVec.imag[index]);</span></div>
<div class="line"><span class="lineno"> 1494</span>                    printf(REAL_STRING_FORMAT <span class="stringliteral">&quot;, &quot;</span> REAL_STRING_FORMAT <span class="stringliteral">&quot;\n&quot;</span>, qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[index], qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[index]);</div>
<div class="line"><span class="lineno"> 1495</span>                }</div>
<div class="line"><span class="lineno"> 1496</span>                <span class="keywordflow">if</span> (reportRank || rank==qureg.<a class="code hl_variable" href="structQureg.html#aa3deb7163aab90a61e755a1f200f5413">numChunks</a>-1) printf(<span class="stringliteral">&quot;]\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1497</span>            }</div>
<div class="line"><span class="lineno"> 1498</span>            <a class="code hl_function" href="group__debug.html#ga8d31fe2d1ad4d01e2a1f5f6b8bc15b77">syncQuESTEnv</a>(env);</div>
<div class="line"><span class="lineno"> 1499</span>        }</div>
<div class="line"><span class="lineno"> 1500</span>    } <span class="keywordflow">else</span> printf(<span class="stringliteral">&quot;Error: reportStateToScreen will not print output for systems of more than 5 qubits.\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 1501</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa121d55f2ca09c06a96ddcd433c60b0f" name="aa121d55f2ca09c06a96ddcd433c60b0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa121d55f2ca09c06a96ddcd433c60b0f">&#9670;&#160;</a></span>statevec_setAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>reals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *&#160;</td>
          <td class="paramname"><em>imags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l01254">1254</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1254</span>                                                                                                              {</div>
<div class="line"><span class="lineno"> 1255</span>    </div>
<div class="line"><span class="lineno"> 1256</span>    <span class="comment">/* this is actually distributed, since the user&#39;s code runs on every node */</span></div>
<div class="line"><span class="lineno"> 1257</span>    </div>
<div class="line"><span class="lineno"> 1258</span>    <span class="comment">// local start/end indices of the given amplitudes, assuming they fit in this chunk</span></div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment">// these may be negative or above qureg.numAmpsPerChunk</span></div>
<div class="line"><span class="lineno"> 1260</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localStartInd = startInd - qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1261</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localEndInd = localStartInd + numAmps; <span class="comment">// exclusive</span></div>
<div class="line"><span class="lineno"> 1262</span>    </div>
<div class="line"><span class="lineno"> 1263</span>    <span class="comment">// add this to a local index to get corresponding elem in reals &amp; imags</span></div>
<div class="line"><span class="lineno"> 1264</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> offset = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a>*qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> - startInd;</div>
<div class="line"><span class="lineno"> 1265</span>    </div>
<div class="line"><span class="lineno"> 1266</span>    <span class="comment">// restrict these indices to fit into this chunk</span></div>
<div class="line"><span class="lineno"> 1267</span>    <span class="keywordflow">if</span> (localStartInd &lt; 0)</div>
<div class="line"><span class="lineno"> 1268</span>        localStartInd = 0;</div>
<div class="line"><span class="lineno"> 1269</span>    <span class="keywordflow">if</span> (localEndInd &gt; qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>)</div>
<div class="line"><span class="lineno"> 1270</span>        localEndInd = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 1271</span>    <span class="comment">// they may now be out of order = no iterations</span></div>
<div class="line"><span class="lineno"> 1272</span>    </div>
<div class="line"><span class="lineno"> 1273</span>    <span class="comment">// unpacking OpenMP vars</span></div>
<div class="line"><span class="lineno"> 1274</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 1275</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecRe = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 1276</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>* vecIm = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 1277</span>    </div>
<div class="line"><span class="lineno"> 1278</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1279</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 1280</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 1281</span><span class="preprocessor">    shared   (localStartInd,localEndInd, vecRe,vecIm, reals,imags, offset) \</span></div>
<div class="line"><span class="lineno"> 1282</span><span class="preprocessor">    private  (index) </span></div>
<div class="line"><span class="lineno"> 1283</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1284</span>    {</div>
<div class="line"><span class="lineno"> 1285</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 1286</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 1287</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 1288</span>        <span class="comment">// iterate these local inds - this might involve no iterations</span></div>
<div class="line"><span class="lineno"> 1289</span>        <span class="keywordflow">for</span> (index=localStartInd; index &lt; localEndInd; index++) {</div>
<div class="line"><span class="lineno"> 1290</span>            vecRe[index] = reals[index + offset];</div>
<div class="line"><span class="lineno"> 1291</span>            vecIm[index] = imags[index + offset];</div>
<div class="line"><span class="lineno"> 1292</span>        }</div>
<div class="line"><span class="lineno"> 1293</span>    }</div>
<div class="line"><span class="lineno"> 1294</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad64a23933361fafc1b6b1787759c2663" name="ad64a23933361fafc1b6b1787759c2663"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad64a23933361fafc1b6b1787759c2663">&#9670;&#160;</a></span>statevec_setWeightedQureg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_setWeightedQureg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>fac1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>fac2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>facOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l04036">4036</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 4036</span>                                                                                                                  {</div>
<div class="line"><span class="lineno"> 4037</span> </div>
<div class="line"><span class="lineno"> 4038</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numAmps = qureg1.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4039</span> </div>
<div class="line"><span class="lineno"> 4040</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecRe1 = qureg1.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4041</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecIm1 = qureg1.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4042</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecRe2 = qureg2.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4043</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecIm2 = qureg2.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4044</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecReOut = out.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4045</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *vecImOut = out.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4046</span> </div>
<div class="line"><span class="lineno"> 4047</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> facRe1 = fac1.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>; </div>
<div class="line"><span class="lineno"> 4048</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> facIm1 = fac1.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 4049</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> facRe2 = fac2.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 4050</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> facIm2 = fac2.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 4051</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> facReOut = facOut.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>;</div>
<div class="line"><span class="lineno"> 4052</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> facImOut = facOut.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 4053</span> </div>
<div class="line"><span class="lineno"> 4054</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> re1,im1, re2,im2, reOut,imOut;</div>
<div class="line"><span class="lineno"> 4055</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> index;</div>
<div class="line"><span class="lineno"> 4056</span> </div>
<div class="line"><span class="lineno"> 4057</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4058</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4059</span><span class="preprocessor">    shared    (vecRe1,vecIm1, vecRe2,vecIm2, vecReOut,vecImOut, facRe1,facIm1,facRe2,facIm2, numAmps) \</span></div>
<div class="line"><span class="lineno"> 4060</span><span class="preprocessor">    private   (index, re1,im1, re2,im2, reOut,imOut)</span></div>
<div class="line"><span class="lineno"> 4061</span><span class="preprocessor"># endif </span></div>
<div class="line"><span class="lineno"> 4062</span>    {</div>
<div class="line"><span class="lineno"> 4063</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4064</span><span class="preprocessor"># pragma omp for schedule  (static)</span></div>
<div class="line"><span class="lineno"> 4065</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4066</span>        <span class="keywordflow">for</span> (index=0LL; index&lt;numAmps; index++) {</div>
<div class="line"><span class="lineno"> 4067</span>            re1 = vecRe1[index]; im1 = vecIm1[index];</div>
<div class="line"><span class="lineno"> 4068</span>            re2 = vecRe2[index]; im2 = vecIm2[index];</div>
<div class="line"><span class="lineno"> 4069</span>            reOut = vecReOut[index];</div>
<div class="line"><span class="lineno"> 4070</span>            imOut = vecImOut[index];</div>
<div class="line"><span class="lineno"> 4071</span> </div>
<div class="line"><span class="lineno"> 4072</span>            vecReOut[index] = (facReOut*reOut - facImOut*imOut) + (facRe1*re1 - facIm1*im1) + (facRe2*re2 - facIm2*im2);</div>
<div class="line"><span class="lineno"> 4073</span>            vecImOut[index] = (facReOut*imOut + facImOut*reOut) + (facRe1*im1 + facIm1*re1) + (facRe2*im2 + facIm2*re2);</div>
<div class="line"><span class="lineno"> 4074</span>        }</div>
<div class="line"><span class="lineno"> 4075</span>    }</div>
<div class="line"><span class="lineno"> 4076</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe74a5a9db8340e37b80fbc77338894d" name="abe74a5a9db8340e37b80fbc77338894d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe74a5a9db8340e37b80fbc77338894d">&#9670;&#160;</a></span>statevec_swapQubitAmpsDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_swapQubitAmpsDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pairRank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>qureg.pairStateVec contains the entire set of amplitudes of the paired node which includes the set of all amplitudes which need to be swapped between |..0..1..&gt; and |..1..0..&gt; </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03996">3996</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3996</span>                                                                                    {</div>
<div class="line"><span class="lineno"> 3997</span>    </div>
<div class="line"><span class="lineno"> 3998</span>    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 3999</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4000</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4001</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *rePairVec = qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.real;</div>
<div class="line"><span class="lineno"> 4002</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imPairVec = qureg.<a class="code hl_variable" href="structQureg.html#aba97773694870ef35e378c036f486bb7">pairStateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 4003</span>    </div>
<div class="line"><span class="lineno"> 4004</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numLocalAmps = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 4005</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> globalStartInd = qureg.<a class="code hl_variable" href="structQureg.html#ac2929e681d3d95591c18cf168dbbe4f0">chunkId</a> * numLocalAmps;</div>
<div class="line"><span class="lineno"> 4006</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> pairGlobalStartInd = pairRank * numLocalAmps;</div>
<div class="line"><span class="lineno"> 4007</span> </div>
<div class="line"><span class="lineno"> 4008</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> localInd, globalInd;</div>
<div class="line"><span class="lineno"> 4009</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> pairLocalInd, pairGlobalInd;</div>
<div class="line"><span class="lineno"> 4010</span>    </div>
<div class="line"><span class="lineno"> 4011</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4012</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 4013</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 4014</span><span class="preprocessor">    shared   (reVec,imVec,rePairVec,imPairVec,numLocalAmps,globalStartInd,pairGlobalStartInd,qb1,qb2) \</span></div>
<div class="line"><span class="lineno"> 4015</span><span class="preprocessor">    private  (localInd,globalInd, pairLocalInd,pairGlobalInd) </span></div>
<div class="line"><span class="lineno"> 4016</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4017</span>    {</div>
<div class="line"><span class="lineno"> 4018</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 4019</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 4020</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 4021</span>        <span class="keywordflow">for</span> (localInd=0; localInd &lt; numLocalAmps; localInd++) { </div>
<div class="line"><span class="lineno"> 4022</span>            </div>
<div class="line"><span class="lineno"> 4023</span>            globalInd = globalStartInd + localInd;</div>
<div class="line"><span class="lineno"> 4024</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a0e4eb651e7cb309bcd664b89ac9a2242">isOddParity</a>(globalInd, qb1, qb2)) {</div>
<div class="line"><span class="lineno"> 4025</span>                </div>
<div class="line"><span class="lineno"> 4026</span>                pairGlobalInd = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(<a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(globalInd, qb1), qb2);</div>
<div class="line"><span class="lineno"> 4027</span>                pairLocalInd = pairGlobalInd - pairGlobalStartInd;</div>
<div class="line"><span class="lineno"> 4028</span>                </div>
<div class="line"><span class="lineno"> 4029</span>                reVec[localInd] = rePairVec[pairLocalInd];</div>
<div class="line"><span class="lineno"> 4030</span>                imVec[localInd] = imPairVec[pairLocalInd];</div>
<div class="line"><span class="lineno"> 4031</span>            }</div>
<div class="line"><span class="lineno"> 4032</span>        }</div>
<div class="line"><span class="lineno"> 4033</span>    }</div>
<div class="line"><span class="lineno"> 4034</span>}</div>
<div class="ttc" id="aQuEST__cpu__internal_8h_html_a0e4eb651e7cb309bcd664b89ac9a2242"><div class="ttname"><a href="QuEST__cpu__internal_8h.html#a0e4eb651e7cb309bcd664b89ac9a2242">isOddParity</a></div><div class="ttdeci">static int isOddParity(const long long int number, const int qb1, const int qb2)</div><div class="ttdef"><b>Definition:</b> <a href="QuEST__cpu__internal_8h_source.html#l00038">QuEST_cpu_internal.h:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00357">Qureg::chunkId</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00030">flipBit()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00038">isOddParity()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="QuEST_8h_source.html#l00364">Qureg::pairStateVec</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01433">statevec_swapQubitAmps()</a>.</p>

</div>
</div>
<a id="ab5b51a28caa8792a3f0c637409a694b0" name="ab5b51a28caa8792a3f0c637409a694b0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5b51a28caa8792a3f0c637409a694b0">&#9670;&#160;</a></span>statevec_swapQubitAmpsLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_swapQubitAmpsLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>qb2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>It is ensured that all amplitudes needing to be swapped are on this node. </p>
<p >This means that amplitudes for |a 0..0..&gt; to |a 1..1..&gt; all exist on this node and each node has a different bit-string prefix "a". The prefix 'a' (and ergo, the chunkID) don't enter the calculations for the offset of |a 0..1..&gt; and |a 1..0..&gt; from |a 0..0..&gt; and ergo are not featured below. </p>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l03953">3953</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3953</span>                                                                {</div>
<div class="line"><span class="lineno"> 3954</span> </div>
<div class="line"><span class="lineno"> 3955</span>    <span class="comment">// can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 3956</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *reVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 3957</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *imVec = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 3958</span>    </div>
<div class="line"><span class="lineno"> 3959</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks = qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a> &gt;&gt; 2; <span class="comment">// each iteration updates 2 amps and skips 2 amps</span></div>
<div class="line"><span class="lineno"> 3960</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;</div>
<div class="line"><span class="lineno"> 3961</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> ind00, ind01, ind10;</div>
<div class="line"><span class="lineno"> 3962</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> re01, re10;</div>
<div class="line"><span class="lineno"> 3963</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> im01, im10;</div>
<div class="line"><span class="lineno"> 3964</span>    </div>
<div class="line"><span class="lineno"> 3965</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3966</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 3967</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 3968</span><span class="preprocessor">    shared   (reVec,imVec,numTasks,qb1,qb2) \</span></div>
<div class="line"><span class="lineno"> 3969</span><span class="preprocessor">    private  (thisTask, ind00,ind01,ind10, re01,re10, im01,im10) </span></div>
<div class="line"><span class="lineno"> 3970</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3971</span>    {</div>
<div class="line"><span class="lineno"> 3972</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 3973</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 3974</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 3975</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {    </div>
<div class="line"><span class="lineno"> 3976</span>            <span class="comment">// determine ind00 of |..0..0..&gt;, |..0..1..&gt; and |..1..0..&gt;</span></div>
<div class="line"><span class="lineno"> 3977</span>            ind00 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a8909226b5f0589d82b34af7f6bf2a339">insertTwoZeroBits</a>(thisTask, qb1, qb2);</div>
<div class="line"><span class="lineno"> 3978</span>            ind01 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(ind00, qb1);</div>
<div class="line"><span class="lineno"> 3979</span>            ind10 = <a class="code hl_function" href="QuEST__cpu__internal_8h.html#a234f55b49a14dc4c58b1959effeb1b56">flipBit</a>(ind00, qb2);</div>
<div class="line"><span class="lineno"> 3980</span> </div>
<div class="line"><span class="lineno"> 3981</span>            <span class="comment">// extract statevec amplitudes </span></div>
<div class="line"><span class="lineno"> 3982</span>            re01 = reVec[ind01]; im01 = imVec[ind01];</div>
<div class="line"><span class="lineno"> 3983</span>            re10 = reVec[ind10]; im10 = imVec[ind10];</div>
<div class="line"><span class="lineno"> 3984</span> </div>
<div class="line"><span class="lineno"> 3985</span>            <span class="comment">// swap 01 and 10 amps</span></div>
<div class="line"><span class="lineno"> 3986</span>            reVec[ind01] = re10; reVec[ind10] = re01;</div>
<div class="line"><span class="lineno"> 3987</span>            imVec[ind01] = im10; imVec[ind10] = im01;</div>
<div class="line"><span class="lineno"> 3988</span>        }</div>
<div class="line"><span class="lineno"> 3989</span>    }</div>
<div class="line"><span class="lineno"> 3990</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST__cpu__internal_8h_source.html#l00030">flipBit()</a>, <a class="el" href="QuEST__cpu__internal_8h_source.html#l00049">insertTwoZeroBits()</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l01433">statevec_swapQubitAmps()</a>.</p>

</div>
</div>
<a id="a0ce2c2fd54df25495e99dc5b95bed4b2" name="a0ce2c2fd54df25495e99dc5b95bed4b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ce2c2fd54df25495e99dc5b95bed4b2">&#9670;&#160;</a></span>statevec_unitaryDistributed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitaryDistributed </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplex.html">Complex</a>&#160;</td>
          <td class="paramname"><em>rot2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecUp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecLo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ComplexArray&#160;</td>
          <td class="paramname"><em>stateVecOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Apply a unitary operation to a single qubit given a subset of the state vector with upper and lower block values stored seperately. </p>
<dl class="section remark"><dt>Remarks</dt><dd>Qubits are zero-based and the first qubit is the rightmost <br  />
</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">qureg</td><td>object representing the set of qubits </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot1</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rot2</td><td></td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecUp</td><td>probability amplitudes in upper half of a block </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">stateVecLo</td><td>probability amplitudes in lower half of a block </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">stateVecOut</td><td>array section to update (will correspond to either the lower or upper half of a block) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02182">2182</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2187</span>{</div>
<div class="line"><span class="lineno"> 2188</span> </div>
<div class="line"><span class="lineno"> 2189</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>   stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2190</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;  </div>
<div class="line"><span class="lineno"> 2191</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>;</div>
<div class="line"><span class="lineno"> 2192</span> </div>
<div class="line"><span class="lineno"> 2193</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot1Real=rot1.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot1Imag=rot1.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2194</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> rot2Real=rot2.<a class="code hl_variable" href="structComplex.html#ab5b2e2eca02131fc74b289a83636cbe3">real</a>, rot2Imag=rot2.<a class="code hl_variable" href="structComplex.html#a84f5439aad0ef495efdd3b4c1c02d27e">imag</a>;</div>
<div class="line"><span class="lineno"> 2195</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealUp=stateVecUp.real, *stateVecImagUp=stateVecUp.imag;</div>
<div class="line"><span class="lineno"> 2196</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealLo=stateVecLo.real, *stateVecImagLo=stateVecLo.imag;</div>
<div class="line"><span class="lineno"> 2197</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecRealOut=stateVecOut.real, *stateVecImagOut=stateVecOut.imag;</div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span> </div>
<div class="line"><span class="lineno"> 2200</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2201</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2202</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2203</span><span class="preprocessor">    shared   (stateVecRealUp,stateVecImagUp,stateVecRealLo,stateVecImagLo,stateVecRealOut,stateVecImagOut, \</span></div>
<div class="line"><span class="lineno"> 2204</span><span class="preprocessor">            rot1Real, rot1Imag, rot2Real, rot2Imag,numTasks) \</span></div>
<div class="line"><span class="lineno"> 2205</span><span class="preprocessor">    private  (thisTask,stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 2206</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2207</span>    {</div>
<div class="line"><span class="lineno"> 2208</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2209</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2210</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2211</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2212</span>            <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2213</span>            stateRealUp = stateVecRealUp[thisTask];</div>
<div class="line"><span class="lineno"> 2214</span>            stateImagUp = stateVecImagUp[thisTask];</div>
<div class="line"><span class="lineno"> 2215</span> </div>
<div class="line"><span class="lineno"> 2216</span>            stateRealLo = stateVecRealLo[thisTask];</div>
<div class="line"><span class="lineno"> 2217</span>            stateImagLo = stateVecImagLo[thisTask];</div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>            stateVecRealOut[thisTask] = rot1Real*stateRealUp - rot1Imag*stateImagUp </div>
<div class="line"><span class="lineno"> 2220</span>                + rot2Real*stateRealLo - rot2Imag*stateImagLo;</div>
<div class="line"><span class="lineno"> 2221</span>            stateVecImagOut[thisTask] = rot1Real*stateImagUp + rot1Imag*stateRealUp </div>
<div class="line"><span class="lineno"> 2222</span>                + rot2Real*stateImagLo + rot2Imag*stateRealLo;</div>
<div class="line"><span class="lineno"> 2223</span>        }</div>
<div class="line"><span class="lineno"> 2224</span>    }</div>
<div class="line"><span class="lineno"> 2225</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00106">Complex::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, and <a class="el" href="QuEST_8h_source.html#l00105">Complex::real</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00897">statevec_unitary()</a>.</p>

</div>
</div>
<a id="aafc398f8f479fcc066a2dea700235635" name="aafc398f8f479fcc066a2dea700235635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafc398f8f479fcc066a2dea700235635">&#9670;&#160;</a></span>statevec_unitaryLocal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void statevec_unitaryLocal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targetQubit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structComplexMatrix2.html">ComplexMatrix2</a>&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l02057">2057</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2058</span>{</div>
<div class="line"><span class="lineno"> 2059</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> sizeBlock, sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2060</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisBlock, <span class="comment">// current block</span></div>
<div class="line"><span class="lineno"> 2061</span>         indexUp,indexLo;    <span class="comment">// current index and corresponding index in lower half block</span></div>
<div class="line"><span class="lineno"> 2062</span> </div>
<div class="line"><span class="lineno"> 2063</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> stateRealUp,stateRealLo,stateImagUp,stateImagLo;</div>
<div class="line"><span class="lineno"> 2064</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> thisTask;         </div>
<div class="line"><span class="lineno"> 2065</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> numTasks=qureg.<a class="code hl_variable" href="structQureg.html#ab0ea0358482b62f43fdd781469607d97">numAmpsPerChunk</a>&gt;&gt;1;</div>
<div class="line"><span class="lineno"> 2066</span> </div>
<div class="line"><span class="lineno"> 2067</span>    <span class="comment">// set dimensions</span></div>
<div class="line"><span class="lineno"> 2068</span>    sizeHalfBlock = 1LL &lt;&lt; targetQubit;  </div>
<div class="line"><span class="lineno"> 2069</span>    sizeBlock     = 2LL * sizeHalfBlock; </div>
<div class="line"><span class="lineno"> 2070</span> </div>
<div class="line"><span class="lineno"> 2071</span>    <span class="comment">// Can&#39;t use qureg.stateVec as a private OMP var</span></div>
<div class="line"><span class="lineno"> 2072</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecReal = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real;</div>
<div class="line"><span class="lineno"> 2073</span>    <a class="code hl_define" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a> *stateVecImag = qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag;</div>
<div class="line"><span class="lineno"> 2074</span> </div>
<div class="line"><span class="lineno"> 2075</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2076</span><span class="preprocessor"># pragma omp parallel \</span></div>
<div class="line"><span class="lineno"> 2077</span><span class="preprocessor">    default  (none) \</span></div>
<div class="line"><span class="lineno"> 2078</span><span class="preprocessor">    shared   (sizeBlock,sizeHalfBlock, stateVecReal,stateVecImag, u,numTasks) \</span></div>
<div class="line"><span class="lineno"> 2079</span><span class="preprocessor">    private  (thisTask,thisBlock ,indexUp,indexLo, stateRealUp,stateImagUp,stateRealLo,stateImagLo)</span></div>
<div class="line"><span class="lineno"> 2080</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2081</span>    {</div>
<div class="line"><span class="lineno"> 2082</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno"> 2083</span><span class="preprocessor"># pragma omp for schedule (static)</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno"> 2085</span>        <span class="keywordflow">for</span> (thisTask=0; thisTask&lt;numTasks; thisTask++) {</div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>            thisBlock   = thisTask / sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2088</span>            indexUp     = thisBlock*sizeBlock + thisTask%sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2089</span>            indexLo     = indexUp + sizeHalfBlock;</div>
<div class="line"><span class="lineno"> 2090</span> </div>
<div class="line"><span class="lineno"> 2091</span>            <span class="comment">// store current state vector values in temp variables</span></div>
<div class="line"><span class="lineno"> 2092</span>            stateRealUp = stateVecReal[indexUp];</div>
<div class="line"><span class="lineno"> 2093</span>            stateImagUp = stateVecImag[indexUp];</div>
<div class="line"><span class="lineno"> 2094</span> </div>
<div class="line"><span class="lineno"> 2095</span>            stateRealLo = stateVecReal[indexLo];</div>
<div class="line"><span class="lineno"> 2096</span>            stateImagLo = stateVecImag[indexLo];</div>
<div class="line"><span class="lineno"> 2097</span> </div>
<div class="line"><span class="lineno"> 2098</span> </div>
<div class="line"><span class="lineno"> 2099</span>            <span class="comment">// state[indexUp] = u00 * state[indexUp] + u01 * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2100</span>            stateVecReal[indexUp] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateRealUp - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateImagUp </div>
<div class="line"><span class="lineno"> 2101</span>                + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateRealLo - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateImagLo;</div>
<div class="line"><span class="lineno"> 2102</span>            stateVecImag[indexUp] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][0]*stateImagUp + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][0]*stateRealUp </div>
<div class="line"><span class="lineno"> 2103</span>                + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[0][1]*stateImagLo + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[0][1]*stateRealLo;</div>
<div class="line"><span class="lineno"> 2104</span> </div>
<div class="line"><span class="lineno"> 2105</span>            <span class="comment">// state[indexLo] = u10  * state[indexUp] + u11 * state[indexLo]</span></div>
<div class="line"><span class="lineno"> 2106</span>            stateVecReal[indexLo] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateRealUp  - u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateImagUp </div>
<div class="line"><span class="lineno"> 2107</span>                + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateRealLo  -  u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateImagLo;</div>
<div class="line"><span class="lineno"> 2108</span>            stateVecImag[indexLo] = u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][0]*stateImagUp + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][0]*stateRealUp </div>
<div class="line"><span class="lineno"> 2109</span>                + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3ea98d545b67a190ee6abe936c72076f">real</a>[1][1]*stateImagLo + u.<a class="code hl_variable" href="structComplexMatrix2.html#a3a2b60a9e00ccef054a6de3b9307c1be">imag</a>[1][1]*stateRealLo;</div>
<div class="line"><span class="lineno"> 2110</span> </div>
<div class="line"><span class="lineno"> 2111</span>        } </div>
<div class="line"><span class="lineno"> 2112</span>    }</div>
<div class="line"><span class="lineno"> 2113</span>} </div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00140">ComplexMatrix2::imag</a>, <a class="el" href="QuEST_8h_source.html#l00353">Qureg::numAmpsPerChunk</a>, <a class="el" href="group__type.html#ga7740e349b4f8bae6451547680f0ce2d6">qreal</a>, <a class="el" href="QuEST_8h_source.html#l00139">ComplexMatrix2::real</a>, and <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu__distributed_8c_source.html#l00897">statevec_unitary()</a>.</p>

</div>
</div>
<a id="ac5168399122f7f53977dcc9ceda4f458" name="ac5168399122f7f53977dcc9ceda4f458"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5168399122f7f53977dcc9ceda4f458">&#9670;&#160;</a></span>zeroSomeAmps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zeroSomeAmps </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structQureg.html">Qureg</a>&#160;</td>
          <td class="paramname"><em>qureg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>startInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long long int&#160;</td>
          <td class="paramname"><em>numAmps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="QuEST__cpu_8c_source.html#l00746">746</a> of file <a class="el" href="QuEST__cpu_8c_source.html">QuEST_cpu.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  746</span>                                                                              {</div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">  748</span><span class="preprocessor"># ifdef _OPENMP</span></div>
<div class="line"><span class="lineno">  749</span><span class="preprocessor"># pragma omp parallel for schedule (static)</span></div>
<div class="line"><span class="lineno">  750</span><span class="preprocessor"># endif</span></div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">for</span> (i=startInd; i &lt; startInd+numAmps; i++) {</div>
<div class="line"><span class="lineno">  752</span>        qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.real[i] = 0;</div>
<div class="line"><span class="lineno">  753</span>        qureg.<a class="code hl_variable" href="structQureg.html#a441e4cacef6bd17adb9813c7442d42fe">stateVec</a>.imag[i] = 0;</div>
<div class="line"><span class="lineno">  754</span>    }</div>
<div class="line"><span class="lineno">  755</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="QuEST_8h_source.html#l00362">Qureg::stateVec</a>.</p>

<p class="reference">Referenced by <a class="el" href="QuEST__cpu_8c_source.html#l00766">alternateNormZeroingSomeAmpBlocks()</a>, and <a class="el" href="QuEST__cpu_8c_source.html#l00797">densmatr_collapseToKnownProbOutcome()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
</body>
        <script type="text/javascript" src="boot.js"></script>
</html>
